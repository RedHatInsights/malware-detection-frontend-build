"use strict";(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[207],{58295:(e,t,a)=>{a.r(t),a.d(t,{default:()=>J});var r=a(93433),l=a(29439),n=a(4942),s=a(71070),o=a(93264),i=a.n(o),c=a(38800),u=a(62480),m=a(1082),d=a(7732),f=a(3351),p=a(6934),g=a(22860),y=a(82779),v=a(62410),h=a(84580),b=a(75662),M=a(52661),E=a(51957),Z=a(66031),S=a(80810),w=a(19399),D=a(35224),C=a(30893),O=a(88676),P=a(86896),T=a(70846),_=a(90025),V=a(38846),A=a(50693),N=a(16475),j=a(45697),B=a.n(j),L=a(63540),x=function(e){var t=e.signature,a=(0,P.Z)(),r=(0,o.useState)(!1),n=(0,l.Z)(r,1)[0];return i().createElement(A.r,{hasGutter:!0},n&&i().createElement(N.P,{span:6},i().createElement(V.Z,{code:t.rawRule,isReadOnly:!0})),i().createElement(N.P,{span:n?6:12}," ",i().createElement(L.xv,{className:"ins-l-sigtable--title",component:L.qO.h6},a.formatMessage(C.Z.description)),t.metadata.description))};x.propTypes={signature:B().object};const R=x;function H(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?H(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):H(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var G={tableVars:{limit:10,offset:0,orderBy:"LAST_MATCH_DATE_DESC",ruleName:""},sortBy:{index:4,direction:c.B.desc},rows:[]},W={1:"NAME",2:"HAS_MATCH",3:"IS_DISABLED",4:"HOST_COUNT",5:"LAST_MATCH_DATE"},F=function(e){var t=e.index,a=e.direction;return"".concat(W[t],"_").concat(a===c.B.asc?"ASC":"DESC")},I=function(e,t){switch(t.type){case"setTableVars":return k(k({},e),{},{tableVars:k(k({},e.tableVars),t.payload)});case"setSortBy":return k(k({},e),{},{sortBy:t.payload,tableVars:k(k({},e.tableVars),t.tableVars)});case"setRows":return k(k({},e),{},{rows:t.payload})}return e},X=function(){var e,t,a,n,c,y,V,A,N=(0,P.Z)(),j=(0,o.useReducer)(I,k({},G)),B=(0,l.Z)(j,2),L=B[0],x=L.tableVars,H=L.sortBy,W=L.rows,X=B[1],J=(0,T.a)(h.tE,{variables:k(k({},x),(0,_.l)(O.gG))}),$=J.data,q=J.loading,z=J.error,U=[{title:N.formatMessage(C.Z.sigName),cellFormatters:[u.zW],transforms:[(0,m.d)(45),d.p]},{title:N.formatMessage(C.Z.lastStatus),transforms:[(0,m.d)(10),d.p]},{title:N.formatMessage(C.Z.systems),transforms:[(0,m.d)(10),d.p]},{title:N.formatMessage(C.Z.matched),transforms:[(0,m.d)(10),d.p]}],Y=x.offset/x.limit+1,K={sig_match:{type:"radio",title:N.formatMessage(C.Z.status),urlParam:"sig_match",values:[{label:N.formatMessage(C.Z.all),value:"all"},{label:N.formatMessage(C.Z.matched),value:"true"},{label:N.formatMessage(C.Z.notMatched),value:"false"}]}},Q=[{label:N.formatMessage(C.Z.signature).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return X({type:"setTableVars",payload:{ruleName:t}})},value:x.ruleName,placeholder:N.formatMessage(C.Z.filterBy,{field:N.formatMessage(C.Z.signature).toLowerCase()})}},{label:K.sig_match.title.toLowerCase(),type:K.sig_match.type,id:K.sig_match.urlParam,value:"radio-".concat(K.sig_match.urlParam),filterValues:{key:"".concat(K.sig_match.urlParam,"-filter"),onChange:function(e,t){var a=(0,O.gG)();"all"===t&&(null==a||delete a.condition),"all"===t?(0,O.gG)(k({},a)):(0,O.gG)(k(k({},a),{},{condition:{hasMatch:JSON.parse(t)}}))},value:JSON.stringify(null===(e=(0,O.gG)().condition)||void 0===e?void 0:e.hasMatch)||"all",items:K.sig_match.values}}],ee=function(e,t){return X({type:"setTableVars",payload:{offset:t*x.limit-x.limit}})},te=function(e,t){return X({type:"setTableVars",payload:{limit:t,offset:0}})},ae={deleteTitle:N.formatMessage(C.Z.resetFilters),filters:(V=[],A=void 0!==(null===(c=(0,O.gG)().condition)||void 0===c?void 0:c.hasMatch)&&(null!==(y=(0,O.gG)().condition)&&void 0!==y&&y.hasMatch?N.formatMessage(C.Z.matched):N.formatMessage(C.Z.notMatched)),(null==x?void 0:x.ruleName)&&V.push({category:N.formatMessage(C.Z.signature),value:"name",chips:[{name:null==x?void 0:x.ruleName,value:null==x?void 0:x.ruleName}]}),A&&V.push({category:N.formatMessage(C.Z.status),value:"matched",chips:[{name:A,value:A}]}),V),onDelete:function(e,t,a){a?((0,O.gG)({}),X({type:"setTableVars",payload:{ruleName:""}})):t.map((function(e){"name"===e.value&&X({type:"setTableVars",payload:{ruleName:""}}),"matched"===e.value&&(0,O.gG)({})}))}};return(0,o.useEffect)((function(){var e,t;X({type:"setRows",payload:(e=$,null==e||null===(t=e.rulesList)||void 0===t?void 0:t.flatMap((function(e,t){var a,r=e;return[{rowId:t,isOpen:!1,cells:[{title:i().createElement(b.Link,{to:"/signatures/".concat(r.name)},r.name)},{title:i().createElement(w.Z,{isDisabled:r.isDisabled,hasMatch:r.hasMatch,displayMatch:!0})},{title:i().createElement(b.Link,{to:"/signatures/".concat(r.name)},null===(a=r.hostCount)||void 0===a?void 0:a.toLocaleString())},{title:r.lastMatchDate?i().createElement(D.u,{content:i().createElement(v.Z,{date:new Date(r.lastMatchDate),type:"exact"})},i().createElement("span",null,i().createElement(v.Z,{date:new Date(r.lastMatchDate),type:"onlyDate"}))):i().createElement(D.u,{content:N.formatMessage(C.Z.noHostHas)},i().createElement("span",null,N.formatMessage(C.Z.never)))}]},{parent:2*t,sigData:r,fullWidth:!0,cells:[]}]})))})}),[N,$]),i().createElement(i().Fragment,null,i().createElement(Z.Z,{pagination:{itemCount:(null==$||null===(t=$.rules)||void 0===t?void 0:t.totalCount)||0,page:Y,perPage:x.limit,onSetPage:function(e,t){ee(0,t)},onPerPageSelect:function(e,t){te(0,t)},isCompact:!0},filterConfig:{items:Q},activeFiltersConfig:ae}),i().createElement(f.i,{className:"sigTable","aria-label":"Signature table",onCollapse:function(e,t,a){var l=(0,r.Z)(W),n=l[t+1].sigData;l[t]=k(k({},l[t]),{},{isOpen:a}),l[t+1].cells=[{title:i().createElement(R,{signature:n})}],X({type:"setRows",payload:l})},rows:W,cells:U,onSort:function(e,t,a){return X({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:F({index:t,direction:a}),offset:0}})},sortBy:H,isStickyHeader:!0},i().createElement(p.x,null),i().createElement(g.R,null)),q&&i().createElement(M.Z,{type:"table"}),!q&&!z&&0===(null==$||null===(a=$.rules)||void 0===a?void 0:a.totalCount)&&i().createElement(E.Z,{className:"pf-c-card",icon:S.W1,variant:"large",title:N.formatMessage(C.Z.noResults),text:N.formatMessage(C.Z.noResultsMatch)}),z&&i().createElement(E.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),i().createElement(s.t,{itemCount:(null==$||null===(n=$.rules)||void 0===n?void 0:n.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:x.limit,page:Y,variant:s.a.bottom,onSetPage:ee,onPerPageSelect:te}))};X.propTypes=y.R$;const J=X},39149:(e,t,a)=>{a.r(t),a.d(t,{default:()=>L});var r=a(29439),l=a(4942),n=a(71070),s=a(93264),o=a.n(s),i=a(38800),c=a(1082),u=a(7732),m=a(3351),d=a(6934),f=a(22860),p=a(62410),g=a(84580),y=a(75662),v=a(52661),h=a(51957),b=a(66031),M=a(80810),E=a(19399),Z=a(35224),S=a(82779),w=a(30893),D=a(88676),C=a(86896),O=a(70846),P=a(90025);function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,l.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var V={tableVars:{limit:10,offset:0,orderBy:"LAST_SCAN_DATE_DESC",name:""},sortBy:{index:4,direction:i.B.desc},rows:[]},A={0:"DISPLAY_NAME",1:"HAS_MATCH",2:"LAST_MATCH_DATE",3:"TOTAL_MATCHES",4:"LAST_SCAN_DATE"},N=function(e){var t=e.index,a=e.direction;return"".concat(A[t],"_").concat(a===i.B.asc?"ASC":"DESC")},j=function(e,t){switch(t.type){case"setTableVars":return _(_({},e),{},{tableVars:_(_({},e.tableVars),t.payload)});case"setSortBy":return _(_({},e),{},{sortBy:t.payload,tableVars:_(_({},e.tableVars),t.tableVars)});case"setRows":return _(_({},e),{},{rows:t.payload})}return e},B=function(){var e,t,a,l,i,T,A,B=(0,C.Z)(),L=(0,s.useReducer)(j,_({},V)),x=(0,r.Z)(L,2),R=x[0],H=R.tableVars,k=R.sortBy,G=R.rows,W=x[1],F=(0,O.a)(g.c5,{variables:_(_({},H),(0,P.l)(D.WX))}),I=F.data,X=F.loading,J=F.error,$=[{title:B.formatMessage(w.Z.name),transforms:[(0,c.d)(45),u.p]},{title:B.formatMessage(w.Z.lastStatus),transforms:[u.p,(0,c.d)(10)]},{title:B.formatMessage(w.Z.matched),transforms:[u.p,(0,c.d)(10)]},{title:o().createElement("span",null,(0,S.lH)({tooltip:B.formatMessage(w.Z.totalMatchesNote),title:B.formatMessage(w.Z.totalMatches)})),transforms:[u.p,(0,c.d)(15)]},{title:B.formatMessage(w.Z.lastScan),transforms:[u.p,(0,c.d)(10)]}],q=H.offset/H.limit+1,z=[{label:B.formatMessage(w.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return W({type:"setTableVars",payload:{name:t}})},value:H.name,placeholder:B.formatMessage(w.Z.filterBy,{field:B.formatMessage(w.Z.name).toLowerCase()})}}],U=function(e,t){return W({type:"setTableVars",payload:{offset:t*H.limit-H.limit}})},Y=function(e,t){return W({type:"setTableVars",payload:{limit:t,offset:0}})},K={deleteTitle:B.formatMessage(w.Z.resetFilters),filters:(T=[],A=void 0!==(null===(l=(0,D.WX)().condition)||void 0===l?void 0:l.hasMatch)&&(null!==(i=(0,D.WX)().condition)&&void 0!==i&&i.hasMatch?B.formatMessage(w.Z.matched):B.formatMessage(w.Z.notMatched)),(null==H?void 0:H.name)&&T.push({category:B.formatMessage(w.Z.name),value:"name",chips:[{name:null==H?void 0:H.name,value:null==H?void 0:H.name}]}),A&&T.push({category:B.formatMessage(w.Z.status),value:"matched",chips:[{name:A,value:A}]}),T),onDelete:function(e,t,a){a?((0,D.WX)({}),W({type:"setTableVars",payload:{name:""}})):t.map((function(e){"name"===e.value&&W({type:"setTableVars",payload:{name:""}}),"matched"===e.value&&(0,D.WX)({})}))}};return(0,s.useEffect)((function(){var e,t;W({type:"setRows",payload:(e=I,null==e||null===(t=e.hostsList)||void 0===t?void 0:t.flatMap((function(e,t){var a;return{rowId:t,cells:[{title:o().createElement(y.Link,{to:"/systems/".concat(e.displayName)},e.displayName)},{title:o().createElement(E.Z,{isDisabled:e.isDisabled,hasMatch:e.hasMatch,displayMatch:!0})},{title:e.lastMatchDate?o().createElement(Z.u,{content:o().createElement(p.Z,{date:new Date(e.lastMatchDate),type:"exact"})},o().createElement("span",null,o().createElement(p.Z,{date:new Date(e.lastMatchDate),type:"onlyDate"}))):o().createElement(Z.u,{content:B.formatMessage(w.Z.noHostHas)},o().createElement("span",null,B.formatMessage(w.Z.never)))},{title:o().createElement(y.Link,{to:"/systems/".concat(e.displayName)},null===(a=e.totalMatches)||void 0===a?void 0:a.toLocaleString())},{title:o().createElement(Z.u,{content:o().createElement(p.Z,{date:new Date(e.lastScanDate),type:"exact"})},o().createElement("span",null,o().createElement(p.Z,{date:new Date(e.lastScanDate)})))}]}})))})}),[B,I]),o().createElement(o().Fragment,null,o().createElement(b.Z,{pagination:{itemCount:(null==I||null===(e=I.hosts)||void 0===e?void 0:e.totalCount)||0,page:q,perPage:H.limit,onSetPage:function(e,t){U(0,t)},onPerPageSelect:function(e,t){Y(0,t)},isCompact:!0},filterConfig:{items:z},activeFiltersConfig:K}),o().createElement(m.i,{className:"sysTable","aria-label":"System table",rows:G,cells:$,onSort:function(e,t,a){return W({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:N({index:t,direction:a}),offset:0}})},sortBy:k,isStickyHeader:!0},o().createElement(d.x,null),o().createElement(f.R,null)),X&&o().createElement(v.Z,{type:"table"}),!X&&!J&&0===(null==I||null===(t=I.hosts)||void 0===t?void 0:t.totalCount)&&o().createElement(h.Z,{className:"pf-c-card",icon:M.W1,variant:"large",title:B.formatMessage(w.Z.noResults),text:B.formatMessage(w.Z.noResultsMatch)}),J&&o().createElement(h.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),o().createElement(n.t,{itemCount:(null==I||null===(a=I.hosts)||void 0===a?void 0:a.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:H.limit,page:q,variant:n.a.bottom,onSetPage:U,onPerPageSelect:Y}))};B.propTypes=S.R$;const L=B}}]);
//# sourceMappingURL=../sourcemaps/SigTable.1ad1747b39ac51a3309b4ba2f044a94f.js.map