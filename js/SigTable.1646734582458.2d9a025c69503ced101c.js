(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[207],{90025:(e,t,a)=>{"use strict";a.d(t,{l:()=>s});var l=a(93264);function s(e){var t=e(),a=(0,l.useState)(t)[1];return(0,l.useEffect)((function(){var l=e();if(t===l)return e.onNextChange(a);a(l)}),[t]),t}},50693:(e,t,a)=>{"use strict";a.d(t,{r:()=>u});var l=a(21988),s=a(93264),r=a(17067),n=a(38296),o=a(54764),i=a(77712),c=a(80164);const u=e=>{var{children:t=null,className:a="",hasGutter:u,span:m=null,order:d,style:f}=e,p=(0,l.__rest)(e,["children","className","hasGutter","span","order","style"]);const g=[r.default.grid,m&&r.default.modifiers[`all_${m}Col`]];return Object.entries(o.a).forEach((([e,t])=>{const a=e,l=p[a];l&&g.push(r.default.modifiers[`all_${l}ColOn${t}`]),delete p[a]})),s.createElement("div",Object.assign({className:(0,n.css)(...g,u&&r.default.modifiers.gutter,a),style:f||d?Object.assign(Object.assign({},f),(0,c.x8)(d,i.T.name)):void 0},p),t)};u.displayName="Grid"},16475:(e,t,a)=>{"use strict";a.d(t,{P:()=>u});var l=a(21988),s=a(93264),r=a(17067),n=a(38296),o=a(54764),i=a(77712),c=a(80164);const u=e=>{var{children:t=null,className:a="",span:u=null,rowSpan:m=null,offset:d=null,order:f,style:p}=e,g=(0,l.__rest)(e,["children","className","span","rowSpan","offset","order","style"]);const y=[r.default.gridItem,u&&r.default.modifiers[`${u}Col`],m&&r.default.modifiers[`${m}Row`],d&&r.default.modifiers[`offset_${d}Col`]];return Object.entries(o.a).forEach((([e,t])=>{const a=e,l=`${a}RowSpan`,s=`${a}Offset`,n=g[a],o=g[l],i=g[s];n&&y.push(r.default.modifiers[`${n}ColOn${t}`]),o&&y.push(r.default.modifiers[`${o}RowOn${t}`]),i&&y.push(r.default.modifiers[`offset_${i}ColOn${t}`]),delete g[a],delete g[l],delete g[s]})),s.createElement("div",Object.assign({className:(0,n.css)(...y,a),style:p||f?Object.assign(Object.assign({},p),(0,c.x8)(f,i.T.name)):void 0},g),t)};u.displayName="GridItem"},54764:(e,t,a)=>{"use strict";var l,s;a.d(t,{t:()=>l,a:()=>s}),function(e){e.xs="xs",e.sm="sm",e.md="md",e.lg="lg",e.xl="xl",e["2xl"]="2xl",e["3xl"]="3xl",e["4xl"]="4xl"}(l||(l={})),function(e){e.sm="Sm",e.md="Md",e.lg="Lg",e.xl="Xl",e.xl2="_2xl"}(s||(s={}))},63540:(e,t,a)=>{"use strict";t.xv=t.qO=void 0;const l=a(21988),s=l.__importStar(a(93264)),r=a(38296),n=l.__importDefault(a(67526)),o=a(23053);var i;!function(e){e.h1="h1",e.h2="h2",e.h3="h3",e.h4="h4",e.h5="h5",e.h6="h6",e.p="p",e.a="a",e.small="small",e.blockquote="blockquote",e.pre="pre"}(i=t.qO||(t.qO={})),t.xv=e=>{var{children:a=null,className:c="",component:u=i.p,isVisitedLink:m=!1,ouiaId:d,ouiaSafe:f=!0}=e,p=l.__rest(e,["children","className","component","isVisitedLink","ouiaId","ouiaSafe"]);const g=u,y=o.useOUIAProps(t.xv.displayName,d,f);return s.createElement(g,Object.assign({},y,p,{"data-pf-content":!0,className:r.css(m&&u===i.a&&n.default.modifiers.visited,c)}),a)},t.xv.displayName="Text"},77712:(e,t,a)=>{"use strict";a.d(t,{T:()=>l});const l={name:"--pf-l-grid--item--Order",value:"0",var:"var(--pf-l-grid--item--Order)"}},38846:(e,t,a)=>{"use strict";a.d(t,{Z:()=>f});var l=a(99332),s=a(51957),r=a(33211),n=a(45697),o=a.n(n),i=a(93264),c=a.n(i),u=a(30893),m=a(86896),d=function(e){var t=e.code,a=e.language,n=e.isReadOnly,o=e.isDownloadEnabled,i=e.isCopyEnabled,d=e.height,f=void 0===d?"400px":d,p=(0,m.Z)();return c().createElement(r.p,{isDownloadEnabled:o,isCopyEnabled:i,isReadOnly:n,isLanguageLabelVisible:a,code:t,language:a,emptyState:c().createElement(s.Z,{className:"",icon:l.mB,variant:"small",title:p.formatMessage(u.Z.sigCompiled),text:p.formatMessage(u.Z.sigCompiledBody)}),height:f})};d.propTypes={code:o().any,language:o().string,isReadOnly:o().bool,isCopyEnabled:o().bool,isDownloadEnabled:o().bool,height:o().string},d.defaultProps={codeType:"Code"};const f=d},51957:(e,t,a)=>{"use strict";a.d(t,{Z:()=>f});var l=a(9947),s=a(38424),r=a(75106),n=a(76473),o=a(45697),i=a.n(o),c=a(93264),u=a.n(c),m=a(60485),d=function(e){var t=e.className,a=e.children,n=e.icon,o=e.iconClass,i=e.iconStyle,c=e.text,d=e.title,f=e.variant;return u().createElement(l.u,{className:t,variant:f},"none"!==n&&u().createElement(s.k,{className:o,style:i,icon:n}),u().createElement(m.D,{headingLevel:"h5",size:"lg"},d),u().createElement(r.B,{style:{marginBottom:"16px"}},c),a)};d.propTypes={children:i().any,icon:i().any,iconClass:i().any,iconStyle:i().any,text:i().any,title:i().string,variant:i().any,className:i().string},d.defaultProps={icon:n.ZP,title:"",variant:l.I.full};const f=d},58295:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>q});var l=a(42982),s=a(70885),r=a(4942),n=a(71070),o=a(93264),i=a.n(o),c=a(48585),u=a(62480),m=a(1082),d=a(7732),f=a(3351),p=a(6934),g=a(22860),y=a(82779),h=a(62410),v=a(84580),b=a(75662),E=a(52661),M=a(51957),Z=a(66031),O=a(80810),S=a(19399),C=a(35224),w=a(30893),_=a(88676),D=a(86896),T=a(70846),x=a(90025),N=a(38846),P=a(50693),V=a(16475),j=a(45697),A=a.n(j),B=a(63540),L=function(e){var t=e.signature,a=(0,D.Z)(),l=(0,o.useState)(!1),r=(0,s.Z)(l,1)[0];return i().createElement(P.r,{hasGutter:!0},r&&i().createElement(V.P,{span:6},i().createElement(N.Z,{code:t.rawRule,isReadOnly:!0})),i().createElement(V.P,{span:r?6:12}," ",i().createElement(B.xv,{className:"ins-l-sigtable--title",component:B.qO.h6},a.formatMessage(w.Z.description)),t.metadata.description))};L.propTypes={signature:A().object};const R=L;function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function H(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){(0,r.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var $={tableVars:{limit:10,offset:0,orderBy:"LAST_MATCH_DATE_DESC",ruleName:""},sortBy:{index:4,direction:c.B.desc},rows:[]},G={1:"NAME",2:"HAS_MATCH",3:"HOST_COUNT",4:"LAST_MATCH_DATE"},I=function(e){var t=e.index,a=e.direction;return"".concat(G[t],"_").concat(a===c.B.asc?"ASC":"DESC")},W=function(e,t){switch(t.type){case"setTableVars":return H(H({},e),{},{tableVars:H(H({},e.tableVars),t.payload)});case"setSortBy":return H(H({},e),{},{sortBy:t.payload,tableVars:H(H({},e.tableVars),t.tableVars)});case"setRows":return H(H({},e),{},{rows:t.payload})}return e},F=function(){var e,t,a,r,c,y,N,P,V=(0,D.Z)(),j=(0,o.useReducer)(W,H({},$)),A=(0,s.Z)(j,2),B=A[0],L=B.tableVars,k=B.sortBy,G=B.rows,F=A[1],q=(0,T.a)(v.tE,{variables:H(H({},L),(0,x.l)(_.gG))}),X=q.data,z=q.loading,J=q.error,U=[{title:V.formatMessage(w.Z.sigName),cellFormatters:[u.zW],transforms:[(0,m.d)(45),d.p]},{title:V.formatMessage(w.Z.lastStatus),transforms:[(0,m.d)(10),d.p]},{title:V.formatMessage(w.Z.systems),transforms:[(0,m.d)(10),d.p]},{title:V.formatMessage(w.Z.lastMatched),transforms:[(0,m.d)(10),d.p]}],Y=L.offset/L.limit+1,K={sig_match:{type:"radio",title:V.formatMessage(w.Z.status),urlParam:"sig_match",values:[{label:V.formatMessage(w.Z.all),value:"all"},{label:V.formatMessage(w.Z.matched),value:"true"},{label:V.formatMessage(w.Z.notMatched),value:"false"}]}},Q=[{label:V.formatMessage(w.Z.signature).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return F({type:"setTableVars",payload:{ruleName:t,offset:0}})},value:L.ruleName,placeholder:V.formatMessage(w.Z.filterBy,{field:V.formatMessage(w.Z.signature).toLowerCase()})}},{label:K.sig_match.title.toLowerCase(),type:K.sig_match.type,id:K.sig_match.urlParam,value:"radio-".concat(K.sig_match.urlParam),filterValues:{key:"".concat(K.sig_match.urlParam,"-filter"),onChange:function(e,t){var a=(0,_.gG)();"all"===t&&(null==a||delete a.condition),"all"===t?(0,_.gG)(H({},a)):(0,_.gG)(H(H({},a),{},{condition:{hasMatch:JSON.parse(t)}}))},value:JSON.stringify(null===(e=(0,_.gG)().condition)||void 0===e?void 0:e.hasMatch)||"all",items:K.sig_match.values}}],ee=function(e,t){return F({type:"setTableVars",payload:{offset:t*L.limit-L.limit}})},te=function(e,t){return F({type:"setTableVars",payload:{limit:t,offset:0}})},ae={deleteTitle:V.formatMessage(w.Z.resetFilters),filters:(N=[],P=void 0!==(null===(c=(0,_.gG)().condition)||void 0===c?void 0:c.hasMatch)&&(null!==(y=(0,_.gG)().condition)&&void 0!==y&&y.hasMatch?V.formatMessage(w.Z.matched):V.formatMessage(w.Z.notMatched)),(null==L?void 0:L.ruleName)&&N.push({category:V.formatMessage(w.Z.signature),value:"name",chips:[{name:null==L?void 0:L.ruleName,value:null==L?void 0:L.ruleName}]}),P&&N.push({category:V.formatMessage(w.Z.status),value:"matched",chips:[{name:P,value:P}]}),N),onDelete:function(e,t,a){a?((0,_.gG)({}),F({type:"setTableVars",payload:{ruleName:""}})):t.map((function(e){"name"===e.value&&F({type:"setTableVars",payload:{ruleName:""}}),"matched"===e.value&&(0,_.gG)({})}))}};return(0,o.useEffect)((function(){var e,t;F({type:"setRows",payload:(e=X,null==e||null===(t=e.rulesList)||void 0===t?void 0:t.flatMap((function(e,t){var a,l=e;return[{rowId:t,isOpen:!1,cells:[{title:i().createElement(b.Link,{to:"/signatures/".concat(l.name)},l.name)},{title:i().createElement(S.Z,{isDisabled:l.isDisabled,hasMatch:l.hasMatch,displayMatch:!0})},{title:i().createElement(b.Link,{to:"/signatures/".concat(l.name)},null===(a=l.hostCount)||void 0===a?void 0:a.toLocaleString())},{title:l.lastMatchDate?i().createElement(C.u,{content:i().createElement(h.Z,{date:new Date(l.lastMatchDate),type:"exact"})},i().createElement("span",null,i().createElement(h.Z,{date:new Date(l.lastMatchDate)}))):i().createElement(C.u,{content:V.formatMessage(w.Z.noHostHas)},i().createElement("span",null,V.formatMessage(w.Z.never)))}]},{parent:2*t,sigData:l,fullWidth:!0,cells:[]}]})))})}),[V,X]),i().createElement(i().Fragment,null,i().createElement(Z.Z,{pagination:{itemCount:(null==X||null===(t=X.rules)||void 0===t?void 0:t.totalCount)||0,page:Y,perPage:L.limit,onSetPage:function(e,t){ee(0,t)},onPerPageSelect:function(e,t){te(0,t)},isCompact:!0},filterConfig:{items:Q},activeFiltersConfig:ae}),i().createElement(f.i,{className:"sigTable","aria-label":"Signature table",onCollapse:function(e,t,a){var s=(0,l.Z)(G),r=s[t+1].sigData;s[t]=H(H({},s[t]),{},{isOpen:a}),s[t+1].cells=[{title:i().createElement(R,{signature:r})}],F({type:"setRows",payload:s})},rows:G,cells:U,onSort:function(e,t,a){return F({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:I({index:t,direction:a}),offset:0}})},sortBy:k,isStickyHeader:!0},i().createElement(p.x,null),i().createElement(g.R,null)),z&&i().createElement(E.Z,{type:"table"}),!z&&!J&&0===(null==X||null===(a=X.rules)||void 0===a?void 0:a.totalCount)&&i().createElement(M.Z,{className:"pf-c-card",icon:O.W1,variant:"large",title:V.formatMessage(w.Z.noResults),text:V.formatMessage(w.Z.noResultsMatch)}),J&&i().createElement(M.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),i().createElement(n.t,{itemCount:(null==X||null===(r=X.rules)||void 0===r?void 0:r.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:L.limit,page:Y,variant:n.a.bottom,onSetPage:ee,onPerPageSelect:te}))};F.propTypes=y.R$;const q=F},19399:(e,t,a)=>{"use strict";a.d(t,{Z:()=>m});var l=a(23218),s=a(45697),r=a.n(s),n=a(93264),o=a.n(n),i=a(30893),c=a(86896),u=function(e){var t=e.isDisabled,a=e.hasMatch,s=e.displayMatch,r=void 0!==s&&s,n=(0,c.Z)();return r?o().createElement("div",null,a&&o().createElement(l._,{color:"red"},n.formatMessage(i.Z.matched)),!a&&o().createElement(l._,{color:"blue"},n.formatMessage(i.Z.notMatched))):o().createElement("div",null,t&&o().createElement(l._,null,n.formatMessage(i.Z.disabled)),!t&&o().createElement(l._,{color:"blue"},n.formatMessage(i.Z.enabled)))};u.propTypes={isDisabled:r().bool,hasMatch:r().bool,displayMatch:r().bool};const m=u},39149:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>B});var l=a(70885),s=a(4942),r=a(71070),n=a(93264),o=a.n(n),i=a(48585),c=a(1082),u=a(7732),m=a(3351),d=a(6934),f=a(22860),p=a(62410),g=a(84580),y=a(75662),h=a(52661),v=a(51957),b=a(66031),E=a(80810),M=a(19399),Z=a(35224),O=a(82779),S=a(30893),C=a(88676),w=a(86896),_=a(70846),D=a(90025);function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,s.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var N={tableVars:{limit:10,offset:0,orderBy:"LAST_SCAN_DATE_DESC",name:""},sortBy:{index:4,direction:i.B.desc},rows:[]},P={0:"DISPLAY_NAME",1:"HAS_MATCH",2:"LAST_MATCH_DATE",3:"TOTAL_MATCHES",4:"LAST_SCAN_DATE"},V=function(e){var t=e.index,a=e.direction;return"".concat(P[t],"_").concat(a===i.B.asc?"ASC":"DESC")},j=function(e,t){switch(t.type){case"setTableVars":return x(x({},e),{},{tableVars:x(x({},e.tableVars),t.payload)});case"setSortBy":return x(x({},e),{},{sortBy:t.payload,tableVars:x(x({},e.tableVars),t.tableVars)});case"setRows":return x(x({},e),{},{rows:t.payload})}return e},A=function(){var e,t,a,s,i,T,P,A=(0,w.Z)(),B=(0,n.useReducer)(j,x({},N)),L=(0,l.Z)(B,2),R=L[0],k=R.tableVars,H=R.sortBy,$=R.rows,G=L[1],I=(0,_.a)(g.c5,{variables:x(x({},k),(0,D.l)(C.WX))}),W=I.data,F=I.loading,q=I.error,X=[{title:A.formatMessage(S.Z.name),transforms:[(0,c.d)(45),u.p]},{title:A.formatMessage(S.Z.lastStatus),transforms:[u.p,(0,c.d)(10)]},{title:A.formatMessage(S.Z.lastMatched),transforms:[u.p,(0,c.d)(10)]},{title:o().createElement("span",null,(0,O.lH)({tooltip:A.formatMessage(S.Z.totalMatchesNote),title:A.formatMessage(S.Z.totalMatches)})),transforms:[u.p,(0,c.d)(15)]},{title:A.formatMessage(S.Z.lastScan),transforms:[u.p,(0,c.d)(10)]}],z=k.offset/k.limit+1,J=[{label:A.formatMessage(S.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return G({type:"setTableVars",payload:{name:t,offset:0}})},value:k.name,placeholder:A.formatMessage(S.Z.filterBy,{field:A.formatMessage(S.Z.name).toLowerCase()})}}],U=function(e,t){return G({type:"setTableVars",payload:{offset:t*k.limit-k.limit}})},Y=function(e,t){return G({type:"setTableVars",payload:{limit:t,offset:0}})},K={deleteTitle:A.formatMessage(S.Z.resetFilters),filters:(T=[],P=void 0!==(null===(s=(0,C.WX)().condition)||void 0===s?void 0:s.hasMatch)&&(null!==(i=(0,C.WX)().condition)&&void 0!==i&&i.hasMatch?A.formatMessage(S.Z.matched):A.formatMessage(S.Z.notMatched)),(null==k?void 0:k.name)&&T.push({category:A.formatMessage(S.Z.name),value:"name",chips:[{name:null==k?void 0:k.name,value:null==k?void 0:k.name}]}),P&&T.push({category:A.formatMessage(S.Z.status),value:"matched",chips:[{name:P,value:P}]}),T),onDelete:function(e,t,a){a?((0,C.WX)({}),G({type:"setTableVars",payload:{name:""}})):t.map((function(e){"name"===e.value&&G({type:"setTableVars",payload:{name:""}}),"matched"===e.value&&(0,C.WX)({})}))}};return(0,n.useEffect)((function(){var e,t;G({type:"setRows",payload:(e=W,null==e||null===(t=e.hostsList)||void 0===t?void 0:t.flatMap((function(e,t){var a;return{rowId:t,cells:[{title:o().createElement(y.Link,{to:"/systems/".concat(e.displayName)},e.displayName)},{title:o().createElement(M.Z,{isDisabled:e.isDisabled,hasMatch:e.hasMatch,displayMatch:!0})},{title:e.lastMatchDate?o().createElement(Z.u,{content:o().createElement(p.Z,{date:new Date(e.lastMatchDate),type:"exact"})},o().createElement("span",null,o().createElement(p.Z,{date:new Date(e.lastMatchDate)}))):o().createElement(Z.u,{content:A.formatMessage(S.Z.noHostHas)},o().createElement("span",null,A.formatMessage(S.Z.never)))},{title:o().createElement(y.Link,{to:"/systems/".concat(e.displayName)},null===(a=e.totalMatches)||void 0===a?void 0:a.toLocaleString())},{title:o().createElement(Z.u,{content:o().createElement(p.Z,{date:new Date(e.lastScanDate),type:"exact"})},o().createElement("span",null,o().createElement(p.Z,{date:new Date(e.lastScanDate)})))}]}})))})}),[A,W]),o().createElement(o().Fragment,null,o().createElement(b.Z,{pagination:{itemCount:(null==W||null===(e=W.hosts)||void 0===e?void 0:e.totalCount)||0,page:z,perPage:k.limit,onSetPage:function(e,t){U(0,t)},onPerPageSelect:function(e,t){Y(0,t)},isCompact:!0},filterConfig:{items:J},activeFiltersConfig:K}),o().createElement(m.i,{className:"sysTable","aria-label":"System table",rows:$,cells:X,onSort:function(e,t,a){return G({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:V({index:t,direction:a}),offset:0}})},sortBy:H,isStickyHeader:!0},o().createElement(d.x,null),o().createElement(f.R,null)),F&&o().createElement(h.Z,{type:"table"}),!F&&!q&&0===(null==W||null===(t=W.hosts)||void 0===t?void 0:t.totalCount)&&o().createElement(v.Z,{className:"pf-c-card",icon:E.W1,variant:"large",title:A.formatMessage(S.Z.noResults),text:A.formatMessage(S.Z.noResultsMatch)}),q&&o().createElement(v.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),o().createElement(r.t,{itemCount:(null==W||null===(a=W.hosts)||void 0===a?void 0:a.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:k.limit,page:z,variant:r.a.bottom,onSetPage:U,onPerPageSelect:Y}))};A.propTypes=O.R$;const B=A},32857:()=>{},3162:()=>{},28992:()=>{},21626:()=>{},21064:()=>{},82014:()=>{},54994:()=>{},37494:()=>{},67761:()=>{}}]);
//# sourceMappingURL=../sourcemaps/SigTable.0ac642335befead4a6697d7730db0629.js.map