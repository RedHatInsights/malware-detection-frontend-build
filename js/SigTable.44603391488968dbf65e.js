(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[207],{54838:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>H});var r=a(85061),l=a(28481),s=a(96156),n=a(50693),o=a(16475),i=a(71070),c=a(93264),u=a.n(c),m=a(38800),d=a(62480),f=a(1082),p=a(7732),g=a(3351),y=a(6934),h=a(22860),v=a(63540),b=a(38846),M=a(62410),E=a(84580),Z=a(16530),w=a(52661),O=a(51957),C=a(57277),D=a(80810),S=a(19399),P=a(35224),_=a(82779),T=a(30893),N=a(88676),V=a(86896),B=a(46829);function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){(0,s.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var R={tableVars:{limit:10,offset:0,orderBy:"LAST_MATCH_DATE_DESC",ruleName:""},sortBy:{index:4,direction:m.B.desc},rows:[]},k={1:"NAME",2:"HAS_MATCH",3:"IS_DISABLED",4:"HOST_COUNT",5:"LAST_MATCH_DATE"},x=function(e){var t=e.index,a=e.direction;return"".concat(k[t],"_").concat(a===m.B.asc?"ASC":"DESC")},G=function(e,t){switch(t.type){case"setTableVars":return A(A({},e),{},{tableVars:A(A({},e.tableVars),t.payload)});case"setSortBy":return A(A({},e),{},{sortBy:t.payload,tableVars:A(A({},e.tableVars),t.tableVars)});case"setRows":return A(A({},e),{},{rows:t.payload})}return e},L=function(){var e,t,a,s,m,_,j,k,L=(0,V.Z)(),H=(0,c.useReducer)(G,A({},R)),F=(0,l.Z)(H,2),I=F[0],W=I.tableVars,J=I.sortBy,q=I.rows,z=F[1],Q=(0,B.useQuery)(E.tE,{variables:A(A({},W),(0,B.useReactiveVar)(N.gG))}),U=Q.data,$=Q.loading,K=Q.error,X=[{title:L.formatMessage(T.Z.sigName),cellFormatters:[d.zW],transforms:[(0,f.d)(45),p.p]},{title:L.formatMessage(T.Z.status),transforms:[p.p]},{title:L.formatMessage(T.Z.enablement),transforms:[p.p]},{title:L.formatMessage(T.Z.systems),transforms:[p.p]},{title:L.formatMessage(T.Z.matched),transforms:[p.p]}],Y=W.offset/W.limit+1,ee={sig_match:{type:"radio",title:L.formatMessage(T.Z.status),urlParam:"sig_match",values:[{label:L.formatMessage(T.Z.all),value:"all"},{label:L.formatMessage(T.Z.matched),value:"true"},{label:L.formatMessage(T.Z.notMatched),value:"false"}]}},te=[{label:L.formatMessage(T.Z.signature).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return z({type:"setTableVars",payload:{ruleName:t}})},value:W.ruleName,placeholder:L.formatMessage(T.Z.filterBy,{field:L.formatMessage(T.Z.signature).toLowerCase()})}},{label:ee.sig_match.title.toLowerCase(),type:ee.sig_match.type,id:ee.sig_match.urlParam,value:"radio-".concat(ee.sig_match.urlParam),filterValues:{key:"".concat(ee.sig_match.urlParam,"-filter"),onChange:function(e,t){var a=(0,N.gG)();"all"===t&&(null==a||delete a.condition),"all"===t?(0,N.gG)(A({},a)):(0,N.gG)(A(A({},a),{},{condition:{hasMatch:JSON.parse(t)}}))},value:JSON.stringify(null===(e=(0,N.gG)().condition)||void 0===e?void 0:e.hasMatch)||"all",items:ee.sig_match.values}}],ae=function(e,t){return z({type:"setTableVars",payload:{offset:t*W.limit-W.limit}})},re=function(e,t){return z({type:"setTableVars",payload:{limit:t,offset:0}})},le={deleteTitle:L.formatMessage(T.Z.resetFilters),filters:(j=[],k=void 0!==(null===(m=(0,N.gG)().condition)||void 0===m?void 0:m.hasMatch)&&(null!==(_=(0,N.gG)().condition)&&void 0!==_&&_.hasMatch?L.formatMessage(T.Z.matched):L.formatMessage(T.Z.notMatched)),(null==W?void 0:W.ruleName)&&j.push({category:L.formatMessage(T.Z.signature),value:"name",chips:[{name:null==W?void 0:W.ruleName,value:null==W?void 0:W.ruleName}]}),k&&j.push({category:L.formatMessage(T.Z.status),value:"matched",chips:[{name:k,value:k}]}),j),onDelete:function(e,t,a){a?((0,N.gG)({}),z({type:"setTableVars",payload:{ruleName:""}})):t.map((function(e){"name"===e.value&&z({type:"setTableVars",payload:{ruleName:""}}),"matched"===e.value&&(0,N.gG)({})}))}};return(0,c.useEffect)((function(){var e,t;z({type:"setRows",payload:(e=U,null==e||null===(t=e.rulesList)||void 0===t?void 0:t.flatMap((function(e,t){var a,r=e;return[{rowId:t,isOpen:!1,cells:[{title:u().createElement(Z.Link,{to:"/".concat(r.name)},r.name)},{title:u().createElement(S.Z,{isDisabled:r.isDisabled,hasMatch:r.hasMatch,displayMatch:!0})},{title:u().createElement(S.Z,{isDisabled:r.isDisabled,hasMatch:r.hasMatch})},{title:u().createElement(Z.Link,{to:"/".concat(r.name)},null===(a=r.hostCount)||void 0===a?void 0:a.toLocaleString())},{title:r.lastMatchDate?u().createElement(P.u,{content:u().createElement(M.Z,{date:new Date(r.lastMatchDate),type:"exact"})},u().createElement("span",null,u().createElement(M.Z,{date:new Date(r.lastMatchDate),type:"onlyDate"}))):u().createElement(P.u,{content:L.formatMessage(T.Z.noHostHas)},u().createElement("span",null,L.formatMessage(T.Z.never)))}]},{parent:2*t,sigData:r,fullWidth:!0,cells:[]}]})))})}),[L,U]),u().createElement(u().Fragment,null,u().createElement(C.Z,{pagination:{itemCount:(null==U||null===(t=U.rules)||void 0===t?void 0:t.totalCount)||0,page:Y,perPage:W.limit,onSetPage:function(e,t){ae(0,t)},onPerPageSelect:function(e,t){re(0,t)},isCompact:!0},filterConfig:{items:te},activeFiltersConfig:le}),u().createElement(g.i,{className:"sigTable","aria-label":"Signature table",onCollapse:function(e,t,a){var l=(0,r.Z)(q),s=l[t+1].sigData;l[t]=A(A({},l[t]),{},{isOpen:a}),l[t+1].cells=[{title:u().createElement(n.r,{hasGutter:!0},u().createElement(o.P,{span:6},u().createElement(b.Z,{code:s.rawRule,isReadOnly:!0})),u().createElement(o.P,{span:6}," ",u().createElement(v.xv,{className:"ins-l-sigtable--title",component:v.qO.h6},L.formatMessage(T.Z.description)),s.metadata.description))}],z({type:"setRows",payload:l})},rows:q,cells:X,onSort:function(e,t,a){return z({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:x({index:t,direction:a}),offset:0}})},sortBy:J,isStickyHeader:!0},u().createElement(y.x,null),u().createElement(h.R,null)),$&&u().createElement(w.Z,{type:"table"}),!$&&!K&&0===(null==U||null===(a=U.rules)||void 0===a?void 0:a.totalCount)&&u().createElement(O.Z,{className:"pf-c-card",icon:D.W1,variant:"large",title:L.formatMessage(T.Z.noResults),text:L.formatMessage(T.Z.noResultsMatch)}),K&&u().createElement(O.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),u().createElement(i.t,{itemCount:(null==U||null===(s=U.rules)||void 0===s?void 0:s.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:W.limit,page:Y,variant:i.a.bottom,onSetPage:ae,onPerPageSelect:re}))};L.propTypes=_.R$;const H=L}}]);
//# sourceMappingURL=../sourcemaps/SigTable.c9d890f0b009935fa12a.js.map