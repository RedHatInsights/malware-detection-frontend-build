(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[207],{54838:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>G});var r=a(85061),l=a(28481),n=a(96156),s=a(50693),o=a(16475),i=a(71070),c=a(93264),u=a.n(c),m=a(38800),d=a(62480),f=a(1082),p=a(7732),g=a(3351),y=a(6934),v=a(22860),h=a(63540),b=a(38846),M=a(62410),E=a(84580),Z=a(16530),w=a(52661),D=a(51957),O=a(57277),S=a(80810),C=a(19399),P=a(35224),T=a(82779),V=a(30893),_=a(88676),N=a(86896),A=a(46829);function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var x={tableVars:{limit:10,offset:0,orderBy:"LAST_MATCH_DATE_DESC",ruleName:""},sortBy:{index:4,direction:m.B.desc},rows:[]},L={1:"NAME",2:"HAS_MATCH",3:"IS_DISABLED",4:"HOST_COUNT",5:"LAST_MATCH_DATE"},R=function(e){var t=e.index,a=e.direction;return"".concat(L[t],"_").concat(a===m.B.asc?"ASC":"DESC")},k=function(e,t){switch(t.type){case"setTableVars":return j(j({},e),{},{tableVars:j(j({},e.tableVars),t.payload)});case"setSortBy":return j(j({},e),{},{sortBy:t.payload,tableVars:j(j({},e.tableVars),t.tableVars)});case"setRows":return j(j({},e),{},{rows:t.payload})}return e},H=function(){var e,t,a,n,m,T,B,L,H=(0,N.Z)(),G=(0,c.useReducer)(k,j({},x)),W=(0,l.Z)(G,2),F=W[0],I=F.tableVars,X=F.sortBy,U=F.rows,J=W[1],Q=(0,A.useQuery)(E.tE,{variables:j(j({},I),(0,A.useReactiveVar)(_.gG))}),$=Q.data,q=Q.loading,z=Q.error,Y=[{title:H.formatMessage(V.Z.sigName),cellFormatters:[d.zW],transforms:[(0,f.d)(45),p.p]},{title:H.formatMessage(V.Z.status),transforms:[p.p]},{title:H.formatMessage(V.Z.enablement),transforms:[p.p]},{title:H.formatMessage(V.Z.systems),transforms:[p.p]},{title:H.formatMessage(V.Z.matched),transforms:[p.p]}],K=I.offset/I.limit+1,ee={sig_match:{type:"radio",title:H.formatMessage(V.Z.status),urlParam:"sig_match",values:[{label:H.formatMessage(V.Z.all),value:"all"},{label:H.formatMessage(V.Z.matched),value:"true"},{label:H.formatMessage(V.Z.notMatched),value:"false"}]}},te=[{label:H.formatMessage(V.Z.signature).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return J({type:"setTableVars",payload:{ruleName:t}})},value:I.ruleName,placeholder:H.formatMessage(V.Z.filterBy,{field:H.formatMessage(V.Z.signature).toLowerCase()})}},{label:ee.sig_match.title.toLowerCase(),type:ee.sig_match.type,id:ee.sig_match.urlParam,value:"radio-".concat(ee.sig_match.urlParam),filterValues:{key:"".concat(ee.sig_match.urlParam,"-filter"),onChange:function(e,t){var a=(0,_.gG)();"all"===t&&(null==a||delete a.condition),"all"===t?(0,_.gG)(j({},a)):(0,_.gG)(j(j({},a),{},{condition:{hasMatch:JSON.parse(t)}}))},value:JSON.stringify(null===(e=(0,_.gG)().condition)||void 0===e?void 0:e.hasMatch)||"all",items:ee.sig_match.values}}],ae=function(e,t){return J({type:"setTableVars",payload:{offset:t*I.limit-I.limit}})},re=function(e,t){return J({type:"setTableVars",payload:{limit:t,offset:0}})},le={deleteTitle:H.formatMessage(V.Z.resetFilters),filters:(B=[],L=void 0!==(null===(m=(0,_.gG)().condition)||void 0===m?void 0:m.hasMatch)&&(null!==(T=(0,_.gG)().condition)&&void 0!==T&&T.hasMatch?H.formatMessage(V.Z.matched):H.formatMessage(V.Z.notMatched)),(null==I?void 0:I.ruleName)&&B.push({category:H.formatMessage(V.Z.signature),value:"name",chips:[{name:null==I?void 0:I.ruleName,value:null==I?void 0:I.ruleName}]}),L&&B.push({category:H.formatMessage(V.Z.status),value:"matched",chips:[{name:L,value:L}]}),B),onDelete:function(e,t,a){a?((0,_.gG)({}),J({type:"setTableVars",payload:{ruleName:""}})):t.map((function(e){"name"===e.value&&J({type:"setTableVars",payload:{ruleName:""}}),"matched"===e.value&&(0,_.gG)({})}))}};return(0,c.useEffect)((function(){var e,t;J({type:"setRows",payload:(e=$,null==e||null===(t=e.rulesList)||void 0===t?void 0:t.flatMap((function(e,t){var a,r=e;return[{rowId:t,isOpen:!1,cells:[{title:u().createElement(Z.Link,{to:"/signatures/".concat(r.name)},r.name)},{title:u().createElement(C.Z,{isDisabled:r.isDisabled,hasMatch:r.hasMatch,displayMatch:!0})},{title:u().createElement(C.Z,{isDisabled:r.isDisabled,hasMatch:r.hasMatch})},{title:u().createElement(Z.Link,{to:"/signatures/".concat(r.name)},null===(a=r.hostCount)||void 0===a?void 0:a.toLocaleString())},{title:r.lastMatchDate?u().createElement(P.u,{content:u().createElement(M.Z,{date:new Date(r.lastMatchDate),type:"exact"})},u().createElement("span",null,u().createElement(M.Z,{date:new Date(r.lastMatchDate),type:"onlyDate"}))):u().createElement(P.u,{content:H.formatMessage(V.Z.noHostHas)},u().createElement("span",null,H.formatMessage(V.Z.never)))}]},{parent:2*t,sigData:r,fullWidth:!0,cells:[]}]})))})}),[H,$]),u().createElement(u().Fragment,null,u().createElement(O.Z,{pagination:{itemCount:(null==$||null===(t=$.rules)||void 0===t?void 0:t.totalCount)||0,page:K,perPage:I.limit,onSetPage:function(e,t){ae(0,t)},onPerPageSelect:function(e,t){re(0,t)},isCompact:!0},filterConfig:{items:te},activeFiltersConfig:le}),u().createElement(g.i,{className:"sigTable","aria-label":"Signature table",onCollapse:function(e,t,a){var l=(0,r.Z)(U),n=l[t+1].sigData;l[t]=j(j({},l[t]),{},{isOpen:a}),l[t+1].cells=[{title:u().createElement(s.r,{hasGutter:!0},u().createElement(o.P,{span:6},u().createElement(b.Z,{code:n.rawRule,isReadOnly:!0})),u().createElement(o.P,{span:6}," ",u().createElement(h.xv,{className:"ins-l-sigtable--title",component:h.qO.h6},H.formatMessage(V.Z.description)),n.metadata.description))}],J({type:"setRows",payload:l})},rows:U,cells:Y,onSort:function(e,t,a){return J({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:R({index:t,direction:a}),offset:0}})},sortBy:X,isStickyHeader:!0},u().createElement(y.x,null),u().createElement(v.R,null)),q&&u().createElement(w.Z,{type:"table"}),!q&&!z&&0===(null==$||null===(a=$.rules)||void 0===a?void 0:a.totalCount)&&u().createElement(D.Z,{className:"pf-c-card",icon:S.W1,variant:"large",title:H.formatMessage(V.Z.noResults),text:H.formatMessage(V.Z.noResultsMatch)}),z&&u().createElement(D.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),u().createElement(i.t,{itemCount:(null==$||null===(n=$.rules)||void 0===n?void 0:n.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:I.limit,page:K,variant:i.a.bottom,onSetPage:ae,onPerPageSelect:re}))};H.propTypes=T.R$;const G=H},39149:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var r=a(28481),l=a(96156),n=a(71070),s=a(93264),o=a.n(s),i=a(38800),c=a(1082),u=a(7732),m=a(3351),d=a(6934),f=a(22860),p=a(62410),g=a(84580),y=a(16530),v=a(52661),h=a(51957),b=a(57277),M=a(80810),E=a(19399),Z=a(35224),w=a(82779),D=a(30893),O=a(88676),S=a(86896),C=a(46829);function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function T(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,l.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var V={tableVars:{limit:10,offset:0,orderBy:"UPDATED_DESC",name:""},sortBy:{index:4,direction:i.B.desc},rows:[]},_={0:"DISPLAY_NAME",1:"HAS_MATCH",2:"LAST_MATCH_DATE",3:"TOTAL_MATCHES",4:"UPDATED"},N=function(e){var t=e.index,a=e.direction;return"".concat(_[t],"_").concat(a===i.B.asc?"ASC":"DESC")},A=function(e,t){switch(t.type){case"setTableVars":return T(T({},e),{},{tableVars:T(T({},e.tableVars),t.payload)});case"setSortBy":return T(T({},e),{},{sortBy:t.payload,tableVars:T(T({},e.tableVars),t.tableVars)});case"setRows":return T(T({},e),{},{rows:t.payload})}return e},B=function(){var e,t,a,l,i,w,P,_=(0,S.Z)(),B=(0,s.useReducer)(A,T({},V)),j=(0,r.Z)(B,2),x=j[0],L=x.tableVars,R=x.sortBy,k=x.rows,H=j[1],G=(0,C.useQuery)(g.c5,{variables:T(T({},L),(0,C.useReactiveVar)(O.WX))}),W=G.data,F=G.loading,I=G.error,X=[{title:_.formatMessage(D.Z.name),transforms:[(0,c.d)(45),u.p]},{title:_.formatMessage(D.Z.status),transforms:[u.p]},{title:_.formatMessage(D.Z.matched),transforms:[u.p]},{title:_.formatMessage(D.Z.totalMatches),transforms:[u.p]},{title:_.formatMessage(D.Z.lastSeen),transforms:[u.p]}],U=L.offset/L.limit+1,J=[{label:_.formatMessage(D.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return H({type:"setTableVars",payload:{name:t}})},value:L.name,placeholder:_.formatMessage(D.Z.filterBy,{field:_.formatMessage(D.Z.name).toLowerCase()})}}],Q=function(e,t){return H({type:"setTableVars",payload:{offset:t*L.limit-L.limit}})},$=function(e,t){return H({type:"setTableVars",payload:{limit:t,offset:0}})},q={deleteTitle:_.formatMessage(D.Z.resetFilters),filters:(w=[],P=void 0!==(null===(l=(0,O.WX)().condition)||void 0===l?void 0:l.hasMatch)&&(null!==(i=(0,O.WX)().condition)&&void 0!==i&&i.hasMatch?_.formatMessage(D.Z.matched):_.formatMessage(D.Z.notMatched)),(null==L?void 0:L.name)&&w.push({category:_.formatMessage(D.Z.name),value:"name",chips:[{name:null==L?void 0:L.name,value:null==L?void 0:L.name}]}),P&&w.push({category:_.formatMessage(D.Z.status),value:"matched",chips:[{name:P,value:P}]}),w),onDelete:function(e,t,a){a?((0,O.WX)({}),H({type:"setTableVars",payload:{name:""}})):t.map((function(e){"name"===e.value&&H({type:"setTableVars",payload:{name:""}}),"matched"===e.value&&(0,O.WX)({})}))}};return(0,s.useEffect)((function(){var e,t;H({type:"setRows",payload:(e=W,null==e||null===(t=e.hostsList)||void 0===t?void 0:t.flatMap((function(e,t){var a;return{rowId:t,cells:[{title:o().createElement(y.Link,{to:"/systems/".concat(e.displayName)},e.displayName)},{title:o().createElement(E.Z,{isDisabled:e.isDisabled,hasMatch:e.hasMatch,displayMatch:!0})},{title:e.lastMatchDate?o().createElement(Z.u,{content:o().createElement(p.Z,{date:new Date(e.lastMatchDate),type:"exact"})},o().createElement("span",null,o().createElement(p.Z,{date:new Date(e.lastMatchDate),type:"onlyDate"}))):o().createElement(Z.u,{content:_.formatMessage(D.Z.noHostHas)},o().createElement("span",null,_.formatMessage(D.Z.never)))},{title:o().createElement(y.Link,{to:"/systems/".concat(e.displayName)},null===(a=e.totalMatches)||void 0===a?void 0:a.toLocaleString())},{title:o().createElement(Z.u,{content:o().createElement(p.Z,{date:new Date(e.updated),type:"exact"})},o().createElement("span",null,o().createElement(p.Z,{date:new Date(e.updated)})))}]}})))})}),[_,W]),o().createElement(o().Fragment,null,o().createElement(b.Z,{pagination:{itemCount:(null==W||null===(e=W.hosts)||void 0===e?void 0:e.totalCount)||0,page:U,perPage:L.limit,onSetPage:function(e,t){Q(0,t)},onPerPageSelect:function(e,t){$(0,t)},isCompact:!0},filterConfig:{items:J},activeFiltersConfig:q}),o().createElement(m.i,{className:"sysTable","aria-label":"System table",rows:k,cells:X,onSort:function(e,t,a){return H({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:N({index:t,direction:a}),offset:0}})},sortBy:R,isStickyHeader:!0},o().createElement(d.x,null),o().createElement(f.R,null)),F&&o().createElement(v.Z,{type:"table"}),!F&&!I&&0===(null==W||null===(t=W.hosts)||void 0===t?void 0:t.totalCount)&&o().createElement(h.Z,{className:"pf-c-card",icon:M.W1,variant:"large",title:_.formatMessage(D.Z.noResults),text:_.formatMessage(D.Z.noResultsMatch)}),I&&o().createElement(h.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),o().createElement(n.t,{itemCount:(null==W||null===(a=W.hosts)||void 0===a?void 0:a.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:L.limit,page:U,variant:n.a.bottom,onSetPage:Q,onPerPageSelect:$}))};B.propTypes=w.R$;const j=B}}]);
//# sourceMappingURL=../sourcemaps/SigTable.2486d3ce01a35df4548e.js.map