(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[207],{54838:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>H});var r=a(85061),l=a(28481),n=a(96156),s=(a(13111),a(50693)),o=a(16475),i=a(71070),c=a(93264),u=a.n(c),m=a(38800),f=a(62480),d=a(1082),p=a(7732),g=a(3351),b=a(6934),y=a(22860),v=a(63540),h=a(38846),E=a(62410),w=a(84580),Z=a(16530),M=a(52661),C=a(51957),O=a(57277),P=a(80810),S=a(19399),_=a(35224),D=a(82779),A=a(30893),T=a(88676),V=a(86896),B=a(46829);function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function N(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var R={tableVars:{limit:10,offset:0,orderBy:"LAST_MATCH_DATE_DESC",ruleName:""},sortBy:{index:4,direction:m.B.desc},rows:[]},k={1:"NAME",2:"IS_DISABLED",3:"HOST_COUNT",4:"LAST_MATCH_DATE"},x=function(e){var t=e.index,a=e.direction;return"".concat(k[t],"_").concat(a===m.B.asc?"ASC":"DESC")},L=function(e,t){switch(t.type){case"setTableVars":return N(N({},e),{},{tableVars:N(N({},e.tableVars),t.payload)});case"setSortBy":return N(N({},e),{},{sortBy:t.payload,tableVars:N(N({},e.tableVars),t.tableVars)});case"setRows":return N(N({},e),{},{rows:t.payload})}return e},G=function(){var e,t,a,n,m=(0,V.Z)(),D=(0,c.useReducer)(L,N({},R)),j=(0,l.Z)(D,2),k=j[0],G=k.tableVars,H=k.sortBy,W=k.rows,F=j[1],I=(0,B.useQuery)(w.tE,{variables:N(N({},G),(0,B.useReactiveVar)(T.gG))}),J=I.data,q=I.loading,z=I.error,Q=[{title:m.formatMessage(A.Z.sigName),cellFormatters:[f.zW],transforms:[(0,d.d)(45),p.p]},{title:m.formatMessage(A.Z.status),transforms:[p.p]},{title:m.formatMessage(A.Z.hosts),transforms:[p.p]},{title:m.formatMessage(A.Z.matched),transforms:[p.p]}],U=G.offset/G.limit+1,K={sig_match:{type:"radio",title:m.formatMessage(A.Z.status),urlParam:"sig_match",values:[{label:m.formatMessage(A.Z.all),value:"all"},{label:m.formatMessage(A.Z.matched),value:"true"},{label:m.formatMessage(A.Z.notMatched),value:"false"}]}},X=[{label:m.formatMessage(A.Z.signature).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return F({type:"setTableVars",payload:{ruleName:t}})},value:G.ruleName,placeholder:m.formatMessage(A.Z.filterBy,{field:m.formatMessage(A.Z.signature).toLowerCase()})}},{label:K.sig_match.title,type:K.sig_match.type,id:K.sig_match.urlParam,value:"radio-".concat(K.sig_match.urlParam),filterValues:{key:"".concat(K.sig_match.urlParam,"-filter"),onChange:function(e,t){var a=(0,T.gG)();"all"===t&&(null==a||delete a.condition),"all"===t?(0,T.gG)(N({},a)):(0,T.gG)(N(N({},a),{},{condition:{hasMatch:JSON.parse(t)}}))},value:JSON.stringify(null===(e=(0,T.gG)().condition)||void 0===e?void 0:e.hasMatch)||"all",items:K.sig_match.values}}],Y=function(e,t){return F({type:"setTableVars",payload:{offset:t*G.limit-G.limit}})},$=function(e,t){return F({type:"setTableVars",payload:{limit:t,offset:0}})};return(0,c.useEffect)((function(){var e,t;F({type:"setRows",payload:(e=J,null==e||null===(t=e.rulesList)||void 0===t?void 0:t.flatMap((function(e,t){var a=e;return[{rowId:t,isOpen:!1,cells:[{title:u().createElement(Z.Link,{to:"/".concat(a.name)},a.name)},{title:u().createElement("span",null,u().createElement(S.Z,a))},{title:u().createElement(Z.Link,{to:"/".concat(a.name)},a.hostCount)},{title:a.lastMatchDate?u().createElement(E.Z,{date:new Date(a.lastMatchDate),type:"onlyDate"}):u().createElement(_.u,{content:m.formatMessage(A.Z.noHostHas)},u().createElement("span",null,m.formatMessage(A.Z.never)))}]},{parent:2*t,sigData:a,fullWidth:!0,cells:[]}]})))})}),[m,J]),u().createElement(u().Fragment,null,u().createElement(O.Z,{pagination:{itemCount:(null==J||null===(t=J.rules)||void 0===t?void 0:t.totalCount)||0,page:U,perPage:G.limit,onSetPage:function(e,t){Y(0,t)},onPerPageSelect:function(e,t){$(0,t)},isCompact:!0},filterConfig:{items:X}}),u().createElement(g.i,{className:"sigTable","aria-label":"Signature table",onCollapse:function(e,t,a){var l=(0,r.Z)(W),n=l[t+1].sigData;l[t]=N(N({},l[t]),{},{isOpen:a}),l[t+1].cells=[{title:u().createElement(s.r,{hasGutter:!0},u().createElement(o.P,{span:6},u().createElement(h.Z,{code:n.rawRule,language:"objective-c",isReadOnly:!0})),u().createElement(o.P,{span:6}," ",u().createElement(v.xv,{className:"ins-l-sigtable--title",component:v.qO.h6},m.formatMessage(A.Z.description)),n.metadata.description))}],F({type:"setRows",payload:l})},rows:W,cells:Q,onSort:function(e,t,a){return F({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:x({index:t,direction:a}),offset:0}})},sortBy:H},u().createElement(b.x,null),u().createElement(y.R,null)),q&&u().createElement(M.Z,{type:"table"}),!q&&!z&&0===(null==J||null===(a=J.rules)||void 0===a?void 0:a.totalCount)&&u().createElement(C.Z,{className:"pf-c-card",icon:P.W1,variant:"large",title:m.formatMessage(A.Z.noResults),text:m.formatMessage(A.Z.noResultsMatch)}),z&&u().createElement(C.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),u().createElement(i.t,{itemCount:(null==J||null===(n=J.rules)||void 0===n?void 0:n.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:G.limit,page:U,variant:i.a.bottom,onSetPage:Y,onPerPageSelect:$}))};G.propTypes=D.R;const H=G},78286:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var r=a(94015),l=a.n(r),n=a(23645),s=a.n(n)()(l());s.push([e.id,".malware .ins-l-sigtable--title{font-weight:var(--pf-global--FontWeight--semi-bold)}\n","",{version:3,sources:["webpack://./src/Components/SigTable/SigTable.scss"],names:[],mappings:"AAAA,gCACuB,mDAAmD",sourcesContent:[".malware{\n.ins-l-sigtable--title{font-weight:var(--pf-global--FontWeight--semi-bold)}\n\n}"],sourceRoot:""}]);const o=s},13111:(e,t,a)=>{"use strict";var r=a(93379),l=a.n(r),n=a(78286),s=l()(n.default,{insert:"head",singleton:!1});if(!n.default.locals||e.hot.invalidate){var o=n.default.locals;e.hot.accept(78286,(t=>{n=a(78286),function(e,t,a){if(!e&&t||e&&!t)return!1;var r;for(r in e)if(e[r]!==t[r])return!1;for(r in t)if(!e[r])return!1;return!0}(o,n.default.locals)?(o=n.default.locals,s(n.default)):e.hot.invalidate()}))}e.hot.dispose((function(){s()})),n.default.locals}}]);
//# sourceMappingURL=../sourcemaps/SigTable.ad24b683e0df9ea0a5f5.js.map