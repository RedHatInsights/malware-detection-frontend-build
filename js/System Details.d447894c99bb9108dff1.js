(self.webpackChunkmalware=self.webpackChunkmalware||[]).push([[4322],{9791:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});var s=a(69291),l=a(45697),r=a.n(l),n=a(28416),o=a.n(n);const m=({items:e})=>{const t=e.pop();return o().createElement(s.Breadcrumb,null,e.map(((e,t)=>o().createElement(s.BreadcrumbItem,{key:t,to:e.to},e.name))),o().createElement(s.BreadcrumbItem,{isActive:!0},t.name))};m.propTypes={items:r().array};const c=m},27112:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>J});var s=a(50693),l=a(16475),r=a(38779),n=a(9791),o=a(62410),m=a(51364),c=a(83920),i=a(99087),d=a(63456),u=a(39173),p=a(28416),f=a.n(p),g=a(55573),h=a(38800),y=a(5756),E=a(7732),M=a(1082),Z=a(86379),b=a(43416),S=a(49004),D=a(58027),C=a(15433),w=a(73993),N=a.n(w),T=a(20864),v=a(33203),B=a(41841),P=a(10097),$=a(4036),A=a(86197),V=a(2550),x=a(45697),R=a.n(x),I=a(86896),k=a(71641),F=a(92397),L=a(12913);const _={1:"NAME",2:"LAST_STATUS",3:"LAST_MATCH_DATE",4:"MATCH_COUNT"},H=({index:e,direction:t})=>`${_[e]}_${t===h.B.asc?"ASC":"DESC"}`,O=(e,t)=>{switch(t.type){case"setTableVars":return{...e,tableVars:{...e.tableVars,...t.payload}};case"setSortBy":return{...e,sortBy:t.payload,tableVars:{...e.tableVars,...t.tableVars}};case"setRows":return{...e,rows:t.payload}}return e},W=({systemId:e})=>{const t=(0,I.Z)(),a={tableVars:{limit:10,offset:0,orderBy:"LAST_MATCH_DATE_ASC",ruleName:"",systemId:e},sortBy:{index:2,direction:h.B.asc},rows:[]},[{tableVars:s,sortBy:l,rows:r},n]=(0,p.useReducer)(O,{...a}),{data:c,loading:i,error:d}=(0,k.a)(m.W0,{variables:s}),u=[{title:t.formatMessage(V.Z.sigName),cellFormatters:[y.zW],transforms:[E.p,(0,M.d)(55)]},{title:t.formatMessage(V.Z.lastStatus),transforms:[(0,M.d)(10),E.p]},{title:t.formatMessage(V.Z.matched),transforms:[E.p,(0,M.d)(10)]},{title:t.formatMessage(V.Z.totalMatches),transforms:[(0,M.d)(15),(0,Z.u)({tooltip:t.formatMessage(V.Z.totalMatchesNote)}),E.p]}],w=s.offset/s.limit+1,x=[{label:t.formatMessage(V.Z.sig).toLowerCase(),type:"text",filterValues:{key:"text-filter",onChange:(e,t)=>n({type:"setTableVars",payload:{ruleName:t,offset:0}}),value:s.ruleName,placeholder:t.formatMessage(V.Z.filterBy,{field:t.formatMessage(V.Z.sig).toLowerCase()})}}],R=(e,t)=>n({type:"setTableVars",payload:{offset:t*s.limit-s.limit}}),_=(e,t)=>n({type:"setTableVars",payload:{limit:t,offset:0}});(0,p.useEffect)((()=>{!i&&n({type:"setRows",payload:(e=>e?.host.affectedRulesList.flatMap(((e,t)=>[{rowId:t,isOpen:!1,cells:[{title:f().createElement(F.Z,{to:`/signatures/${e.name}`},e.name)},{title:f().createElement(A.Z,{isDisabled:e.isDisabled,hasMatch:e.lastStatus,displayMatch:!0})},{title:f().createElement(o.Z,{date:new Date(e.lastMatchDate),type:"onlyDate"})},{title:f().createElement(F.Z,{to:`/signatures/${e.name}`},e.matchCount?.toLocaleString())}]},{parent:2*t,hostData:e,fullWidth:!0,cells:[]}])))(c)})}),[t,c,i]);const W={deleteTitle:t.formatMessage(V.Z.resetFilters),filters:s?.ruleName?[{category:t.formatMessage(V.Z.signature),value:"signature",chips:[{name:s.ruleName,value:s.ruleName}]}]:[],showDeleteButton:""!==s?.ruleName,onDelete:()=>n({type:"setTableVars",payload:{ruleName:"",offset:0}})};return f().createElement(f().Fragment,null,f().createElement(P.Z,{pagination:{itemCount:c?.host?.affectedRules?.totalCount||0,page:w,perPage:s.limit,onSetPage(e,t){R(0,t)},onPerPageSelect(e,t){_(0,t)},isCompact:!0},filterConfig:{items:x},activeFiltersConfig:W}),!i&&f().createElement(b.i,{className:"sigTable","aria-label":"Signature Details table",rows:r,cells:u,onCollapse:(e,t,a)=>{const s=[...r],l=s[t+1].hostData;s[t]={...s[t],isOpen:a},s[t+1].cells=[{title:f().createElement(T.Z,{height:"250px",code:`${l.matches.map(((e,t)=>`Match Source: ${e.source}\nOffset:${e.stringOffset}\nMatch Data: ${e.stringData}\nMatch Identifier: ${e.stringIdentifier}\nMatch Scan Date: ${new Date(e.scanDate).toUTCString()}\n${e.metadata?(0,v.Wi)(JSON.parse(e.metadata.replaceAll("\n",""))):""}\n${l.matches.length>1&&t!==l.matches.length-1?"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n":""}`)).join("")}`,isDownloadEnabled:!0,isCopyEnabled:!0})}],n({type:"setRows",payload:s})},onSort:(e,t,a)=>n({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:H({index:t,direction:a}),offset:0}}),sortBy:c?.host?.affectedRules?.totalCount>0?l:void 0,isStickyHeader:!0},f().createElement(S.x,null),f().createElement(D.R,null)),i?f().createElement(L.Z,{rows:s.limit,columns:u.map((e=>e.title))}):d?f().createElement(B.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}):c?.host?.lastMatchDate?0===c?.host?.affectedRules?.totalCount?f().createElement(B.Z,{className:"pf-c-card",icon:$.SearchIcon,variant:"large",title:t.formatMessage(V.Z.noResults),text:t.formatMessage(V.Z.noResultsMatch)}):f().createElement(f().Fragment,null):f().createElement(B.Z,{className:"pf-c-card",variant:"large",icon:N(),iconClass:"ins-l-success-color",title:t.formatMessage(V.Z.notMatched),text:t.formatMessage(V.Z.notMatchedBody)}),f().createElement(C.Z,{isFooter:!0},f().createElement(g.t,{itemCount:c?.host?.affectedRules?.totalCount||0,widgetId:"pagination-options-menu-bottom",perPage:s.limit,page:w,variant:g.a.bottom,onSetPage:R,onPerPageSelect:_})))};W.propTypes={systemId:R().string};const U=W;var G=a(51663),j=a(55140);const z=()=>{const e=(0,I.Z)(),{id:t}=(0,G.useParams)(),{data:a,loading:g}=(0,k.a)(m.kK,{variables:{id:t}}),h=a?.hosts?.nodes[0],y=[{name:e.formatMessage(V.Z.malwareDetectionSys),to:`${(0,v.hN)()}/insights/malware/systems`},{name:h?.displayName,to:"#"}],E=(e,t)=>f().createElement(f().Fragment,null,f().createElement("p",null,e),f().createElement("p",null,t)),M=(0,j.Z)();return(0,p.useEffect)((()=>{h&&M.updateDocumentTitle(`${h.displayName} - Systems - Malware | Red Hat Insights`)}),[M,h]),f().createElement(f().Fragment,null,f().createElement(d.Z,null,f().createElement(n.Z,{items:y}),f().createElement(u.Z,{title:h?.displayName,className:"pf-u-mb-md"}),f().createElement(s.r,{hasGutter:!0},g?f().createElement(c.Z,null):f().createElement(l.P,{xl:5,lg:12,md:12,sm:12},f().createElement(s.r,{hasGutter:!0},f().createElement(l.P,{span:12},f().createElement("p",null,`${e.formatMessage(V.Z.uuid)}: ${h.id}`)),f().createElement(l.P,{span:4},E(e.formatMessage(V.Z.lastmatch),h?.lastMatchDate?f().createElement(o.Z,{date:new Date(h.lastMatchDate),type:"onlyDate"}):e.formatMessage(V.Z.never))),f().createElement(l.P,{span:4},E(e.formatMessage(V.Z.lastScan),f().createElement(o.Z,{date:new Date(h.lastScanDate),type:"exact"}))),f().createElement(l.P,{span:4},E((0,v.lH)({tooltip:e.formatMessage(V.Z.totalMatchesNote),title:e.formatMessage(V.Z.totalMatches)}),h?.totalMatches)))),f().createElement(l.P,{md:7,sm:0}))),f().createElement(i.ZP,null,f().createElement(r.D,{className:"ins-l-tableBlockHeader",headingLevel:"h2"},e.formatMessage(V.Z.matchedSignaturesCount,{matchedCount:h?.totalMatches})),g?f().createElement(c.Z,null):f().createElement(U,{systemId:h.id})))};z.propTypes={title:R().string};const J=z},65088:()=>{},58392:()=>{}}]);
//# sourceMappingURL=../sourcemaps/System Details.bafe1205908ed577d90157c579d6e62f.js.map