{"version":3,"file":"js/5656.1666875715641.6539d5e742024347d27f.js","mappings":"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","sources":["webpack:///./config/empty.js","webpack:///./src/Routes/NoPermissionsPage/NoPermissionsPage.js","webpack:///./src/Components/Permissions.js","webpack:///./src/Routes.js","webpack:///./src/App.js","webpack:///./src/Components/Common.js","webpack:///./src/Components/Loading/Loading.js","webpack:///./src/Messages.js","webpack:///./src/operations/queries.js","webpack:///./src/store/cache.js","webpack:///./src/store/index.js"],"sourcesContent":["// Used as an empty module to save bundle size\nmodule.exports = {};\n","import React, { useEffect } from 'react';\n\nimport { Main } from '@redhat-cloud-services/frontend-components/Main';\nimport { NotAuthorized } from '@redhat-cloud-services/frontend-components/NotAuthorized';\nimport { capitalize } from '../../Components/Common';\nimport messages from '../../Messages';\nimport { useIntl } from 'react-intl';\nimport { withRouter } from 'react-router-dom';\n\nconst NoPermissionsPage = () => {\n    const intl = useIntl();\n    useEffect(() => {\n        insights?.chrome?.appAction?.('no-permissions');\n    }, []);\n\n    return <Main>\n        <NotAuthorized serviceName={capitalize(intl.formatMessage(messages.malwareDetection))} />\n    </Main>;\n};\n\nexport default withRouter(NoPermissionsPage);\n","import { Banner } from '@patternfly/react-core/dist/esm/components/Banner/index';\nimport { GET_MALWARE_COUNT } from '../operations/queries';\nimport Loading from './Loading/Loading';\nimport NoPerms from '../Routes/NoPermissionsPage/NoPermissionsPage';\nimport PropTypes from 'prop-types';\nimport React from 'react';\nimport { hasMalware } from '../store/cache';\nimport messages from '../Messages';\nimport { useIntl } from 'react-intl';\nimport { usePermissions } from '@redhat-cloud-services/frontend-components-utilities/RBACHook';\nimport { useQuery } from '@apollo/client';\n\nexport function Permissions (props) {\n    const intl = useIntl();\n    const { data, loading } = useQuery(GET_MALWARE_COUNT);\n    const PERMS = {\n        access: ['malware-detection:*:*', 'malware-detection:*:read']\n    };\n    const permsAccess = usePermissions('malware-detection', PERMS.access);\n\n    !loading && hasMalware(Number(data?.ruleStats?.matchedCount) !== 0);\n\n    if (permsAccess?.isLoading) {\n        return <Loading />;\n    } else if (!permsAccess?.hasAccess) {\n        return <NoPerms />;\n    } else if (!permsAccess?.isLoading && permsAccess?.hasAccess) {\n        return <React.Fragment>\n            { !loading && hasMalware() && <Banner variant=\"danger\" className='ins-l-malwareBanner'>{intl.formatMessage(messages.weDetected)}</Banner>}\n            { props.children}\n        </React.Fragment>;\n    }\n}\n\nPermissions.propTypes = {\n    children: PropTypes.any\n};\n","/* eslint-disable react/display-name */\nimport React, { Suspense, lazy } from 'react';\nimport { Redirect, Route, Switch } from 'react-router-dom';\n\nimport { Permissions } from './Components/Permissions';\n\nconst SigRoutes = lazy(() => import(/* webpackChunkName: \"Signatures\" */ './Routes/Signatures/Routes'));\nconst SysRoutes = lazy(() => import(/* webpackChunkName: \"Systems\" */ './Routes/Systems/Routes'));\n\nconst paths = [\n    { title: 'Signatures', path: '/signatures:?', render: ()=><Permissions><SigRoutes /></Permissions> },\n    { title: 'Signatures', path: '/signatures', render: ()=><Permissions><SigRoutes /></Permissions> },\n    { title: 'Systems', path: '/systems:?', render: ()=><Permissions><SysRoutes /></Permissions> },\n    { title: 'Systems', path: '/systems', render: ()=><Permissions><SysRoutes /></Permissions> }\n];\n\nexport const Routes = () => (\n    <Suspense>\n        <Switch>\n            {paths.map((path) => (\n                <Route\n                    key={path.title}\n                    {...path}\n                />\n            ))}\n            <Redirect path=\"/signatures\" to={`${paths[1].path}`} push />\n            {/* Finally, catch all unmatched routes */}\n            <Redirect path=\"*\" to={`${paths[1].path}`} push />\n        </Switch>\n    </Suspense>\n);\n","import './App.scss';\n\nimport React, { useEffect, useMemo } from 'react';\nimport { useHistory, useLocation } from 'react-router-dom';\n\nimport { Routes } from './Routes';\n\nconst App = (props) => {\n    const { pathname } = useLocation();\n    const { push } = useHistory();\n    const appNavClick = useMemo(\n        () => ({\n            signatures(redirect) {\n                insights.chrome.appNavClick({ id: 'signatures', redirect });\n            },\n            systems(redirect) {\n                insights.chrome.appNavClick({ id: 'systems', redirect });\n            }\n        }),\n        []\n    );\n\n    useEffect(() => {\n        insights.chrome.init();\n        const baseComponentUrl = pathname.split('/')[4];\n        const unregister = insights.chrome.on('APP_NAVIGATION', (event) => {\n            if (event.domEvent) {\n                push(`/${event.navId}`);\n                appNavClick[baseComponentUrl] !== undefined\n                    ? appNavClick[baseComponentUrl](true)\n                    : appNavClick.signatures;\n            }\n        });\n\n        return () => unregister();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, []);\n\n    return  <Routes childProps={props} />;\n};\n\nexport default App;\n","import {\n    Tooltip,\n    TooltipPosition\n} from '@patternfly/react-core/dist/esm/components/Tooltip/';\n\nimport { Button } from '@patternfly/react-core/dist/esm/components/Button';\nimport OutlinedQuestionCircleIcon from '@patternfly/react-icons/dist/esm/icons/outlined-question-circle-icon';\nimport React from 'react';\nimport propTypes from 'prop-types';\n\nconst link = (desc, url = '#') => <Button isInline component='a' variant='link' href={url}>{desc}</Button>;\n\nconst gqlProps = {\n    data: propTypes.object,\n    loading: propTypes.bool,\n    error: propTypes.object\n};\n\nconst isBeta = () => window.location.pathname.split('/')[1] === 'beta' ? '/beta' : '';\n\n// Parse the match.metadata object and return a string of its 'key: value' items each on a separate line\nconst expandMatchMetadata = (md) => {\n    let output = `Source Type: ${md.source_type} ${md.md5sum || md.process_name ? '' : '(no additional metadata)'}`;\n    output += md.md5sum ? `\\nFile Type: ${md.file_type}\\nFile Mime Type: ${md.mime_type}\\nFile MD5Sum: ${md.md5sum}` : '';\n    output += md.line ? `\\nLine Number: ${md.line_number}\\nLine: ${decodeURIComponent(md.line)}` : '';\n    output += md.process_name ? `\\nProcess Name: ${md.process_name}` : '';\n    return output;\n};\n\nconst totalMatchesTitle = ({ tooltip, title }) => (<span>\n    {title}\n    <Tooltip\n        key={title}\n        position={TooltipPosition.right}\n        content={<div>{tooltip}</div>}\n    >\n        <span aria-label=\"Action\">\n            {` `}<OutlinedQuestionCircleIcon />\n        </span>\n    </Tooltip>\n</span>);\n\n// title case text string\nconst capitalize = (string) => string.replace(/\\w\\S*/g, (w) => (w.replace(/^\\w/, (c) => c.toUpperCase())));\n\nconst strong = (str) => <strong>{str}</strong>;\n\nexport { link, gqlProps, isBeta, totalMatchesTitle, expandMatchMetadata, capitalize, strong };\n","import {\n    EmptyState,\n    EmptyStateIcon,\n    Skeleton,\n    Title\n} from '@patternfly/react-core/dist/esm/components';\n\nimport React from 'react';\nimport propTypes from 'prop-types';\n\nconst Loading = ({ type }) => {\n    const Spinner = () => (\n        <span className=\"pf-c-spinner\" role=\"progressbar\" aria-valuetext=\"Loading...\">\n            <span className=\"pf-c-spinner__clipper\" />\n            <span className=\"pf-c-spinner__lead-ball\" />\n            <span className=\"pf-c-spinner__tail-ball\" />\n        </span>\n    );\n\n    switch (type) {\n        case 'table': return <div className='ins-l-common--BackgroundColor'>\n            <br />\n            <Skeleton width=\"75%\" screenreaderText=\"Loading contents\" />\n            {[...Array(9)].map((value, key) => <React.Fragment key={key}><br /><Skeleton width=\"75%\" /><br /></React.Fragment>)}\n        </div>;\n\n        default: return <EmptyState>\n            <EmptyStateIcon variant=\"container\" component={Spinner} />\n            <Title size=\"lg\" headingLevel=\"h4\">\n                Loading\n            </Title>\n        </EmptyState>;\n    }\n\n};\n\nLoading.propTypes = { type: propTypes.string };\n\nexport default Loading;\n","/* eslint-disable max-len */\nimport { defineMessages } from 'react-intl';\n\nexport default defineMessages({\n    malwareDetection: {\n        id: 'malwareDetection',\n        description: 'Title',\n        defaultMessage: 'Malware signatures'\n    },\n    malwareDetectionSignatures: {\n        id: 'malwareDetectionSignatures',\n        description: 'Title',\n        defaultMessage: 'Malware detection signatures'\n    },\n    sigName: {\n        id: 'sigNameId',\n        description: 'Sig table column title',\n        defaultMessage: 'Signature name'\n    },\n    sig: {\n        id: 'sig',\n        description: 'Signature',\n        defaultMessage: 'Signature'\n    },\n    systems: {\n        id: 'systems',\n        description: 'Sig table column title',\n        defaultMessage: 'Malware systems'\n    },\n    added: {\n        id: 'added',\n        description: 'Sig table column title',\n        defaultMessage: 'Added'\n    },\n    lastMatched: {\n        id: 'lastMatched',\n        description: 'Sig table column title',\n        defaultMessage: 'Last Matched'\n    },\n    matched: {\n        id: 'matched',\n        description: 'Sig table column title',\n        defaultMessage: 'Matched'\n    },\n    matchedSignatures: {\n        id: 'matchedSignatures',\n        description: 'Sig status card heading',\n        defaultMessage: 'Matched signatures'\n    },\n    enabledSignatures: {\n        id: 'enabledSignatures',\n        description: 'Sig status card heading',\n        defaultMessage: 'Enabled signatures'\n    },\n    disabledSignatures: {\n        id: 'disabledSignatures',\n        description: 'Sig status card heading',\n        defaultMessage: 'Disabled signatures'\n    },\n    analysisRunAcross: {\n        id: 'analysisRunAcross',\n        description: 'Chart card heading',\n        defaultMessage: '<strong>analyses</strong> run across <strong>{hosts, plural, one {# system} other {# systems}}</strong> with <strong>{matches, plural, one {# match} other {# matches}}</strong>'\n    },\n    noFound: {\n        id: 'noFound',\n        description: 'Sig status card heading',\n        defaultMessage: 'No active malware matches found'\n    },\n    noAnalysisRun: {\n        id: 'noAnalysisRun',\n        description: 'No host analyses run',\n        defaultMessage: 'No system analyses run'\n    },\n    hostsProtected: {\n        id: 'hostsProtected',\n        description: 'Sig status card sub heading',\n        defaultMessage: 'Your systems are protected.'\n    },\n    activeFound: {\n        id: 'activeFound',\n        description: 'Sig status card heading',\n        defaultMessage: 'Active malware matches found!'\n    },\n    hostsVulnerable: {\n        id: 'hostsVulnerable',\n        description: 'Sig status card sub heading',\n        defaultMessage: 'Your systems may be at risk.'\n    },\n    lastCheck: {\n        id: 'lastCheck',\n        description: 'Sig status card',\n        defaultMessage: 'Last check:'\n    },\n    lastSeen: {\n        id: 'lastSeen',\n        description: 'Last seen',\n        defaultMessage: 'Last seen'\n    },\n    uuid: {\n        id: 'uuid',\n        description: 'UUID',\n        defaultMessage: 'UUID'\n    },\n    description: {\n        id: 'description',\n        description: 'description',\n        defaultMessage: 'Description'\n    },\n    threatType: {\n        id: 'threatType',\n        description: 'Malware threat type',\n        defaultMessage: 'Threat type'\n    },\n    ruleCategory: {\n        id: 'ruleCategory',\n        description: 'Rule category',\n        defaultMessage: 'Rule category'\n    },\n    ruleIntendedUsage: {\n        id: 'ruleIntendedUsage',\n        description: 'Rule intended usage',\n        defaultMessage: 'Intended usage'\n    },\n    ruleReferences: {\n        id: 'ruleReferences',\n        description: 'Rule references',\n        defaultMessage: 'References'\n    },\n    ruleAuthorReference: {\n        id: 'ruleAuthorReference',\n        description: 'Rule author reference',\n        defaultMessage: 'Author reference'\n    },\n    ruleAuthorReferences: {\n        id: 'ruleAuthorReferences',\n        description: 'Rule author reference links',\n        defaultMessage: 'Author reference links'\n    },\n    ruleBackgroundReference: {\n        id: 'ruleBackgroundReference',\n        description: 'Rule background reference',\n        defaultMessage: 'Background reference'\n    },\n    ruleBackgroundReferences: {\n        id: 'ruleBackgroundReferences',\n        description: 'Rule background reference links',\n        defaultMessage: 'Background reference links'\n    },\n    dataNotAvailable: {\n        id: 'dataNotAvailable',\n        description: 'Data not available',\n        defaultMessage: 'Not available'\n    },\n    never: {\n        id: 'never',\n        description: 'never',\n        defaultMessage: 'Never'\n    },\n    malwareDetectionSigs: {\n        id: 'malwareDetectionSigs',\n        description: 'Malware detection signatures',\n        defaultMessage: 'Malware detection signatures'\n    },\n    malwareDetectionSys: {\n        id: 'malwareDetectionSys',\n        description: 'Malware detection systems',\n        defaultMessage: 'Malware detection systems'\n    },\n    affectedHosts: {\n        id: 'affectedHosts',\n        description: 'Affected hosts',\n        defaultMessage: 'Affected systems'\n    },\n    lastmatch: {\n        id: 'lastmatch',\n        description: 'Last match',\n        defaultMessage: 'Last match'\n    },\n    hostmatch: {\n        id: 'hostmatch',\n        description: 'Host match',\n        defaultMessage: 'System match'\n    },\n    matchedSystems: {\n        id: 'matchedSystems',\n        description: 'Number of matched systems',\n        defaultMessage: 'Matched systems'\n    },\n    status: {\n        id: 'status',\n        description: 'Status',\n        defaultMessage: 'Status'\n    },\n    author: {\n        id: 'author',\n        description: 'Author',\n        defaultMessage: 'Author'\n    },\n    enabled: {\n        id: 'enabled',\n        description: 'Enabled',\n        defaultMessage: 'Enabled'\n    },\n    enablement: {\n        id: 'enablement',\n        description: 'Enablement',\n        defaultMessage: 'Enablement'\n    },\n    disabled: {\n        id: 'disabled',\n        description: 'Disabled',\n        defaultMessage: 'Disabled'\n    },\n    noHostHas: {\n        id: 'noHostHas',\n        description: 'No host has been affected by this signature.',\n        defaultMessage: 'No system has been affected by this signature.'\n    },\n    signature: {\n        id: 'signature',\n        description: 'Signature',\n        defaultMessage: 'Signature'\n    },\n    filterBy: {\n        id: 'filterBy',\n        description: 'Filter by {what?}',\n        defaultMessage: 'Filter by {field}'\n    },\n    weDetected: {\n        id: 'weDetected',\n        description: 'Malware detected on your system. Contact your corporate information security team for more information.',\n        defaultMessage: 'Malware detected on your system. Contact your corporate information security team for more information.'\n    },\n    name: {\n        id: 'name',\n        description: 'Name',\n        defaultMessage: 'Name'\n    },\n    noMatches: {\n        id: 'noMatches',\n        description: 'No matches found',\n        defaultMessage: 'No matches found'\n    },\n    hostsNotAffected: {\n        id: 'hostsNotAffected',\n        description: 'Hosts are not affected by any signatures.',\n        defaultMessage: 'Systems are not affected by any signatures.'\n    },\n    noResults: {\n        id: 'noResults',\n        description: 'No results found',\n        defaultMessage: 'No results found'\n    },\n    noResultsMatch: {\n        id: 'noResultsMatch',\n        description: 'No results match this filter criteria. Remove all filters or clear all filters to show results.',\n        defaultMessage: 'No results match this filter criteria. Remove all filters or clear all filters to show results.'\n    },\n    all: {\n        id: 'all',\n        description: 'all',\n        defaultMessage: 'All'\n    },\n    notMatched: {\n        id: 'notMatched',\n        description: 'not matched',\n        defaultMessage: 'Not matched'\n    },\n    notMatchedBody: {\n        id: 'notMatchedBody',\n        description: 'This system is not matched by any malware signatures.',\n        defaultMessage: 'This system is not matched by any malware signatures.'\n    },\n    sigCompiled: {\n        id: 'sigCompiled',\n        description: 'Signature is compiled',\n        defaultMessage: 'Signature is compiled'\n    },\n    sigCompiledBody: {\n        id: 'sigCompiledBody',\n        description: 'We couldnt display',\n        defaultMessage: 'We couldn\\'t display this signature because it\\'s compiled.'\n    },\n    totalMatches: {\n        id: 'totalMatches',\n        description: 'Total matches',\n        defaultMessage: 'Total matches'\n    },\n    noAffectedHosts: {\n        id: 'noAffectedHosts',\n        description: 'No affected hosts',\n        defaultMessage: 'No affected systems'\n    },\n    noAffectedHostsBody: {\n        id: 'noAffectedHostsBody',\n        description: 'This signature doesn\\'t affect any hosts.',\n        defaultMessage: 'This signature doesn\\'t affect any systems.'\n    },\n    resetFilters: {\n        id: 'resetFilters',\n        description: 'Reset filters',\n        defaultMessage: 'Reset filters'\n    },\n    lastStatus: {\n        id: 'lastStatus',\n        description: 'Last status',\n        defaultMessage: 'Last status'\n    },\n    totalMatchesNote: {\n        id: 'totalMatchesNote',\n        description: 'Total number of matches found from every scan of a system within the last 14 days.',\n        defaultMessage: 'Total number of matches found from every scan of a system within the last 14 days.'\n    },\n    lastScan: {\n        id: 'lastScan',\n        description: 'Last scan',\n        defaultMessage: 'Last scan'\n    },\n    headerPopoverTitle: {\n        id: 'headerPopoverTitle',\n        description: 'Title for the information card in the header',\n        defaultMessage: 'About Malware Detection'\n    },\n    headerPopoverBody1: {\n        id: 'headerPopoverBody1',\n        description: 'Body for the information card in the header',\n        defaultMessage: `Expands the Red Hat Insights security offering by providing detection of potential malware in your RHEL infrastructure.`\n    },\n    headerPopoverFooter: {\n        id: 'headerPopoverFooter',\n        description: 'Footer for the information card in the header',\n        defaultMessage: 'Access installation guide'\n    },\n    emptyAccountTitle: {\n        id: 'emptyAccountTitle',\n        description: 'empty account card title',\n        defaultMessage: 'No connected systems yet'\n    },\n    emptyAccountCardBody: {\n        id: 'emptyAccountBody',\n        description: 'empty account card body',\n        defaultMessage: 'To get started, connect your systems with the installation guide.'\n    },\n    emptyAccountTableBody: {\n        id: 'emptyAccountBody',\n        description: 'empty account card body',\n        defaultMessage: 'This is only the preview state. To get started, follow the installation guide and connect your systems.'\n    },\n    emptyAccountButton: {\n        id: 'emptyAccountButton',\n        description: 'empty account card button',\n        defaultMessage: 'Access installation guide'\n    }\n});\n","import { gql, makeVar } from '@apollo/client';\n\nexport const test = makeVar(false);\n\nconst Signatures = {\n    RuleDetails: gql` fragment RuleDetails on Rule {\n      hasMatch\n      id\n      lastMatchDate\n      name\n      rawRule\n      metadata\n      isDisabled\n      hostCount\n    }`,\n    ExtraRuleDetails: gql` fragment ExtraRuleDetails on Rule {\n      affectedHosts {\n          totalCount\n        }\n}` };\n\nexport const GET_SIGNATURE_PAGE = gql`query QuerySigPage {\n  ruleStats {\n    matchedCount\n    enabledCount\n    disabledCount\n  }\n  hostScans(first: 1, orderBy: CREATED_AT_DESC) {\n    nodes {\n      createdAt\n    }\n    totalCount\n  }\n  hosts {\n    totalCount\n  }\n}`;\n\nexport const GET_SIGNATURE_TABLE = gql`query\nQuerySigPage($offset: Int = 0, $limit: Int = 10, $orderBy: [RulesOrderBy!], $ruleName: String, $condition: RuleCondition = {})  {\n  rulesList(offset: $offset, first: $limit, orderBy: $orderBy, ruleName: $ruleName, condition: $condition)  {\n      ...RuleDetails\n  }\n  rules(offset: $offset, first: $limit, orderBy: $orderBy, ruleName: $ruleName, condition: $condition) {\n    totalCount\n  }\n}${Signatures.RuleDetails}`;\n\nexport const GET_SIGNATURE_DETAILS_PAGE = gql`query QuerySigDetailsPage($ruleName: String)  {\n  rulesList(condition: {name: $ruleName})  {\n      ...RuleDetails\n      ...ExtraRuleDetails\n  }\n  hosts {\n    totalCount\n  }\n}${Signatures.RuleDetails}${Signatures.ExtraRuleDetails}`;\n\nexport const GET_MALWARE_COUNT = gql`query QuerySigPage {\n  ruleStats {\n    matchedCount\n  }\n}`;\n\nexport const GET_SIGNATURE_DETAILS_TABLE = gql`query QuerySigPage($offset: Int = 0, $limit: Int = 10, $orderBy: [HostWithMatchesOrderBy!],\n$ruleName: String, $displayName: String)  {\n  rulesList(condition: {name: $ruleName})  {\n    affectedHostsList (offset: $offset, first: $limit, orderBy: $orderBy, displayName: $displayName) {\n      displayName\n        lastScanDate\n        matchCount\n        matches {\n          stringOffset\n          stringIdentifier\n          stringData\n          source\n          scanDate\n          ruleScanId\n          ruleId\n          hostId\n          id\n          metadata\n      }\n      }\n      affectedHosts(offset: $offset, first: $limit, orderBy: $orderBy, displayName: $displayName) {\n        totalCount\n      }\n    }\n}`;\n\nexport const GET_SYSTEM_TABLE = gql`query\nQuerySysPage($offset: Int = 0, $limit: Int = 10, $orderBy: [HostsOrderBy!], $hostnameOrId: String, $tags: JSON)  {\n  hostsList(offset: $offset, first: $limit, orderBy: $orderBy, displayName: $hostnameOrId, hostTags: $tags)  {\n    id\n    displayName\n    hasMatch\n    lastScanDate\n    lastMatchDate\n    totalMatches\n    hostScans {\n      totalCount\n    }\n    updated\n    tags,\n    osVersion\n    }\n    hosts(offset: $offset, first: $limit, orderBy: $orderBy, displayName: $hostnameOrId, hostTags: $tags){\n    totalCount\n  }\n}`;\n\nexport const GET_SYSTEMS_DETAILS_PAGE = gql`query QuerySysDetailsPage($id: UUID)  {\n  hosts(condition: {id: $id})  {\n    nodes {\n      lastScanDate\n      displayName\n      id\n      lastMatchDate\n      totalMatches\n  }\n}\n}`;\n\nexport const GET_SYSTEMS_DETAILS_TABLE_PAGE = gql`query QuerySysDetailsPage(\n  $systemId: UUID!, $offset: Int = 0, $limit: Int = 10, $orderBy: [RuleWithMatchesOrderBy!], $ruleName: String) {\n  host(id: $systemId) {\n    id\n    updated\n    lastMatchDate\n    hasMatch\n    affectedRules(\n      first: $limit\n      offset: $offset\n      orderBy: $orderBy\n      ruleName: $ruleName\n    ) {\n      totalCount\n    }\n    affectedRulesList(\n      first: $limit\n      offset: $offset\n      orderBy: $orderBy\n      ruleName: $ruleName\n    ) {\n      matchCount\n      lastMatchDate\n      lastStatus\n      matches {\n        stringOffset\n        stringIdentifier\n        stringData\n        source\n        metadata\n        scanDate\n      }\n      name\n      metadata\n      rawRule\n    }\n  }\n}\n`;\n\nexport const GET_TIME_SERIES_STATS = gql`query QuerySysScanComponent {\n  timeSeriesStatsList {\n    day\n    hostScanCount\n  }\n}`;\n","import { InMemoryCache, makeVar } from '@apollo/client';\n// import { offsetLimitPagination } from '@apollo/client/utilities';\n\nexport const hasMalware = makeVar(false);\nexport const sigTableFilters = makeVar({});\nexport const sysTableFilters = makeVar({});\nexport const globalFilters  = makeVar({});\nexport const cache = new InMemoryCache({\n    typePolicies: {\n        Query: {\n            fields: {\n                // rulesList: { ...offsetLimitPagination(),\n                //     read(existing, { variables }) {\n\n                //         need to have the variables stored/updated as cache var, then we can compare exisitng to what we see in the read\n\n                //         console.error(existing, variables);\n                //         if (!existing) {return;} //We have no data at all\n\n                //         if (existing.length < (variables.offset + variables.limit)) {return;} //We don't have enough data\n\n                //         const sliced = existing.slice(variables.offset, variables.offset + variables.limit);\n\n                //         if (sliced.includes(undefined)) {return;} //Some of our data is null\n\n                //         return sliced;\n                //     }\n                // }\n            }\n        }\n    }\n});\n","import { createContext } from 'react';\nimport { ReducerRegistry, applyReducerHash } from '@redhat-cloud-services/frontend-components-utilities/ReducerRegistry';\nimport promiseMiddleware from 'redux-promise-middleware';\n\nexport const RegistryContext = createContext({\n    getRegistry: () => {}\n});\n\nexport function init (...middleware) {\n    return new ReducerRegistry(\n        {},\n        [\n            promiseMiddleware,\n            ...middleware\n        ]\n    );\n}\n\nconst selectRows = (rows, selected) =>\n    rows.map((row) => ({\n        ...row,\n        selected: selected.includes(row.id)\n    }));\n\nexport const entitiesReducer = () =>\n    applyReducerHash({\n        ['INVENTORY_INIT']: () => ({\n            rows: [],\n            total: 0\n        }),\n        ['RESET_PAGE']: (state) => ({\n            ...state,\n            page: 1\n        }),\n        ['SELECT_ENTITIES']: (state, { payload: { selected } }) => ({\n            ...state,\n            rows: selectRows(state.rows || [], selected)\n        })\n    });\n"],"names":["module","exports","withRouter","intl","useIntl","useEffect","insights","chrome","appAction","Main","NotAuthorized","serviceName","capitalize","formatMessage","messages","Permissions","props","useQuery","GET_MALWARE_COUNT","data","loading","permsAccess","usePermissions","hasMalware","Number","ruleStats","matchedCount","isLoading","Loading","hasAccess","Banner","variant","className","children","propTypes","PropTypes","SigRoutes","lazy","SysRoutes","paths","title","path","render","Routes","Suspense","Switch","map","Route","key","Redirect","to","push","pathname","useLocation","useHistory","appNavClick","useMemo","signatures","redirect","id","systems","init","baseComponentUrl","split","unregister","on","event","domEvent","navId","undefined","childProps","gqlProps","error","isBeta","window","location","expandMatchMetadata","md","output","source_type","md5sum","process_name","file_type","mime_type","line","line_number","decodeURIComponent","totalMatchesTitle","tooltip","position","TooltipPosition","content","string","replace","w","c","toUpperCase","strong","str","type","width","screenreaderText","Array","value","component","role","size","headingLevel","defineMessages","malwareDetection","description","defaultMessage","malwareDetectionSignatures","sigName","sig","added","lastMatched","matched","matchedSignatures","enabledSignatures","disabledSignatures","analysisRunAcross","noFound","noAnalysisRun","hostsProtected","activeFound","hostsVulnerable","lastCheck","lastSeen","uuid","threatType","ruleCategory","ruleIntendedUsage","ruleReferences","ruleAuthorReference","ruleAuthorReferences","ruleBackgroundReference","ruleBackgroundReferences","dataNotAvailable","never","malwareDetectionSigs","malwareDetectionSys","affectedHosts","lastmatch","hostmatch","matchedSystems","status","author","enabled","enablement","disabled","noHostHas","signature","filterBy","weDetected","name","noMatches","hostsNotAffected","noResults","noResultsMatch","all","notMatched","notMatchedBody","sigCompiled","sigCompiledBody","totalMatches","noAffectedHosts","noAffectedHostsBody","resetFilters","lastStatus","totalMatchesNote","lastScan","headerPopoverTitle","headerPopoverBody1","headerPopoverFooter","emptyAccountTitle","emptyAccountCardBody","emptyAccountTableBody","emptyAccountButton","Signatures","makeVar","RuleDetails","gql","ExtraRuleDetails","GET_SIGNATURE_PAGE","GET_SIGNATURE_TABLE","GET_SIGNATURE_DETAILS_PAGE","GET_SIGNATURE_DETAILS_TABLE","GET_SYSTEM_TABLE","GET_SYSTEMS_DETAILS_PAGE","GET_SYSTEMS_DETAILS_TABLE_PAGE","GET_TIME_SERIES_STATS","sigTableFilters","globalFilters","cache","InMemoryCache","typePolicies","Query","fields","RegistryContext","createContext","getRegistry","middleware","ReducerRegistry","promiseMiddleware","selectRows","rows","selected","row","includes","entitiesReducer","applyReducerHash","total","state","page","payload"],"sourceRoot":""}