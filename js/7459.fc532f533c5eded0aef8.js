(self.webpackChunkmalware=self.webpackChunkmalware||[]).push([[7459,5467],{58776:(e,t,s)=>{"use strict";s.d(t,{Z:()=>C});var a=s(28416),i=s.n(a),r=s(51663),n=s(51364),o=s(83920),l=s(99087),d=s(38704),u=s(33203),c=s(2550),g=s(86896),m=s(55140);const f=()=>{const e=(0,g.Z)(),t=(0,m.Z)();return(0,a.useEffect)((()=>{t.appAction("no-permissions")}),[]),i().createElement(l.ZP,null,i().createElement(d.Z,{serviceName:(0,u.kC)(e.formatMessage(c.Z.malwareDetection))}))};var p=s(45697),h=s.n(p),y=s(21593),M=s(43707),b=s(71641);function S(e){const{data:t,loading:s}=(0,b.a)(n.hO),a=(0,M.TE)("malware-detection",["malware-detection:*:*","malware-detection:*:read"]);return!s&&(0,y.xM)(0!==Number(t?.ruleStats?.matchedCount)),a?.isLoading?i().createElement(o.Z,null):a?.hasAccess?!a?.isLoading&&a?.hasAccess?i().createElement(i().Fragment,null,e.children):void 0:i().createElement(f,null)}S.propTypes={children:h().any};var w=s(71257),$=s(22663),N=s(46639);const A=(0,a.lazy)((()=>Promise.all([s.e(8956),s.e(9480),s.e(3996),s.e(633)]).then(s.bind(s,98766)))),E=(0,a.lazy)((()=>Promise.all([s.e(1088),s.e(8257),s.e(7607),s.e(5573),s.e(5902),s.e(7745),s.e(2556),s.e(2902),s.e(1548),s.e(8956),s.e(2304),s.e(2178),s.e(3993),s.e(8099),s.e(9480),s.e(9982)]).then(s.bind(s,84800)))),R=(0,a.lazy)((()=>Promise.all([s.e(8956),s.e(2178),s.e(3996),s.e(9695)]).then(s.bind(s,19370)))),D=(0,a.lazy)((()=>Promise.all([s.e(1088),s.e(8257),s.e(7607),s.e(5573),s.e(5902),s.e(2556),s.e(1548),s.e(8956),s.e(2304),s.e(3993),s.e(4919),s.e(4322)]).then(s.bind(s,27112)))),B=()=>{const[e,t]=(0,a.useState)(!0);(0,a.useEffect)((()=>{try{w.Z.get("/api/inventory/v1/hosts?filter[system_profile][operating_system][RHEL][version][gte]=0&page=1&per_page=1").then((({data:e})=>{t(e.total>0)}))}catch(e){console.error(e)}}),[e]);let s=(0,r.useRoutes)([{path:"/*",element:i().createElement(S,null,i().createElement(A,null))},{path:"/signatures/:id",element:i().createElement(S,null,i().createElement(E,null))},{path:"/systems",element:i().createElement(S,null,i().createElement(R,null))},{path:"/systems/:id",element:i().createElement(S,null,i().createElement(D,null))}]);return i().createElement($.Z,{appId:"malware_zero_state",appName:"dashboard",module:"./AppZeroState",scope:"dashboard",ErrorComponent:i().createElement(N.Z,null),app:"Malware",customFetchResults:e},s)},C=e=>i().createElement(B,{childProps:e})},33203:(e,t,s)=>{"use strict";s.d(t,{R$:()=>g,Wi:()=>f,aQ:()=>M,eb:()=>S,fK:()=>y,hN:()=>m,ie:()=>b,kC:()=>h,lH:()=>p});var a=s(75824),i=s(44006),r=s.n(i),n=s(28416),o=s.n(n),l=s(45697),d=s.n(l),u=s(85056),c=s.n(u);const g={data:d().object,loading:d().bool,error:d().object},m=()=>"preview"===window.location.pathname.split("/")[1]?"/preview":"",f=e=>{let t=`Source Type: ${e.source_type} ${e.md5sum||e.process_name?"":"(no additional metadata)"}`;return t+=e.md5sum?`\nFile Type: ${e.file_type}\nFile Mime Type: ${e.mime_type}\nFile MD5Sum: ${e.md5sum}`:"",t+=e.line?`\nLine Number: ${e.line_number}\nLine: ${decodeURIComponent(e.line)}`:"",t+=e.process_name?`\nProcess Name: ${e.process_name}`:"",t},p=({tooltip:e,title:t})=>o().createElement("span",{style:{whiteSpace:"nowrap"}},t,o().createElement(a.u,{key:t,position:a.D.right,content:o().createElement("div",null,e)},o().createElement("span",{"aria-label":"Action"}," ",o().createElement(r(),{color:"var(--pf-global--secondary-color--100)"})))),h=e=>e.replace(/\w\S*/g,(e=>e.replace(/^\w/,(e=>e.toUpperCase())))),y=e=>o().createElement("strong",null,e),M={read:["malware-detection:*:read"],write:["malware-detection:*:*"]},b="https://access.redhat.com/documentation/en-us/red_hat_insights/2023/html/assessing_and_reporting_malware_signatures_on_rhel_systems/index",S=({children:e})=>o().createElement("a",{href:b,target:"__blank",rel:"noopener noreferrer"},e," ",o().createElement(c(),null))},83920:(e,t,s)=>{"use strict";s.d(t,{Z:()=>d});var a=s(9947),i=s(67880),r=s(38424),n=s(37619),o=s(28416),l=s.n(o);const d=()=>l().createElement(a.u,null,l().createElement(i.t,{titleText:"Loading",headingLevel:"h4",icon:l().createElement(r.k,{icon:n.$})}))},2550:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});const a=(0,s(50049).vU)({malwareDetection:{id:"malwareDetection",description:"Title",defaultMessage:"Malware detection"},signatures:{id:"signatures",description:"Signature page title",defaultMessage:"Signatures"},malwareDetectionSignatures:{id:"malwareDetectionSignatures",description:"Title",defaultMessage:"Malware detection signatures"},sigName:{id:"sigNameId",description:"Sig table column title",defaultMessage:"Signature name"},sig:{id:"sig",description:"Signature",defaultMessage:"Signature"},systems:{id:"systems",description:"Sig table column title",defaultMessage:"Systems"},added:{id:"added",description:"Sig table column title",defaultMessage:"Added"},lastMatched:{id:"lastMatched",description:"Sig table column title",defaultMessage:"Last matched"},matched:{id:"matched",description:"matched",defaultMessage:"Matched"},matchedSignaturesCount:{id:"matchedSignaturesCount",description:"Sig status card heading",defaultMessage:"Matched {matchedCount, plural, one {signature} other {signatures}}"},enabledSignaturesCount:{id:"enabledSignaturesCount",description:"Sig status card heading",defaultMessage:"Enabled {enabledCount, plural, one {signature} other {signatures}}"},disabledSignaturesCount:{id:"disabledSignaturesCount",description:"Sig status card heading",defaultMessage:"Disabled {disabledCount, plural, one {signature} other {signatures}}"},enabledSignaturesFilter:{id:"enabledSignaturesFilter",description:"Enabled signatures filter option",defaultMessage:"Enabled signatures"},disabledSignaturesFilter:{id:"disabledSignaturesFilter",description:"Disabled signatures filter option",defaultMessage:"Disabled signatures"},signaturesIncludedFilter:{id:"signaturesIncludedFilter",description:"Signatures included filter",defaultMessage:"Signatures included in malware analysis"},allSignatures:{id:"allSignatures",description:"All signatures filter option",defaultMessage:"All signatures"},signaturesEnabled:{id:"signaturesEnabled",description:"Signatures enabled filter option",defaultMessage:"Signatures enabled"},signaturesDisabled:{id:"signaturesDisabled",description:"Signatures disabled filter option",defaultMessage:"Signatures disabled"},disableSignatureFromAnalysis:{id:"disableSignatureFromAnalysis",description:"Disable signature from malware analysis",defaultMessage:"Disable signature from malware analysis"},enableSignatureForAnalysis:{id:"enableSignatureForAnalysis",description:"Enable signature for malware analysis",defaultMessage:"Enable signature for malware analysis"},disableSignaturesFromAnalysis:{id:"disableSignaturesFromAnalysis",description:"Disable signatures from malware analysis",defaultMessage:"Disable signatures from malware analysis"},enableSignaturesForAnalysis:{id:"enableSignaturesForAnalysis",description:"Enable signatures for malware analysis",defaultMessage:"Enable signatures for malware analysis"},disablingSignature:{id:"disablingSignature",description:"Disabling signature loading message",defaultMessage:"Disabling signature from malware analysis ..."},enablingSignature:{id:"enablingSignature",description:"Enabling signature loading message",defaultMessage:"Enabling signature for malware analysis ..."},actions:{id:"actions",description:"Enable Disable signature dropdown title",defaultMessage:"Actions"},analysisRunAcross:{id:"analysisRunAcross",description:"Chart card heading",defaultMessage:"<strong>analyses</strong> run across <strong>{hosts, plural, one {# system} other {# systems}}</strong> with <strong>{matches, plural, one {# match} other {# matches}}</strong>"},noFound:{id:"noFound",description:"Sig status card heading",defaultMessage:"No active malware matches found"},noAnalysisRun:{id:"noAnalysisRun",description:"No host analyses run",defaultMessage:"No system analyses run"},hostsProtected:{id:"hostsProtected",description:"Sig status card sub heading",defaultMessage:"Your systems are protected."},activeFound:{id:"activeFound",description:"Sig status card heading",defaultMessage:"Active malware matches found!"},hostsVulnerable:{id:"hostsVulnerable",description:"Sig status card sub heading",defaultMessage:"Your systems may be at risk."},lastCheck:{id:"lastCheck",description:"Sig status card",defaultMessage:"Last check:"},lastSeen:{id:"lastSeen",description:"Last seen",defaultMessage:"Last seen"},uuid:{id:"uuid",description:"UUID",defaultMessage:"UUID"},description:{id:"description",description:"description",defaultMessage:"Description"},threatType:{id:"threatType",description:"Malware threat type",defaultMessage:"Threat type"},ruleCategory:{id:"ruleCategory",description:"Rule category",defaultMessage:"Rule category"},ruleIntendedUsage:{id:"ruleIntendedUsage",description:"Rule intended usage",defaultMessage:"Intended usage"},ruleReferences:{id:"ruleReferences",description:"Rule references",defaultMessage:"References"},ruleAuthorReference:{id:"ruleAuthorReference",description:"Rule author reference",defaultMessage:"Author reference"},ruleAuthorReferences:{id:"ruleAuthorReferences",description:"Rule author reference links",defaultMessage:"Author reference links"},ruleBackgroundReference:{id:"ruleBackgroundReference",description:"Rule background reference",defaultMessage:"Background reference"},ruleBackgroundReferences:{id:"ruleBackgroundReferences",description:"Rule background reference links",defaultMessage:"Background reference links"},dataNotAvailable:{id:"dataNotAvailable",description:"Data not available",defaultMessage:"Not available"},notApplicable:{id:"notApplicable",description:"Not applicable",defaultMessage:"N/A"},never:{id:"never",description:"never",defaultMessage:"Never"},malwareDetectionSigs:{id:"malwareDetectionSigs",description:"Malware detection signatures",defaultMessage:"Malware detection signatures"},malwareDetectionSys:{id:"malwareDetectionSys",description:"Malware detection systems",defaultMessage:"Malware detection systems"},affectedHosts:{id:"affectedHosts",description:"Affected hosts",defaultMessage:"Affected systems"},lastmatch:{id:"lastmatch",description:"Last match",defaultMessage:"Last match"},hostmatch:{id:"hostmatch",description:"Host match",defaultMessage:"System match"},matchedSystems:{id:"matchedSystems",description:"Number of matched systems",defaultMessage:"Matched systems"},status:{id:"status",description:"Status",defaultMessage:"Status"},author:{id:"author",description:"Author",defaultMessage:"Author"},enabled:{id:"enabled",description:"Enabled",defaultMessage:"Enabled"},enablement:{id:"enablement",description:"Enablement",defaultMessage:"Enablement"},disabled:{id:"disabled",description:"Disabled",defaultMessage:"Disabled"},noHostHas:{id:"noHostHas",description:"No host has been affected by this signature.",defaultMessage:"No system has been affected by this signature."},signature:{id:"signature",description:"Signature",defaultMessage:"Signature"},filterBy:{id:"filterBy",description:"Filter by {what?}",defaultMessage:"Filter by {field}"},weDetected:{id:"weDetected",description:"Malware detected on one or more systems",defaultMessage:"Malware detected on one or more systems. Further analysis and investigation is recommended, including contacting your information security team."},systemsListIsDifferent:{id:"systemsListIsDifferent",description:"Systems list is different to Inventory",defaultMessage:"The list of systems in this view is different than those that appear in the Inventory. Only systems currently enabled for malware detection are displayed."},name:{id:"name",description:"Name",defaultMessage:"Name"},noMatches:{id:"noMatches",description:"No matches found",defaultMessage:"No matches found"},hostsNotAffected:{id:"hostsNotAffected",description:"Hosts are not affected by any signatures.",defaultMessage:"Systems are not affected by any signatures."},noResults:{id:"noResults",description:"No results found",defaultMessage:"No results found"},noResultsMatch:{id:"noResultsMatch",description:"No results match this filter criteria. Remove all filters or clear all filters to show results.",defaultMessage:"No results match this filter criteria. Remove all filters or clear all filters to show results."},all:{id:"all",description:"all",defaultMessage:"All"},notMatched:{id:"notMatched",description:"not matched",defaultMessage:"Not matched"},notMatchedBody:{id:"notMatchedBody",description:"This system is not matched by any malware signatures.",defaultMessage:"This system is not matched by any malware signatures."},sigCompiled:{id:"sigCompiled",description:"Signature is compiled",defaultMessage:"Signature is compiled"},sigCompiledBody:{id:"sigCompiledBody",description:"We couldnt display",defaultMessage:"We couldn't display this signature because it's compiled."},totalMatches:{id:"totalMatches",description:"Total matches",defaultMessage:"Total matches"},noAffectedHosts:{id:"noAffectedHosts",description:"No affected hosts",defaultMessage:"No affected systems"},noAffectedHostsBody:{id:"noAffectedHostsBody",description:"This signature doesn't affect any hosts.",defaultMessage:"This signature doesn't affect any systems."},disabledFromAnalysis:{id:"disabledFromAnalysis",description:"Disabled from malware analysis",defaultMessage:"Disabled from malware analysis"},disabledFromAnalysisBody:{id:"disabledFromAnalysisBody",description:"Disabled from malware analysis body",defaultMessage:"This signature has been disabled from malware analysis by user {disabledBy} on {disabledAt}.  It is not being evaluated for potential malware by Red Hat Insights."},resumeMalwareAnalysis:{id:"resumeMalwareAnalysis",description:"Resume malware analysis button message",defaultMessage:"Resume malware analysis"},resumingMalwareAnalysis:{id:"resumingMalwareAnalysis",description:"Resuming malware analysis button message",defaultMessage:"Resuming malware analysis ..."},resetFilters:{id:"resetFilters",description:"Reset filters",defaultMessage:"Reset filters"},lastStatus:{id:"lastStatus",description:"Last status",defaultMessage:"Last status"},totalMatchesNote:{id:"totalMatchesNote",description:"This is the total number of matches found on every scan of a system. If a signature is found multiple times over a period of time, it is reported each time.",defaultMessage:"This is the total number of matches found on every scan of a system. If a signature is found multiple times over a period of time, it is reported each time."},lastScan:{id:"lastScan",description:"Last scan",defaultMessage:"Last scan"},headerPopoverTitle:{id:"headerPopoverTitle",description:"Title for the information card in the header",defaultMessage:"About Malware Detection"},headerPopoverBody1:{id:"headerPopoverBody1",description:"Body for the information card in the header",defaultMessage:"Expands the Red Hat Insights security offering by providing detection of potential malware in your RHEL infrastructure."},headerPopoverFooter:{id:"headerPopoverFooter",description:"Footer for the information card in the header",defaultMessage:"Access installation guide"},emptyAccountTitle:{id:"emptyAccountTitle",description:"empty account card title",defaultMessage:"No systems have uploaded a malware scan report."},emptyAccountCardBody:{id:"emptyAccountCardBody",description:"empty account card body",defaultMessage:"To get started, connect your systems with the installation guide."},emptyAccountTableBody:{id:"emptyAccountTableBody",description:"empty account card body",defaultMessage:"This is only the preview state. To get started, follow the installation guide and connect your systems."},emptyAccountButton:{id:"emptyAccountButton",description:"empty account card button",defaultMessage:"Access installation guide"},learnMore:{id:"learnMore",description:"Learn more link to malware documentation",defaultMessage:"Learn more"},error:{id:"error",description:"Error",defaultMessage:"Error"},group:{id:"group",description:"Group column name",defaultMessage:"Group"},os:{id:"os",description:"OS column name",defaultMessage:"OS"},noGroups:{id:"noGroups",description:"No groups to filter",defaultMessage:"No groups to filter"}})},51364:(e,t,s)=>{"use strict";s.d(t,{Fl:()=>g,I8:()=>c,Qp:()=>o,W0:()=>p,c3:()=>d,c5:()=>m,hO:()=>u,kK:()=>f,tE:()=>l,vC:()=>h});var a=s(66438),i=s(76058);(0,a.QS)(!1);const r=i.Ps` fragment RuleDetails on Rule {
      hasMatch
      id
      lastMatchDate
      name
      rawRule
      metadata
      isDisabled
      hostCount
    }`,n=i.Ps` fragment ExtraRuleDetails on Rule {
      disabledBy
      disabledAt
      affectedHosts {
          totalCount
        }
}`,o=i.Ps`query QuerySigPage {
  ruleStats {
    matchedCount
    enabledCount
    disabledCount
  }
  hostScans(first: 1, orderBy: CREATED_AT_DESC) {
    nodes {
      createdAt
    }
    totalCount
  }
  hosts {
    totalCount
  }
}`,l=i.Ps`query
QuerySigPage($offset: Int = 0, $limit: Int = 10, $orderBy: [RulesOrderBy!], $ruleName: String, $condition: RuleCondition = {})  {
  rulesList(offset: $offset, first: $limit, orderBy: $orderBy, ruleName: $ruleName, condition: $condition)  {
      ...RuleDetails
  }
  rules(offset: $offset, first: $limit, orderBy: $orderBy, ruleName: $ruleName, condition: $condition) {
    totalCount
  }
}${r}`,d=i.Ps`query QuerySigDetailsPage($ruleName: String)  {
  rulesList(condition: {name: $ruleName})  {
      ...RuleDetails
      ...ExtraRuleDetails
  }
  hosts {
    totalCount
  }
}${r}${n}`,u=i.Ps`query QuerySigPage {
  ruleStats {
    matchedCount
  }
}`,c=i.Ps`query QuerySigPage($offset: Int = 0, $limit: Int = 10,
  $orderBy: [HostWithMatchesOrderBy!], $ruleName: String, $displayName: String, $hostGroupFilter: [String]) {
  rulesList(ruleName: $ruleName) {
    affectedHostsList(
      offset: $offset
      first: $limit
      orderBy: $orderBy
      displayName: $displayName
      groupName: $hostGroupFilter
    ) {
      id
      displayName
      groups
      osVersion
      lastScanDate
      matchCount
      matches {
        stringOffset
        stringIdentifier
        stringData
        source
        scanDate
        ruleScanId
        ruleId
        hostId
        id
        metadata
      }
    }
    affectedHosts(
      offset: $offset
      first: $limit
      orderBy: $orderBy
      displayName: $displayName
      groupName: $hostGroupFilter
    ) {
      totalCount
    }
  }
}`,g=i.Ps`query QuerySigPageGroups($ruleName: String)  {
  rulesList(ruleName: $ruleName)  {
    affectedHostsList (orderBy: GROUP_NAME_ASC){
      groups
    }
  }
}`,m=i.Ps`
query QuerySysPage($offset: Int = 0, $limit: Int = 10, $orderBy: [HostsOrderBy!], $hostnameOrId: String, $tags: JSON,
  $hasMatch: Boolean, $hostGroupFilter: [String], $osFilter: [String]) {
  hostsList(
    offset: $offset
    first: $limit
    orderBy: $orderBy
    displayName: $hostnameOrId
    hostTags: $tags
    condition: {hasMatch: $hasMatch}
    groupName: $hostGroupFilter
    osVersion: $osFilter
  ) {
    id
    displayName
    hasMatch
    lastScanDate
    lastMatchDate
    totalMatches
    hostScans {
      totalCount
    }
    updated
    tags
    groups
    osVersion
  }
  hosts(
    offset: $offset
    first: $limit
    orderBy: $orderBy
    displayName: $hostnameOrId
    hostTags: $tags
    condition: {hasMatch: $hasMatch}
    groupName: $hostGroupFilter
    osVersion: $osFilter
  ) {
    totalCount
  }
}`,f=i.Ps`query QuerySysDetailsPage($id: UUID)  {
  hosts(condition: {id: $id})  {
    nodes {
      lastScanDate
      displayName
      id
      lastMatchDate
      totalMatches
  }
}
}`,p=i.Ps`query QuerySysDetailsPage(
  $systemId: UUID!, $offset: Int = 0, $limit: Int = 10, $orderBy: [RuleWithMatchesOrderBy!], $ruleName: String) {
  host(id: $systemId) {
    id
    updated
    lastMatchDate
    hasMatch
    affectedRules(
      first: $limit
      offset: $offset
      orderBy: $orderBy
      ruleName: $ruleName
    ) {
      totalCount
    }
    affectedRulesList(
      first: $limit
      offset: $offset
      orderBy: $orderBy
      ruleName: $ruleName
    ) {
      matchCount
      lastMatchDate
      lastStatus
      matches {
        stringOffset
        stringIdentifier
        stringData
        source
        metadata
        scanDate
      }
      name
      metadata
      rawRule
    }
  }
}
`,h=i.Ps`query QuerySysScanComponent {
  timeSeriesStatsList {
    day
    hostScanCount
  }
}`},21593:(e,t,s)=>{"use strict";s.d(t,{Fs:()=>l,Rm:()=>o,gG:()=>n,xM:()=>r});var a=s(66438),i=s(93331);const r=(0,a.QS)(!1),n=(0,a.QS)({}),o=((0,a.QS)({}),(0,a.QS)({})),l=new i.h({typePolicies:{Query:{fields:{}}}})},92223:(e,t,s)=>{"use strict";s.d(t,{S1:()=>l,gE:()=>o,zw:()=>u});var a=s(28416),i=s(28385),r=s(39603),n=s.n(r);const o=(0,a.createContext)({getRegistry:()=>{}});function l(...e){return new i.xI({},[n(),...e])}const d=(e,t)=>e.map((e=>({...e,selected:t.includes(e.id)}))),u=()=>(0,i.Gg)({INVENTORY_INIT:()=>({rows:[],total:0}),RESET_PAGE:e=>({...e,page:1}),SELECT_ENTITIES:(e,{payload:{selected:t}})=>({...e,rows:d(e.rows||[],t)})})},45467:()=>{},11452:()=>{},34946:()=>{},10108:()=>{},81320:()=>{},88361:()=>{},66822:()=>{},314:()=>{},49854:()=>{},53519:()=>{},83130:e=>{"use strict";e.exports={en:{}}}}]);
//# sourceMappingURL=../sourcemaps/7459.a0aa7cbcfad7fe717b4028d84b9bb5c0.js.map