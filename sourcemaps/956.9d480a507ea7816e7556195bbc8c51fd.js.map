{"version":3,"file":"js/956.1690393641698.aeb84ae452c6a440c138.js","mappings":"w9BAmBA,IAAMA,EAAW,SAAC,GAAqC,IAAnCC,EAAmC,EAAnCA,UAAWC,EAAwB,EAAxBA,kBACrBC,GAAOC,EAAAA,EAAAA,UACPC,EAAWJ,GAAYK,EAAAA,EAAAA,IAAKC,MAAUD,EAAAA,EAAAA,MACtCE,GAAoBJ,EAAAA,EAAAA,UACpBK,GAAcL,EAAAA,EAAAA,UACdM,GAASC,EAAAA,EAAAA,KAETC,GAAmBC,EAAAA,EAAAA,IAAW,SAACC,EAAD,yBAAqB,CACrDC,QAAS,EAAF,aADyB,EAAMA,UAG9B,UAAAZ,EAAKa,eAAL,eAAcC,SAAU,CAAE,0BAAoBd,EAAKa,YACnD,UAAAR,EAAkBQ,eAAlB,mBAA2BE,WAA3B,eAAgCC,aAAc,CAAE,uBAAuB,KACvE,UAAAX,EAAkBQ,QAAQ,sCAA1B,eAA0DG,aAAc,CAAE,2BAA2B,KACrG,UAAAX,EAAkBQ,QAAQ,wBAA1B,eAA4CG,aAAc,CAAE,yBAAyB,KACrF,UAAAV,EAAYO,eAAZ,eAAqBC,SAAU,CAAE,8BAAwBR,EAAYO,eAG3EI,GAASC,EAAAA,EAAAA,UAAQ,kBAAO,IAAIC,EAAAA,EAAa,CAC3CC,KAAMX,EAAiBY,QAAOC,EAAAA,EAAAA,GAAe,CACzCC,IAAK,uCAETC,MAAAA,EAAAA,GACAzB,kBAAAA,GAL0B,UAMxBC,EAAKa,YAAY,CAACd,EAAmBU,IAwB3C,OAvBAP,EAASuB,SAAS,CAAEC,cAAAA,EAAAA,iBAEpBC,EAAAA,EAAAA,YAAU,WACNpB,EAAOJ,OACPI,EAAOqB,YAAY,WACfrB,EAAOsB,mBACPtB,EAAOuB,GAAG,wBAAwB,YAAc,MAAXC,EAAW,EAAXA,KACjC,GACA,UAAAxB,EAAOyB,uBAAP,oBAAAzB,EAAyBwB,GAAM,GAAO,KAAS,GAD/C,eAAOE,EAAP,KAAkBC,EAAlB,KAAuBC,EAAvB,KAEAnC,EAAKa,SAAWsB,MAAAA,OAAA,EAAAA,EAAcC,KAAK,OAAQ,GAE3C/B,EAAkBQ,QAAUoB,GAAa,GACzC3B,EAAYO,QAAUqB,GAAO,IAE7BG,EAAAA,EAAAA,IAAc,CAAEJ,UAAAA,EAAWC,IAAAA,EAAKC,aAAAA,IAEhClB,EAAOqB,kBAKhB,CAACrB,IAEG,kBAAC,KAAD,CAAcsB,OAAQC,UAAUC,SAASC,MAAM,EAAG,GAAIC,SAAUA,EAAUC,QAASC,QAAQC,KAC9F,kBAAC,IAAD,CAAgB7B,OAAQA,GACpB,kBAAC,cAAD,CAA0B8B,MAAO,CAAEC,YAAa,kBAAM9C,KAClD,kBAAC,EAAA+C,SAAD,CAAUC,MAAOhD,EAASiD,YACtB,kBAAC,gBAAD,CAAQC,UAAUC,EAAAA,EAAAA,aAAYC,OAAOC,SAASC,WAC1C,kBAAC,EAAAC,oBAAD,MACA,kBAAC,IAAD,YAQxB5D,EAAS6D,UAAY,CACjB5D,UAAW6D,IAAAA,KACX5D,kBAAmB4D,IAAAA,MAGvB9D,EAAS+D,aAAe,CACpB9D,WAAW,EACXC,mBAAmB,GAGvB","sources":["webpack:///./src/AppEntry.js"],"sourcesContent":["/* eslint-disable no-console */\nimport { ApolloClient, ApolloProvider, createHttpLink } from '@apollo/client';\nimport { NotificationsPortal, notifications } from '@redhat-cloud-services/frontend-components-notifications/';\nimport React, { useEffect, useMemo, useRef } from 'react';\n\nimport App from './App';\nimport { IntlProvider } from '@redhat-cloud-services/frontend-components-translations';\nimport PropTypes from 'prop-types';\nimport { Provider } from 'react-redux';\nimport { BrowserRouter as Router } from 'react-router-dom';\nimport { cache } from './store/cache';\nimport { getBaseName } from '@redhat-cloud-services/frontend-components-utilities/helpers/helpers';\nimport { init, RegistryContext } from './store';\nimport { globalFilters } from './store/cache';\nimport logger from 'redux-logger';\nimport messages from '../locales/data.json';\nimport { setContext } from '@apollo/client/link/context';\nimport { useChrome } from '@redhat-cloud-services/frontend-components/useChrome';\n\nconst AppEntry = ({ useLogger, connectToDevTools }) => {\n    const tags = useRef();\n    const registry = useLogger ? init(logger) : init();\n    const selectedWorkloads = useRef();\n    const selectedSID = useRef();\n    const chrome = useChrome();\n\n    const globalFilterLink = setContext((_, { headers }) => ({\n        headers: {\n            ...headers,\n            ...(tags.current?.length && { 'insights-tags': `${tags.current}` }),\n            ...(selectedWorkloads.current?.SAP?.isSelected && { 'insights-sap-system': true }),\n            ...(selectedWorkloads.current['Ansible Automation Platform']?.isSelected && { 'insights-ansible-system': true }),\n            ...(selectedWorkloads.current['Microsoft SQL']?.isSelected && { 'insights-mssql-system': true }),\n            ...(selectedSID.current?.length && { 'insights-sap-sids': `${selectedSID.current}` })\n        }\n    }));\n    const client = useMemo(() =>  new ApolloClient({\n        link: globalFilterLink.concat(createHttpLink({\n            uri: '/api/malware-detection/v1/graphql'\n        })),\n        cache,\n        connectToDevTools\n    }, `${tags.current}`), [connectToDevTools, globalFilterLink]);\n    registry.register({ notifications });\n\n    useEffect(() => {\n        chrome.init();\n        chrome.identifyApp('malware');\n        if (chrome.globalFilterScope) {\n            chrome.on('GLOBAL_FILTER_UPDATE', ({ data }) => {\n                const [workloads, SID, selectedTags] =\n                chrome.mapGlobalFilter?.(data, false, true) || [];\n                tags.current =  selectedTags?.join(',') || '';\n\n                selectedWorkloads.current = workloads || {};\n                selectedSID.current = SID || [];\n\n                globalFilters({ workloads, SID, selectedTags });\n\n                client.resetStore();\n            });\n        }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [client]);\n\n    return <IntlProvider locale={navigator.language.slice(0, 2)} messages={messages} onError={console.log}>\n        <ApolloProvider client={client}>\n            <RegistryContext.Provider value={{ getRegistry: () => registry }}>\n                <Provider store={registry.getStore()}>\n                    <Router basename={getBaseName(window.location.pathname)}>\n                        <NotificationsPortal />\n                        <App />\n                    </Router>\n                </Provider>\n            </RegistryContext.Provider>\n        </ApolloProvider>\n    </IntlProvider>;\n};\n\nAppEntry.propTypes = {\n    useLogger: PropTypes.bool,\n    connectToDevTools: PropTypes.bool\n};\n\nAppEntry.defaultProps = {\n    useLogger: false,\n    connectToDevTools: false\n};\n\nexport default AppEntry;\n"],"names":["AppEntry","useLogger","connectToDevTools","tags","useRef","registry","init","logger","selectedWorkloads","selectedSID","chrome","useChrome","globalFilterLink","setContext","_","headers","current","length","SAP","isSelected","client","useMemo","ApolloClient","link","concat","createHttpLink","uri","cache","register","notifications","useEffect","identifyApp","globalFilterScope","on","data","mapGlobalFilter","workloads","SID","selectedTags","join","globalFilters","resetStore","locale","navigator","language","slice","messages","onError","console","log","value","getRegistry","Provider","store","getStore","basename","getBaseName","window","location","pathname","NotificationsPortal","propTypes","PropTypes","defaultProps"],"sourceRoot":""}