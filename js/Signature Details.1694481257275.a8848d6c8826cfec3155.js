(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[982],{89837:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var n=a(69291),l=a(45697),r=a.n(l),o=a(93264),s=a.n(o),c=function(e){var t=e.items,a=t.pop();return s().createElement(n.Breadcrumb,null,t.map((function(e,t){return s().createElement(n.BreadcrumbItem,{key:t,to:e.to},e.name)})),s().createElement(n.BreadcrumbItem,{isActive:!0},a.name))};c.propTypes={items:r().array};const i=c},38846:(e,t,a)=>{"use strict";a.d(t,{Z:()=>f});var n=a(99332),l=a(51957),r=a(88461),o=a(45697),s=a.n(o),c=a(93264),i=a.n(c),m=a(30893),u=a(86896),d=function(e){var t=e.code,a=e.language,o=e.isReadOnly,s=e.isDownloadEnabled,c=e.isCopyEnabled,d=e.height,f=void 0===d?"400px":d,g=(0,u.Z)();return i().createElement(r.p,{isDownloadEnabled:s,isCopyEnabled:c,isReadOnly:o,isLanguageLabelVisible:a,code:t,language:a,emptyState:i().createElement(l.Z,{className:"",icon:n.mB,variant:"small",title:g.formatMessage(m.Z.sigCompiled),text:g.formatMessage(m.Z.sigCompiledBody)}),height:f})};d.propTypes={code:s().any,language:s().string,isReadOnly:s().bool,isCopyEnabled:s().bool,isDownloadEnabled:s().bool,height:s().string},d.defaultProps={codeType:"Code"};const f=d},51957:(e,t,a)=>{"use strict";a.d(t,{Z:()=>f});var n=a(9947),l=a(38424),r=a(75106),o=a(76473),s=a(45697),c=a.n(s),i=a(93264),m=a.n(i),u=a(60485),d=function(e){var t=e.className,a=e.children,o=e.icon,s=e.iconClass,c=e.iconStyle,i=e.text,d=e.title,f=e.variant;return m().createElement(n.u,{className:t,variant:f},"none"!==o&&m().createElement(l.k,{className:s,style:c,icon:o}),m().createElement(u.D,{headingLevel:"h5",size:"lg"},d),m().createElement(r.B,{style:{marginBottom:"16px"}},i),a)};d.propTypes={children:c().any,icon:c().any,iconClass:c().any,iconStyle:c().any,text:c().any,title:c().string,variant:c().any,className:c().string},d.defaultProps={icon:o.ZP,title:"",variant:n.I.full};const f=d},42946:(e,t,a)=>{"use strict";a.d(t,{Z:()=>y});var n=a(93264),l=a.n(n),r=a(34348),o=a(6202),s=a(219),c=a(86728),i=a(74183),m=a(5913),u=a(86896),d=a(30893),f=a(45697),g=a.n(f),p=function(e){var t=e.message,a=e.className,n=(0,u.Z)();return l().createElement(s.ub,{className:a,variant:"large"},l().createElement(c.k,{icon:m.ZP}),l().createElement(r.Title,{headingLevel:"h4",size:"lg"},n.formatMessage(d.Z.emptyAccountTitle)),l().createElement(i.B,null,t),l().createElement(o.Button,{variant:"primary",component:"a",href:"https://access.redhat.com/documentation/en-us/red_hat_insights/2023/html/assessing_and_reporting_malware_signatures_on_rhel_systems",target:"_blank"},n.formatMessage(d.Z.emptyAccountButton)))};p.propTypes={message:g().string,className:g().string};const y=p},53830:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>se});var n=a(70885),l=a(22910),r=a(96823),o=a(80765),s=a(49287),c=a(18038),i=a(23218),m=a(19535),u=a(50470),d=a(84564),f=a(60485),g=a(89837),p=a(62410),y=a(84580),E=a(52661),v=a(14748),h=a(89376),Z=a(39173),b=a(93264),M=a.n(b),C=a(42982),S=a(4942),P=a(44733),N=a(68868),w=a(62480),D=a(7732),A=a(1082),B=a(86379),_=a(22546),x=a(3351),O=a(6934),k=a(22860),T=a(68778),L=a(38846),H=a(82779),I=a(51957),R=a(3962),V=a(80810),j=a(30893),F=a(45697),z=a.n(F),W=a(86896),U=a(90570),q=a(42946),G=a(92397),J=a(80710);function K(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?K(Object(a),!0).forEach((function(t){(0,S.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):K(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Y={1:"DISPLAY_NAME",2:"LAST_SCAN_DATE",3:"MATCH_COUNT"},X=function(e){var t=e.index,a=e.direction;return"".concat(Y[t],"_").concat(a===N.B.asc?"ASC":"DESC")},$=function(e,t){switch(t.type){case"setTableVars":return Q(Q({},e),{},{tableVars:Q(Q({},e.tableVars),t.payload)});case"setSortBy":return Q(Q({},e),{},{sortBy:t.payload,tableVars:Q(Q({},e.tableVars),t.tableVars)});case"setRows":return Q(Q({},e),{},{rows:t.payload})}return e},ee=function(e){var t,a,l,r,o,s,c,i,m=e.ruleName,u=e.affectedCount,d=e.isEmptyAccount,f=(0,W.Z)(),g={tableVars:{limit:10,offset:0,orderBy:"LAST_SCAN_DATE_ASC",displayName:"",ruleName:m},sortBy:{index:2,direction:N.B.asc},rows:[]},E=(0,b.useReducer)($,Q({},g)),v=(0,n.Z)(E,2),h=v[0],Z=h.tableVars,S=h.sortBy,F=h.rows,z=v[1],K=(0,U.a)(y.I8,{variables:Z}),Y=K.data,ee=K.loading,te=K.error,ae=[{title:f.formatMessage(j.Z.name),cellFormatters:[w.zW],transforms:[D.p,(0,A.d)(45)]},{title:f.formatMessage(j.Z.lastMatched),transforms:[D.p]},{title:f.formatMessage(j.Z.totalMatches),transforms:[(0,B.u)({tooltip:f.formatMessage(j.Z.totalMatchesNote)}),D.p]}],ne=Z.offset/Z.limit+1,le=[{label:f.formatMessage(j.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return z({type:"setTableVars",payload:{displayName:t,offset:0}})},value:Z.displayName,placeholder:f.formatMessage(j.Z.filterBy,{field:f.formatMessage(j.Z.name).toLowerCase()})}}],re=function(e,t){return z({type:"setTableVars",payload:{offset:t*Z.limit-Z.limit}})},oe=function(e,t){return z({type:"setTableVars",payload:{limit:t,offset:0}})};(0,b.useEffect)((function(){var e;z({type:"setRows",payload:function(e){return null==e?void 0:e.flatMap((function(e,t){var a,n=e;return[{rowId:t,isOpen:!1,cells:[{title:M().createElement(G.Z,{to:"/systems/".concat(n.id)},n.displayName)},{title:M().createElement(p.Z,{date:new Date(n.matches[n.matches.length-1].scanDate),type:"onlyDate"})},{title:M().createElement(G.Z,{to:"/systems/".concat(n.id)},null===(a=n.matchCount)||void 0===a?void 0:a.toLocaleString())}]},{parent:2*t,hostData:n,fullWidth:!0,cells:[]}]}))}(null==Y||null===(e=Y.rulesList[0])||void 0===e?void 0:e.affectedHostsList)})}),[f,Y]);var se=M().createElement(I.Z,{className:"pf-c-card",icon:V.W1,variant:"large",title:f.formatMessage(j.Z.noResults),text:f.formatMessage(j.Z.noResultsMatch)}),ce=M().createElement(I.Z,{className:"pf-c-card",variant:"large",icon:T.ZP,iconClass:"ins-l-success-color",title:f.formatMessage(j.Z.noAffectedHosts),text:f.formatMessage(j.Z.noAffectedHostsBody)}),ie=M().createElement(q.Z,{className:"pf-c-card",message:f.formatMessage(j.Z.emptyAccountTableBody)}),me=M().createElement(I.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"});return M().createElement(M().Fragment,null,M().createElement(R.Z,{pagination:{itemCount:(null==Y||null===(t=Y.rulesList[0])||void 0===t||null===(a=t.affectedHosts)||void 0===a?void 0:a.totalCount)||0,page:ne,perPage:Z.limit,onSetPage:function(e,t){re(0,t)},onPerPageSelect:function(e,t){oe(0,t)},isCompact:!0},filterConfig:{items:le}}),ee?M().createElement(J.Z,{columns:[{title:"",columnTransforms:[(0,_.A)("skeleton-expandable-column")]}].concat(ae),rowSize:Z.limit,sortBy:S}):M().createElement(x.i,{className:"sigTable","aria-label":"Signature Details table",rows:F,cells:ae,onCollapse:function(e,t,a){var n=(0,C.Z)(F),l=n[t+1].hostData;n[t]=Q(Q({},n[t]),{},{isOpen:a}),n[t+1].cells=[{title:M().createElement(L.Z,{height:"250px",code:"".concat(l.matches.map((function(e,t){return"Match Source: ".concat(e.source,"\nOffset:").concat(e.stringOffset,"\nMatch Data: ").concat(e.stringData,"\nMatch Identifier: ").concat(e.stringIdentifier,"\nMatch Scan Date: ").concat(new Date(e.scanDate).toUTCString(),"\n").concat(e.metadata?(0,H.Wi)(JSON.parse(e.metadata)):"","\n").concat(l.matches.length>1&&t!==l.matches.length-1?"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n":"")})).join("")),isDownloadEnabled:!0,isCopyEnabled:!0})}],z({type:"setRows",payload:n})},onSort:function(e,t,a){return z({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:X({index:t,direction:a}),offset:0}})},sortBy:(null==Y||null===(l=Y.rulesList[0])||void 0===l||null===(r=l.affectedHosts)||void 0===r?void 0:r.totalCount)>0?S:void 0,isStickyHeader:!0},M().createElement(O.x,null),M().createElement(k.R,null)),te||ee||0===u?!ee&&(d?ie:ce):0===(null==Y||null===(o=Y.rulesList[0])||void 0===o||null===(s=o.affectedHosts)||void 0===s?void 0:s.totalCount)?se:M().createElement(M().Fragment,null),te&&M().createElement(me,null),M().createElement(P.t,{itemCount:(null==Y||null===(c=Y.rulesList[0])||void 0===c||null===(i=c.affectedHosts)||void 0===i?void 0:i.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:Z.limit,page:ne,variant:P.a.bottom,onSetPage:re,onPerPageSelect:oe}))};ee.propTypes={ruleName:z().string,affectedCount:z().number,isEmptyAccount:z().bool};const te=ee;var ae=a(62012),ne=a(75709),le=a(55140),re=a(69957),oe=a(47173);const se=function(){var e,t,a,C=(0,W.Z)(),S=(0,ae.useParams)().id,P=[{name:C.formatMessage(j.Z.malwareDetectionSignatures),to:"".concat((0,H.hN)(),"/insights/malware")},{name:S,to:"#"}],N={query:y.c3,variables:{ruleName:S}},w=(0,U.a)(N.query,{variables:N.variables}),D=w.data,A=w.loading,B=null==D?void 0:D.rulesList[0],_=null==B?void 0:B.metadata,x=(null==B||null===(e=B.affectedHosts)||void 0===e?void 0:e.totalCount)>0,O=null==B?void 0:B.isDisabled,k=(null==_?void 0:_.references)||[],T=(null==_?void 0:_.xfti_references)||[],L=C.formatMessage(j.Z.dataNotAvailable),R=(0,le.Z)(),V=(0,b.useState)(!1),F=(0,n.Z)(V,2),z=F[0],q=F[1],G=(0,b.useState)(!1),J=(0,n.Z)(G,2),K=J[0],Q=J[1],Y={variables:{input:{id:null==B?void 0:B.id}},refetchQueries:[N],onCompleted:function(){q(!1),Q(!1)}},X=(0,ne.D)(y.EK,Y),$=(0,n.Z)(X,2),ee=$[0],se=$[1].loading,ce=(0,ne.D)(y._g,Y),ie=(0,n.Z)(ce,2),me=ie[0],ue=ie[1].loading,de=function(e,t){return M().createElement(M().Fragment,null,M().createElement("p",{className:"ins-l-detailBlockHeader"},e),M().createElement("p",null,t||L))},fe=function(e,t){return M().createElement("a",{className:"ins-l-referenceLink",rel:"noopener noreferrer",target:"_blank",href:e},t," ",M().createElement(u.ZP,null))};(0,b.useEffect)((function(){R.updateDocumentTitle("".concat(S," - Signatures - Malware | Red Hat Insights"))}),[R,S]),(0,b.useEffect)((function(){Q(!0)}),[D]);var ge,pe,ye,Ee,ve=M().createElement(I.Z,{variant:"large",icon:re.ZP,iconClass:"ins-l-custom-color",title:C.formatMessage(j.Z.disabledFromAnalysis),text:C.formatMessage(j.Z.disabledFromAnalysisBody)},M().createElement(oe.zx,{variant:"primary",isLoading:se,onClick:function(){return ee(Y)}},C.formatMessage(se?j.Z.enablingSignature:j.Z.enableSignatureForAnalysis))),he=M().createElement(l.L,{ouiaId:"actions",toggle:M().createElement(o.Z,{onToggle:function(){return q(!z)},isExpanded:z},C.formatMessage(j.Z.actions)),isOpen:z,dropdownItems:O?[M().createElement(r.h,{key:"action",ouiaId:"enable",onClick:function(){ee(Y),Q(!1)}},C.formatMessage(se?j.Z.enablingSignature:j.Z.enableSignatureForAnalysis))]:[M().createElement(r.h,{key:"action",ouiaId:"disable",onClick:function(){me(Y),Q(!1)}},C.formatMessage(ue?j.Z.disablingSignature:j.Z.disableSignatureFromAnalysis))],style:{paddingBottom:0}});return M().createElement(M().Fragment,null,M().createElement(h.Z,null,M().createElement(g.Z,{items:P}),M().createElement(s.r,{hasGutter:!0},M().createElement(c.P,{md:9,sm:9},M().createElement(Z.Z,{title:M().createElement("span",null,S," ",(null==_?void 0:_.threat_type)&&M().createElement(i._,{variant:"outline",color:"blue"},_.threat_type)," ",(O||x)&&M().createElement(i._,{variant:"filled",color:"red"},O?"Disabled":"Matched"))})),M().createElement(c.P,{md:3,sm:3},he),A?M().createElement(E.Z,null):M().createElement(c.P,null,M().createElement(s.r,{hasGutter:!0},M().createElement(c.P,{xl2:7,md:8,sm:12},M().createElement("p",{className:"ins-l-detailBlockHeader"},C.formatMessage(j.Z.description)),M().createElement(m.Z,{text:null==_?void 0:_.description,length:200,inline:!0})),M().createElement(c.P,{xl2:5,md:4,sm:12},de(C.formatMessage(j.Z.matchedSystems),O?"N/A":x?M().createElement(M().Fragment,null,M().createElement(d.ZP,{color:"var(--pf-global--danger-color--100)"})," ",M().createElement("span",{style:{color:"var(--pf-global--danger-color--200)",fontWeight:"bold"}},"".concat(null==B||null===(ge=B.affectedHosts)||void 0===ge?void 0:ge.totalCount,"/").concat(null==D||null===(pe=D.hosts)||void 0===pe?void 0:pe.totalCount))):M().createElement("span",null,"".concat(null==B||null===(ye=B.affectedHosts)||void 0===ye?void 0:ye.totalCount,"/").concat(null==D||null===(Ee=D.hosts)||void 0===Ee?void 0:Ee.totalCount)))),M().createElement(c.P,{lg:2,md:3,sm:12},de(C.formatMessage(j.Z.ruleCategory),null==_?void 0:_.rule_category)),M().createElement(c.P,{xl2:5,lg:6,md:5,sm:12},de(C.formatMessage(j.Z.ruleIntendedUsage),null==_?void 0:_.usage)),M().createElement(c.P,{xl2:5,md:4,sm:12},de(C.formatMessage(j.Z.lastmatch),O?"N/A":null!=B&&B.lastMatchDate?M().createElement(p.Z,{date:new Date(B.lastMatchDate),type:"onlyDate"}):C.formatMessage(j.Z.never))),M().createElement(c.P,{xl2:7,md:8,sm:12},de(C.formatMessage(j.Z.author),null==_?void 0:_.author)),(k.length>0||T.length>0)&&M().createElement(c.P,{xl2:7,md:8,sm:12},1===T.length?fe(T[0],C.formatMessage(j.Z.ruleAuthorReference)):T.map((function(e,t){return fe(e,"".concat(C.formatMessage(j.Z.ruleAuthorReference)," [").concat(t+1,"] "))})),1===k.length?fe(k[0],C.formatMessage(j.Z.ruleBackgroundReference)):k.map((function(e,t){return fe(e,"".concat(C.formatMessage(j.Z.ruleBackgroundReference)," [").concat(t+1,"] "))}))))))),M().createElement(v.ZP,null,K?O?ve:M().createElement(M().Fragment,null,M().createElement(f.D,{className:"ins-l-tableBlockHeader",headingLevel:"h2"},C.formatMessage(j.Z.affectedHosts)),M().createElement(te,{ruleName:S,isEmptyAccount:0===(null==D||null===(t=D.hosts)||void 0===t?void 0:t.totalCount),affectedCount:null==B||null===(a=B.affectedHosts)||void 0===a?void 0:a.totalCount})):M().createElement(E.Z,null)))}},65088:()=>{},11452:()=>{},58392:()=>{},34946:()=>{},32857:()=>{},3162:()=>{},28992:()=>{},30187:()=>{},21626:()=>{},21064:()=>{},82014:()=>{},93398:()=>{},46928:()=>{},91993:()=>{},66822:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},67761:()=>{},87234:()=>{},72816:()=>{},75347:()=>{},31777:()=>{},34017:()=>{},59905:()=>{},64604:()=>{}}]);
//# sourceMappingURL=../sourcemaps/Signature Details.105266f6513bf1391347c31e48281de9.js.map