(self.webpackChunkmalware=self.webpackChunkmalware||[]).push([[9982],{9791:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});var s=a(69291),l=a(45697),r=a.n(l),n=a(28416),o=a.n(n);const i=({items:e})=>{const t=e.pop();return o().createElement(s.Breadcrumb,null,e.map(((e,t)=>o().createElement(s.BreadcrumbItem,{key:t,to:e.to},e.name))),o().createElement(s.BreadcrumbItem,{isActive:!0},t.name))};i.propTypes={items:r().array};const c=i},20864:(e,t,a)=>{"use strict";a.d(t,{Z:()=>g});var s=a(22541),l=a(41841),r=a(16906),n=a(45697),o=a.n(n),i=a(28416),c=a.n(i),m=a(2550),d=a(86896);function u(e=new Date){const t=e=>`${1===`${e}`.length?"0":""}${e}`,a=new Date(e);if(a instanceof Date&&!isNaN(a)){const e=a.getFullYear(),s=a.getMonth()+1,l=a.getDate(),r=a.getUTCHours(),n=a.getUTCMinutes(),o=a.getUTCSeconds();return`${e}-${t(s)}-${t(l)}_${t(r)}-${t(n)}-${t(o)}-UTC`}return a}a(18446);const p=({code:e,language:t,isReadOnly:a,isDownloadEnabled:n,isCopyEnabled:o,height:i="400px"})=>{const p=(0,d.Z)();return c().createElement(r.p,{isDownloadEnabled:n,downloadFileName:`malware-detection_signature--${u(Date.now())}`,isCopyEnabled:o,isReadOnly:a,isLanguageLabelVisible:t,code:e,language:t,emptyState:c().createElement(l.Z,{className:"",icon:s.LockIcon,variant:"small",title:p.formatMessage(m.Z.sigCompiled),text:p.formatMessage(m.Z.sigCompiledBody)}),height:i})};p.propTypes={code:o().any,language:o().string,isReadOnly:o().bool,isCopyEnabled:o().bool,isDownloadEnabled:o().bool,height:o().string},p.defaultProps={codeType:"Code"};const g=p},41841:(e,t,a)=>{"use strict";a.d(t,{Z:()=>f});var s=a(9947),l=a(67880),r=a(38424),n=a(75106),o=a(80315),i=a(55207),c=a.n(i),m=a(45697),d=a.n(m),u=a(28416),p=a.n(u);const g=({className:e,children:t,icon:a,iconClass:i,iconStyle:c,text:m,title:d,variant:u})=>p().createElement(s.u,{className:e,variant:u},p().createElement(l.t,{titleText:d,headingLevel:"h5",icon:"none"!==a&&p().createElement(r.k,{className:i,style:c,icon:a})}),p().createElement(n.B,{style:{marginBottom:"16px"}},m),p().createElement(o.O,null,t));g.propTypes={children:d().any,icon:d().any,iconClass:d().any,iconStyle:d().any,text:d().any,title:d().string,variant:d().any,className:d().string},g.defaultProps={icon:c(),title:"",variant:s.I.full};const f=g},49237:(e,t,a)=>{"use strict";a.d(t,{Z:()=>f});var s=a(28416),l=a.n(s),r=a(31593),n=a(4252),o=a(6928),i=a.n(o),c=a(86896),m=a(2550),d=a(45697),u=a.n(d),p=a(33203);const g=({message:e,className:t})=>{const a=(0,c.Z)();return l().createElement(n.EmptyState,{className:t,variant:"lg"},l().createElement(n.EmptyStateHeader,{titleText:a.formatMessage(m.Z.emptyAccountTitle),headingLevel:"h4",icon:l().createElement(n.EmptyStateIcon,{icon:i()})}),l().createElement(n.EmptyStateBody,null,e),l().createElement(n.EmptyStateFooter,null,l().createElement(r.Button,{variant:"primary",component:"a",href:p.ie,target:"_blank"},a.formatMessage(m.Z.emptyAccountButton))))};g.propTypes={message:u().string,className:u().string};const f=g},84800:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>me});var s=a(39480),l=a(87282),r=a(79332),n=a(52317),o=a(64789),i=a(49818),c=a(85056),m=a.n(c),d=a(48099),u=a.n(d),p=a(38779),g=a(9791),f=a(62410),y=a(51364),E=a(66338),h=a(83920),b=a(99087),Z=a(63456),M=a(39173),C=a(28416),v=a.n(C),N=a(55573),S=a(38800),D=a(5756),w=a(7732),$=a(1082),T=a(86379),A=a(43416),I=a(49004),B=a(58027),x=a(15433),L=a(73993),F=a.n(L),k=a(20864),G=a(33203),R=a(41841),V=a(10097),H=a(4036),_=a(2550),P=a(45697),O=a.n(P),U=a(86896),W=a(71641),q=a(49237),z=a(92397),Q=a(96486),Y=a(12913);const j={1:"DISPLAY_NAME",2:"GROUP_NAME",3:"OS_VERSION",4:"LAST_SCAN_DATE",5:"MATCH_COUNT"},J=({index:e,direction:t})=>`${j[e]}_${t===S.B.asc?"ASC":"DESC"}`,K=(e,t)=>{switch(t.type){case"setTableVars":return{...e,tableVars:{...e.tableVars,...t.payload}};case"setSortBy":return{...e,sortBy:t.payload,tableVars:{...e.tableVars,...t.tableVars}};case"setRows":return{...e,rows:t.payload};case"setGroups":return{...e,groups:t.payload}}return e},X=({ruleName:e,affectedCount:t,isEmptyAccount:a})=>{const s=(0,U.Z)(),l={tableVars:{limit:10,offset:0,orderBy:"LAST_SCAN_DATE_DESC",displayName:"",hostGroupFilter:void 0,ruleName:e},sortBy:{index:4,direction:S.B.desc},rows:[],groups:[]},[{tableVars:r,sortBy:n,rows:o,groups:i},c]=(0,C.useReducer)(K,{...l}),{data:m,loading:d,error:u}=(0,W.a)(y.I8,{variables:r}),{data:p,loading:g}=(0,W.a)(y.Fl,{variables:r}),E=[{title:s.formatMessage(_.Z.name),cellFormatters:[D.zW],transforms:[w.p,(0,$.d)(45)]},{title:s.formatMessage(_.Z.group),transforms:[w.p,(0,$.d)(15)]},{title:s.formatMessage(_.Z.os),key:"osVersion",transforms:[w.p,(0,$.d)(10)]},{title:s.formatMessage(_.Z.lastMatched),transforms:[w.p,(0,$.d)(10)]},{title:s.formatMessage(_.Z.totalMatches),transforms:[(0,T.u)({tooltip:s.formatMessage(_.Z.totalMatchesNote)}),w.p,(0,$.d)(10)]}],h=r.offset/r.limit+1,b=[{label:s.formatMessage(_.Z.name).toLowerCase(),type:"text",filterValues:{key:"text-filter",onChange:(e,t)=>c({type:"setTableVars",payload:{displayName:t,offset:0}}),value:r.displayName,placeholder:s.formatMessage(_.Z.filterBy,{field:s.formatMessage(_.Z.name).toLowerCase()})}},{label:s.formatMessage(_.Z.group).toLowerCase(),type:(0,Q.isEmpty)(i)?"group":"checkbox",filterValues:{key:"group-filter",onChange:(e,t)=>{c({type:"setTableVars",payload:{hostGroupFilter:t},offset:0})},items:g?[]:(0,Q.isEmpty)(i)?[{isDisabled:!0,label:s.formatMessage(_.Z.noGroups)}]:i,value:r.hostGroupFilter,placeholder:s.formatMessage(_.Z.filterBy,{field:s.formatMessage(_.Z.group).toLowerCase()})}}],Z=(e,t)=>c({type:"setTableVars",payload:{offset:t*r.limit-r.limit}}),M=(e,t)=>c({type:"setTableVars",payload:{limit:t,offset:0}});(0,C.useEffect)((()=>{c({type:"setRows",payload:(e=>e?.flatMap(((e,t)=>{const a=e;return[{rowId:t,isOpen:!1,cells:[{title:v().createElement(z.Z,{to:`/systems/${a.id}`},a.displayName)},{title:`${a.groups?.[0]?.name||s.formatMessage(_.Z.notApplicable)}`},{title:a.osVersion?`RHEL ${a.osVersion}`:s.formatMessage(_.Z.dataNotAvailable)},{title:v().createElement(f.Z,{date:new Date(a.matches[a.matches.length-1].scanDate),type:"onlyDate"})},{title:v().createElement(z.Z,{to:`/systems/${a.id}`},a.matchCount?.toLocaleString())}]},{parent:2*t,hostData:a,fullWidth:!0,cells:[]}]})))(m?.rulesList[0]?.affectedHostsList)})}),[s,m]),(0,C.useEffect)((()=>{let e=(e=>e?.filter((e=>!(0,Q.isEmpty)(e.groups))).map((e=>({label:e.groups[0].name,value:e.groups[0].name}))))(p?.rulesList[0]?.affectedHostsList)||[];e=(0,Q.uniqWith)(e,((e,t)=>e.label===t.label)),c({type:"setGroups",payload:e})}),[p]);const L=v().createElement(R.Z,{className:"pf-c-card",icon:H.SearchIcon,variant:"large",title:s.formatMessage(_.Z.noResults),text:s.formatMessage(_.Z.noResultsMatch)}),P=v().createElement(R.Z,{className:"pf-c-card",variant:"large",icon:F(),iconClass:"ins-l-success-color",title:s.formatMessage(_.Z.noAffectedHosts),text:s.formatMessage(_.Z.noAffectedHostsBody)}),O=v().createElement(q.Z,{className:"pf-c-card",message:s.formatMessage(_.Z.emptyAccountTableBody)}),j=v().createElement(R.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),X={deleteTitle:s.formatMessage(_.Z.resetFilters),filters:(()=>{const e=[];return r?.displayName&&e.push({category:s.formatMessage(_.Z.name),value:"name",chips:[{name:r?.displayName,value:r?.displayName}]}),r?.hostGroupFilter&&e.push({category:s.formatMessage(_.Z.group),value:"groups",chips:r.hostGroupFilter.map((e=>({name:e,value:e})))}),e})(),showDeleteButton:""!==r?.displayName||void 0!==r?.hostGroupFilter,onDelete:(e,t,a)=>{a?c({type:"setTableVars",payload:{displayName:"",hostGroupFilter:void 0,offset:0}}):t.map((e=>{if("name"===e.value&&c({type:"setTableVars",payload:{displayName:""}}),"groups"===e.value){const t=r.hostGroupFilter.filter((t=>t!==e.chips[0].name)),a={hostGroupFilter:t.length?t:void 0,offset:0};c({type:"setTableVars",payload:a})}}))}};return v().createElement(v().Fragment,null,v().createElement(V.Z,{pagination:{itemCount:m?.rulesList[0]?.affectedHosts?.totalCount||0,page:h,perPage:r.limit,onSetPage(e,t){Z(0,t)},onPerPageSelect(e,t){M(0,t)},isCompact:!0},filterConfig:{items:b},activeFiltersConfig:X}),d?v().createElement(Y.Z,{rows:r.limit,columns:E.map((e=>e.title))}):v().createElement(A.i,{className:"sigTable","aria-label":"Signature Details table",rows:o,cells:E,onCollapse:(e,t,a)=>{const s=[...o],l=s[t+1].hostData;s[t]={...s[t],isOpen:a},s[t+1].cells=[{title:v().createElement(k.Z,{height:"250px",code:`${l.matches.map(((e,t)=>`Match Source: ${e.source}\nOffset:${e.stringOffset}\nMatch Data: ${e.stringData}\nMatch Identifier: ${e.stringIdentifier}\nMatch Scan Date: ${new Date(e.scanDate).toUTCString()}\n${e.metadata?(0,G.Wi)(JSON.parse(e.metadata)):""}\n${l.matches.length>1&&t!==l.matches.length-1?"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n":""}`)).join("")}`,isDownloadEnabled:!0,isCopyEnabled:!0})}],c({type:"setRows",payload:s})},onSort:(e,t,a)=>c({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:J({index:t,direction:a}),offset:0}}),sortBy:m?.rulesList[0]?.affectedHosts?.totalCount>0?n:void 0,isStickyHeader:!0},v().createElement(I.x,null),v().createElement(B.R,null)),u||d||0===t?!d&&(a?O:P):0===m?.rulesList[0]?.affectedHosts?.totalCount?L:v().createElement(v().Fragment,null),u&&v().createElement(j,null),v().createElement(x.Z,{isFooter:!0},v().createElement(N.t,{itemCount:m?.rulesList[0]?.affectedHosts?.totalCount||0,widgetId:"pagination-options-menu-bottom",perPage:r.limit,page:h,variant:N.a.bottom,onSetPage:Z,onPerPageSelect:M})))};X.propTypes={ruleName:O().string,affectedCount:O().number,isEmptyAccount:O().bool};const ee=X;var te=a(51663),ae=a(50319),se=a(55140),le=a(42317),re=a.n(le),ne=a(46796),oe=a(65422),ie=a(71355),ce=a(43707);const me=()=>{const e=(0,U.Z)(),t=(0,oe.I0)(),a=(0,ce.TE)("malware-detection",G.aQ.write).hasAccess,{id:c}=(0,te.useParams)(),d=[{name:e.formatMessage(_.Z.malwareDetectionSignatures),to:`${(0,G.hN)()}/insights/malware`},{name:c,to:"#"}],N={query:y.c3,variables:{ruleName:c}},{data:S,loading:D}=(0,W.a)(N.query,{variables:N.variables}),w=S?.rulesList[0],$=w?.metadata,T=w?.affectedHosts?.totalCount>0,A=w?.isDisabled,I=$?.references||[],B=$?.xfti_references||[],x=e.formatMessage(_.Z.dataNotAvailable),L=(0,se.Z)(),[F,k]=(0,C.useState)(!1),[V,H]=(0,C.useState)(!1),P={variables:{input:{id:w?.id}},refetchQueries:[N],onCompleted:()=>{k(!1),H(!1)},onError:({networkError:a})=>{k(!1),H(!0);const s=`${a.response.statusText} - ${a.bodyText}`;(e=>{t((0,ie.addNotification)(e))})({variant:"danger",dismissable:!0,title:e.formatMessage(_.Z.error),description:`${s}`})}},[O,{loading:q}]=(0,ae.D)(E.E,P),[z,{loading:Q}]=(0,ae.D)(E._,P),Y=(e,t)=>v().createElement(v().Fragment,null,v().createElement("p",{className:"ins-l-detailBlockHeader"},e),v().createElement("p",null,t||x)),j=(e,t)=>v().createElement("a",{className:"ins-l-referenceLink",rel:"noopener noreferrer",target:"_blank",href:e},t," ",v().createElement(m(),null));(0,C.useEffect)((()=>{L.updateDocumentTitle(`${c} - Signatures - Malware | Red Hat Insights`)}),[L,c]),(0,C.useEffect)((()=>{H(!0)}),[S]);const J=v().createElement(R.Z,{variant:"large",icon:re(),iconClass:"ins-l-custom-color",title:e.formatMessage(_.Z.disabledFromAnalysis),text:e.formatMessage(_.Z.disabledFromAnalysisBody,{disabledBy:w?.disabledBy||"Unknown",disabledAt:v().createElement(f.Z,{date:w?.disabledAt||new Date,type:"onlyDate"})})},a&&v().createElement(ne.zx,{variant:"primary",isLoading:q,onClick:()=>O(P)},e.formatMessage(q?_.Z.enablingSignature:_.Z.enableSignatureForAnalysis))),K=v().createElement(r.L,{ouiaId:"actions",toggle:v().createElement(n.Z,{onToggle:()=>k(!F),isExpanded:F},e.formatMessage(_.Z.actions)),isOpen:F,dropdownItems:A?[v().createElement(o.h,{key:"action",ouiaId:"enable",onClick:()=>{O(P),H(!1)}},e.formatMessage(q?_.Z.enablingSignature:_.Z.enableSignatureForAnalysis))]:[v().createElement(o.h,{key:"action",ouiaId:"disable",onClick:()=>{z(P),H(!1)}},e.formatMessage(Q?_.Z.disablingSignature:_.Z.disableSignatureFromAnalysis))],style:{paddingBottom:0}});return v().createElement(v().Fragment,null,v().createElement(Z.Z,null,v().createElement(g.Z,{items:d}),v().createElement(s.Grid,{hasGutter:!0},v().createElement(s.GridItem,{md:9,sm:9},v().createElement(M.Z,{title:v().createElement("span",null,c," ",$?.threat_type&&v().createElement(l.Label,{variant:"outline",color:"blue"},$.threat_type)," ",(A||T)&&v().createElement(l.Label,{variant:"filled",color:"red"},A?"Disabled":"Matched"))})),a&&v().createElement(s.GridItem,{md:3,sm:3},K),D?v().createElement(h.Z,null):v().createElement(s.GridItem,null,v().createElement(s.Grid,{hasGutter:!0},v().createElement(s.GridItem,{xl2:7,md:8,sm:12},v().createElement("p",{className:"ins-l-detailBlockHeader"},e.formatMessage(_.Z.description)),v().createElement(i.Z,{text:$?.description,length:200,inline:!0})),v().createElement(s.GridItem,{xl2:5,md:4,sm:12},Y(e.formatMessage(_.Z.matchedSystems),A?e.formatMessage(_.Z.notApplicable):T?v().createElement(v().Fragment,null,v().createElement(u(),{color:"var(--pf-global--danger-color--100)"})," ",v().createElement("span",{style:{color:"var(--pf-global--danger-color--200)",fontWeight:"bold"}},`${w?.affectedHosts?.totalCount}/${S?.hosts?.totalCount}`)):v().createElement("span",null,`${w?.affectedHosts?.totalCount}/${S?.hosts?.totalCount}`))),v().createElement(s.GridItem,{lg:2,md:3,sm:12},Y(e.formatMessage(_.Z.ruleCategory),$?.rule_category)),v().createElement(s.GridItem,{xl2:5,lg:6,md:5,sm:12},Y(e.formatMessage(_.Z.ruleIntendedUsage),$?.usage)),v().createElement(s.GridItem,{xl2:5,md:4,sm:12},Y(e.formatMessage(_.Z.lastmatch),A?e.formatMessage(_.Z.notApplicable):w?.lastMatchDate?v().createElement(f.Z,{date:new Date(w.lastMatchDate),type:"onlyDate"}):e.formatMessage(_.Z.never))),v().createElement(s.GridItem,{xl2:7,md:8,sm:12},Y(e.formatMessage(_.Z.author),$?.author)),(I.length>0||B.length>0)&&v().createElement(s.GridItem,{xl2:7,md:8,sm:12},1===B.length?j(B[0],e.formatMessage(_.Z.ruleAuthorReference)):B.map(((t,a)=>j(t,`${e.formatMessage(_.Z.ruleAuthorReference)} [${a+1}] `))),1===I.length?j(I[0],e.formatMessage(_.Z.ruleBackgroundReference)):I.map(((t,a)=>j(t,`${e.formatMessage(_.Z.ruleBackgroundReference)} [${a+1}] `)))))))),v().createElement(b.ZP,null,V?A?J:v().createElement(v().Fragment,null,v().createElement(p.D,{className:"ins-l-tableBlockHeader",headingLevel:"h2"},e.formatMessage(_.Z.affectedHosts)),v().createElement(ee,{ruleName:c,isEmptyAccount:0===S?.hosts?.totalCount,affectedCount:w?.affectedHosts?.totalCount})):v().createElement(h.Z,null)))}},66338:(e,t,a)=>{"use strict";a.d(t,{E:()=>r,_:()=>l});var s=a(76058);const l=s.Ps`mutation DisableRule ($input: DisableRuleInput = {}) {
  disableRule(input: $input) {
    clientMutationId
  }
}`,r=s.Ps`mutation EnableRule ($input: EnableRuleInput = {}) {
  enableRule(input: $input) {
    clientMutationId
  }
}`},65088:()=>{},58392:()=>{},32857:()=>{},3162:()=>{},28992:()=>{},30187:()=>{},90479:()=>{},21626:()=>{},8572:()=>{},98379:()=>{},46928:()=>{},91993:()=>{},53336:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},67761:()=>{},87234:()=>{},22868:()=>{},14777:()=>{},99830:()=>{},70209:()=>{},87414:()=>{}}]);
//# sourceMappingURL=../sourcemaps/Signature Details.457151367c40e12abd733f60d1468a04.js.map