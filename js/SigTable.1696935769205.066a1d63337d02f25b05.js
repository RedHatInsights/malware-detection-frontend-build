(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[207],{38846:(e,t,a)=>{"use strict";a.d(t,{Z:()=>f});var n=a(99332),r=a(51957),s=a(88461),l=a(45697),i=a.n(l),o=a(93264),c=a.n(o),u=a(30893),d=a(86896),m=function(e){var t=e.code,a=e.language,l=e.isReadOnly,i=e.isDownloadEnabled,o=e.isCopyEnabled,m=e.height,f=void 0===m?"400px":m,p=(0,d.Z)();return c().createElement(s.p,{isDownloadEnabled:i,isCopyEnabled:o,isReadOnly:l,isLanguageLabelVisible:a,code:t,language:a,emptyState:c().createElement(r.Z,{className:"",icon:n.mB,variant:"small",title:p.formatMessage(u.Z.sigCompiled),text:p.formatMessage(u.Z.sigCompiledBody)}),height:f})};m.propTypes={code:i().any,language:i().string,isReadOnly:i().bool,isCopyEnabled:i().bool,isDownloadEnabled:i().bool,height:i().string},m.defaultProps={codeType:"Code"};const f=m},51957:(e,t,a)=>{"use strict";a.d(t,{Z:()=>f});var n=a(9947),r=a(38424),s=a(75106),l=a(76473),i=a(45697),o=a.n(i),c=a(93264),u=a.n(c),d=a(60485),m=function(e){var t=e.className,a=e.children,l=e.icon,i=e.iconClass,o=e.iconStyle,c=e.text,m=e.title,f=e.variant;return u().createElement(n.u,{className:t,variant:f},"none"!==l&&u().createElement(r.k,{className:i,style:o,icon:l}),u().createElement(d.D,{headingLevel:"h5",size:"lg"},m),u().createElement(s.B,{style:{marginBottom:"16px"}},c),a)};m.propTypes={children:o().any,icon:o().any,iconClass:o().any,iconStyle:o().any,text:o().any,title:o().string,variant:o().any,className:o().string},m.defaultProps={icon:l.ZP,title:"",variant:n.I.full};const f=m},58295:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>J});var n=a(42982),r=a(70885),s=a(4942),l=a(44733),i=a(93264),o=a.n(i),c=a(68868),u=a(62480),d=a(7732),m=a(1082),f=a(22546),p=a(3351),g=a(6934),v=a(22860),y=a(82779),b=a(62410),h=a(84580),M=a(24101),E=a(51957),Z=a(3962),S=a(80810),D=a(19399),O=a(35224),w=a(69174),P=a(30893),C=a(88676),_=a(86896),A=a(90570),T=a(75709),j=a(90025),N=a(38846),k=a(50693),F=a(16475),R=a(45697),B=a.n(R),L=a(63540),V=function(e){var t=e.signature,a=(0,_.Z)(),n=(0,i.useState)(!1),s=(0,r.Z)(n,1)[0];return o().createElement(k.r,{hasGutter:!0},s&&o().createElement(F.P,{span:6},o().createElement(N.Z,{code:t.rawRule,isReadOnly:!0})),o().createElement(F.P,{span:s?6:12}," ",o().createElement(L.xv,{className:"ins-l-sigtable--title",component:L.qO.h6},a.formatMessage(P.Z.description)),t.metadata.description))};V.propTypes={signature:B().object};const x=V;var I=a(92397),G=a(80710);function H(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function q(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?H(Object(a),!0).forEach((function(t){(0,s.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):H(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var $={tableVars:{limit:10,offset:0,orderBy:["LAST_MATCH_DATE_NULLS_LAST_DESC","NAME_ASC"],ruleName:""},sortBy:{index:5,direction:c.B.desc},rows:[],selectedSigs:[]},W={2:"NAME",3:"HAS_MATCH",4:"HOST_COUNT",5:"LAST_MATCH_DATE_NULLS_LAST"},Y=function(e){var t=e.index,a=e.direction,n="".concat(W[t],"_").concat(a===c.B.asc?"ASC":"DESC");return"NAME"!==W[t]?[n,"NAME_ASC"]:n},z=function(e,t){switch(t.type){case"setTableVars":return q(q({},e),{},{tableVars:q(q({},e.tableVars),t.payload)});case"setSortBy":return q(q({},e),{},{sortBy:t.payload,tableVars:q(q({},e.tableVars),t.tableVars)});case"setRows":return q(q({},e),{},{rows:t.payload});case"setSelectedSigs":return q(q({},e),{},{selectedSigs:t.payload})}return e},U=function(e){var t,a,s,c,y,N,k,F=e.refetchSigPageData,R=(0,_.Z)(),B=(0,i.useReducer)(z,q({},$)),L=(0,r.Z)(B,2),V=L[0],H=V.tableVars,W=V.sortBy,U=V.rows,J=V.selectedSigs,K=L[1],Q=(0,i.useState)(!1),X=(0,r.Z)(Q,2),ee=X[0],te=X[1],ae=(0,A.a)(h.tE,{variables:q(q({},H),(0,j.l)(C.gG))}),ne=ae.data,re=ae.loading,se=ae.error,le=ae.client,ie={variables:{input:{id:J.map((function(e){return e.id}))}},onCompleted:function(){te(!1),le.resetStore(),F(),K({type:"setSelectedSigs",payload:[]})}},oe=(0,T.D)(M.E,ie),ce=(0,r.Z)(oe,2),ue=ce[0],de=ce[1].loading,me=(0,T.D)(M._,ie),fe=(0,r.Z)(me,2),pe=fe[0],ge=fe[1].loading,ve=[{title:R.formatMessage(P.Z.sigName),cellFormatters:[u.zW],transforms:[d.p,(0,m.d)(45)]},{title:R.formatMessage(P.Z.lastStatus),transforms:[(0,m.d)(10),d.p]},{title:R.formatMessage(P.Z.systems),transforms:[(0,m.d)(10),d.p]},{title:R.formatMessage(P.Z.lastMatched),transforms:[(0,m.d)(10),d.p]}],ye=H.offset/H.limit+1,be={items:{hasMatch:"true",isDisabled:[]},condition:{hasMatch:!0,isDisabled:void 0}},he=function(e,t){var a=e.map((function(e){return e.sigData.id})),r=J.filter((function(e){return!a.includes(e.id)}));return t?[].concat((0,n.Z)(r),(0,n.Z)(e.map((function(e){return{id:e.sigData.id,name:e.sigData.name,isDisabled:e.sigData.isDisabled}})))):r},Me=["",{label:R.formatMessage(P.Z.enableSignaturesForAnalysis),onClick:function(){return ue(ie)},props:{isDisabled:0===J.filter((function(e){return e.isDisabled})).length}},{label:R.formatMessage(P.Z.disableSignaturesFromAnalysis),onClick:function(){return pe(ie)},props:{isDisabled:0===J.filter((function(e){return!e.isDisabled})).length}}],Ee={sig_match:{type:"radio",title:R.formatMessage(P.Z.status),urlParam:"sig_match",values:[{label:R.formatMessage(P.Z.all),value:"all"},{label:R.formatMessage(P.Z.matched),value:"true"},{label:R.formatMessage(P.Z.notMatched),value:"false"}]},sigs_included:{type:"checkbox",title:R.formatMessage(P.Z.signaturesIncludedFilter),urlParam:"sigs_included",values:[{label:R.formatMessage(P.Z.enabledSignaturesFilter),value:"false"},{label:R.formatMessage(P.Z.disabledSignaturesFilter),value:"true"}]}},Ze=[{label:Ee.sigs_included.title.toLowerCase(),type:Ee.sigs_included.type,id:Ee.sigs_included.urlParam,filterValues:{key:"".concat(Ee.sigs_included.urlParam,"-filter"),onChange:function(e,t){var a=(0,C.gG)();(0,C.gG)({items:q(q({},a.items),{},{isDisabled:t}),condition:q(q({},a.condition),{},{isDisabled:1!==t.length?void 0:JSON.parse(t[0])})})},value:(null===(t=(0,C.gG)().items)||void 0===t?void 0:t.isDisabled)||[],items:Ee.sigs_included.values}},{label:R.formatMessage(P.Z.signature).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return K({type:"setTableVars",payload:{ruleName:t,offset:0}})},value:H.ruleName,placeholder:R.formatMessage(P.Z.filterBy,{field:R.formatMessage(P.Z.signature).toLowerCase()})}},{label:Ee.sig_match.title.toLowerCase(),type:Ee.sig_match.type,id:Ee.sig_match.urlParam,value:"radio-".concat(Ee.sig_match.urlParam),filterValues:{key:"".concat(Ee.sig_match.urlParam,"-filter"),onChange:function(e,t){var a=(0,C.gG)();(0,C.gG)({items:q(q({},a.items),{},{hasMatch:t}),condition:q(q({},a.condition),{},{hasMatch:"all"===t?void 0:JSON.parse(t)})})},value:(null===(a=(0,C.gG)().items)||void 0===a?void 0:a.hasMatch)||"true",items:Ee.sig_match.values}}],Se=function(e,t){return K({type:"setTableVars",payload:{offset:t*H.limit-H.limit}})},De=function(e,t){return K({type:"setTableVars",payload:{limit:t,offset:0}})},Oe=function(e){var t=e.event,a=e.chips,n=void 0===a?[]:a,s=(0,C.gG)();if("add"===t){var l,i,o=R.formatMessage(P.Z.all);"true"===(null===(l=s.items)||void 0===l?void 0:l.hasMatch)?o=R.formatMessage(P.Z.matched):"false"===(null===(i=s.items)||void 0===i?void 0:i.hasMatch)&&(o=R.formatMessage(P.Z.notMatched)),n.push({category:R.formatMessage(P.Z.status),value:"matched",chips:[{name:o,value:o}]})}else if("remove"===t){var c,u="all"===(null===(c=s.items)||void 0===c?void 0:c.hasMatch)?["true",!0]:["all",void 0],d=(0,r.Z)(u,2),m=d[0],f=d[1];(0,C.gG)({items:q(q({},s.items),{},{hasMatch:m}),condition:q(q({},s.condition),{},{hasMatch:f})})}},we=function(e){var t=e.event,a=e.chips,n=void 0===a?[]:a,s=e.item,l=void 0===s?"":s,i=(0,C.gG)();if("add"===t){var o,c=[];null===(o=i.items)||void 0===o||o.isDisabled.map((function(e){var t=R.formatMessage("true"===e?P.Z.disabledSignaturesFilter:P.Z.enabledSignaturesFilter);c.push({name:t,value:t})})),n.push({category:R.formatMessage(P.Z.signaturesIncludedFilter),chips:c})}else if("remove"===t){var u,d=[],m=void 0;if(1!==(null===(u=i.items)||void 0===u?void 0:u.isDisabled.length)){var f=l.value===R.formatMessage(P.Z.enabledSignaturesFilter)?[["true"],!0]:[["false"],!1],p=(0,r.Z)(f,2);d=p[0],m=p[1]}(0,C.gG)({items:q(q({},i.items),{},{isDisabled:d}),condition:q(q({},i.condition),{},{isDisabled:m})})}},Pe={deleteTitle:R.formatMessage(P.Z.resetFilters),filters:(k=[],(null==H?void 0:H.ruleName)&&k.push({category:R.formatMessage(P.Z.signature),value:"name",chips:[{name:null==H?void 0:H.ruleName,value:null==H?void 0:H.ruleName}]}),Oe({event:"add",chips:k}),we({event:"add",chips:k}),k),showDeleteButton:!0,onDelete:function(e,t,a){a?((0,C.gG)(be),K({type:"setTableVars",payload:{ruleName:""}})):t.map((function(e){"name"===e.value&&K({type:"setTableVars",payload:{ruleName:""}}),"matched"===e.value&&Oe({event:"remove"}),"name"!==e.value&&"matched"!==e.value&&we({event:"remove",item:e})}))}};return(0,i.useEffect)((function(){(0,C.gG)(be)}),[]),(0,i.useEffect)((function(){K({type:"setTableVars",payload:{offset:0}})}),[(0,C.gG)().condition]),(0,i.useEffect)((function(){var e,t,a=J.map((function(e){return e.id}));K({type:"setRows",payload:(e=ne,null==e||null===(t=e.rulesList)||void 0===t?void 0:t.flatMap((function(e,t){var n,r=e;return[{rowId:t,isOpen:!1,sigData:r,selected:a.includes(r.id),cells:[{title:o().createElement(o().Fragment,null,o().createElement(I.Z,{to:"/signatures/".concat(r.name)},r.name),r.isDisabled&&o().createElement(o().Fragment,null,o().createElement("br",null),o().createElement(w._,{color:"red",isCompact:!0},R.formatMessage(P.Z.disabled))))},{title:r.isDisabled?R.formatMessage(P.Z.notApplicable):o().createElement(D.Z,{isDisabled:r.isDisabled,hasMatch:r.hasMatch,displayMatch:!0})},{title:r.isDisabled?R.formatMessage(P.Z.notApplicable):o().createElement(I.Z,{to:"/signatures/".concat(r.name)},null===(n=r.hostCount)||void 0===n?void 0:n.toLocaleString())},{title:r.isDisabled?R.formatMessage(P.Z.notApplicable):r.lastMatchDate?o().createElement(O.u,{content:o().createElement(b.Z,{date:new Date(r.lastMatchDate),type:"exact"})},o().createElement("span",null,o().createElement(b.Z,{date:new Date(r.lastMatchDate)}))):o().createElement(O.u,{content:R.formatMessage(P.Z.noHostHas)},o().createElement("span",null,R.formatMessage(P.Z.never)))}]},{parent:2*t,fullWidth:!0,cells:[]}]})))}),te(!0)}),[R,ne]),o().createElement(o().Fragment,null,o().createElement(Z.Z,{pagination:{itemCount:(null==ne||null===(s=ne.rules)||void 0===s?void 0:s.totalCount)||0,page:ye,perPage:H.limit,onSetPage:function(e,t){Se(0,t)},onPerPageSelect:function(e,t){De(0,t)},isCompact:!0},filterConfig:{items:Ze},activeFiltersConfig:Pe,actionsConfig:{actions:Me,dropdownProps:{ouiaId:"toolbar-actions"}}}),de||ge||!ee?o().createElement(G.Z,{columns:[{title:"",columnTransforms:[(0,f.A)("skeleton-expandable-column")]}].concat(ve),rowSize:H.limit,sortBy:W,isSelectable:!0}):o().createElement(p.i,{className:"sigTable","aria-label":"Signature table",onCollapse:function(e,t,a){var r=(0,n.Z)(U),s=r[t].sigData;r[t]=q(q({},r[t]),{},{isOpen:a}),r[t+1].cells=[{title:o().createElement(x,{signature:s})}],K({type:"setRows",payload:r})},rows:U,cells:ve,onSort:function(e,t,a){return K({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:Y({index:t,direction:a}),offset:0}})},sortBy:(null==ne||null===(c=ne.rulesList)||void 0===c?void 0:c.length)>0?W:void 0,isStickyHeader:!0,canSelectAll:!0,onSelect:function(e,t,a){var r,s=(0,n.Z)(U);-1===a?(s=s.map((function(e,a){return a%2==0?q(q({},e),{},{selected:t}):q({},e)})),r=he(s.filter((function(e,t){return t%2==0})),t)):(s[a]=q(q({},s[a]),{},{selected:t}),r=he([s[a]],t)),K({type:"setRows",payload:s}),K({type:"setSelectedSigs",payload:r})},actionResolver:function(e,t){var a=t.rowIndex,n=U[a].sigData||null;if(n){var r=q(q({},ie),{},{variables:{input:{id:n.id}}});return n.isDisabled?[{title:R.formatMessage(P.Z.enableSignatureForAnalysis),onClick:function(){return ue(r)}}]:[{title:R.formatMessage(P.Z.disableSignatureFromAnalysis),onClick:function(){return pe(r)}}]}}},o().createElement(g.x,null),o().createElement(v.R,null)),!re&&!se&&0===(null==ne||null===(y=ne.rules)||void 0===y?void 0:y.totalCount)&&o().createElement(E.Z,{className:"pf-c-card",icon:S.W1,variant:"large",title:R.formatMessage(P.Z.noResults),text:R.formatMessage(P.Z.noResultsMatch)}),se&&o().createElement(E.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),o().createElement(l.t,{itemCount:(null==ne||null===(N=ne.rules)||void 0===N?void 0:N.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:H.limit,page:ye,variant:l.a.bottom,onSetPage:Se,onPerPageSelect:De}))};U.propTypes=y.R$;const J=U},19399:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d});var n=a(23218),r=a(45697),s=a.n(r),l=a(93264),i=a.n(l),o=a(30893),c=a(86896),u=function(e){var t=e.isDisabled,a=e.hasMatch,r=e.displayMatch,s=void 0!==r&&r,l=(0,c.Z)();return s?i().createElement("div",null,a&&i().createElement(n._,{color:"red"},l.formatMessage(o.Z.matched)),!a&&i().createElement(n._,{color:"blue"},l.formatMessage(o.Z.notMatched))):i().createElement("div",null,t&&i().createElement(n._,null,l.formatMessage(o.Z.disabled)),!t&&i().createElement(n._,{color:"blue"},l.formatMessage(o.Z.enabled)))};u.propTypes={isDisabled:s().bool,hasMatch:s().bool,displayMatch:s().bool};const d=u},76822:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>te});var n=a(4942),r=a(15861),s=a(70885),l=a(87757),i=a.n(l),o=a(93264),c=a.n(o),u=a(45987),d=a(26075),m=a(41609),f=a.n(m),p=["tagFilters"];function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tagFilters,a=(0,u.Z)(e,p);f()(a.hostGroupFilter)&&delete a.hostGroupFilter,f()(a.osFilter)&&delete a.osFilter;var n=t?{tags:t.flatMap((function(e){return e.values.map((function(t){return{namespace:e.key,key:t.tagKey,value:t.value}}))}))}:{};return v(v({},a),n)},b=a(82644),h=a(29558),M=a(30319),E=a(1082),Z=a(86379),S=a(30893),D=a(19399),O=a(35224),w=a(62410),P=a(92397);function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var A=(0,b.Sn)(),T=navigator.language.slice(0,2),j=(0,h.d)({locale:T},A),N=function(e,t){return function(a){var n=a.INVENTORY_ACTION_TYPES,r=a.mergeWithEntities;return t().register(_({},r((0,M.zw)(n,e),{page:1,perPage:10,sortBy:{key:"totalMatches",direction:"desc"}})))}},k=[{title:j.formatMessage(S.Z.name),transforms:[(0,E.d)(30)],key:"displayName",sortBy:["DISPLAY_NAME"],renderFunc:function(e,t){return c().createElement(P.Z,{to:"/systems/".concat(t)},e)}},{title:"Group",key:"groups",sortBy:["GROUP_NAME"],requiresDefault:!0,props:{isStatic:!1}},{title:"Tags",key:"tags",props:{width:10,isStatic:!0}},{title:"OS",key:"osVersion",sortBy:["OS_VERSION"],props:{width:10},renderFunc:function(e){return e?"RHEL ".concat(e):j.formatMessage(S.Z.dataNotAvailable)}},{title:j.formatMessage(S.Z.lastStatus),transforms:[(0,E.d)(10)],key:"hasMatch",sortBy:["HAS_MATCH"],renderFunc:function(e,t,a){var n=a.isDisabled;return c().createElement(D.Z,{isDisabled:n,hasMatch:e,displayMatch:!0})}},{title:j.formatMessage(S.Z.lastMatched),transforms:[(0,E.d)(10)],key:"lastMatchDate",sortBy:["LAST_MATCH_DATE"],renderFunc:function(e){return e?c().createElement(O.u,{content:c().createElement(w.Z,{date:new Date(e),type:"exact"})},c().createElement("span",null,c().createElement(w.Z,{date:new Date(e)}))):c().createElement(O.u,{content:j.formatMessage(S.Z.noHostHas)},c().createElement("span",null,j.formatMessage(S.Z.never)))}},{title:j.formatMessage(S.Z.totalMatches),transforms:[(0,E.d)(10),(0,Z.u)({tooltip:j.formatMessage(S.Z.totalMatchesNote)})],key:"totalMatches",sortBy:["TOTAL_MATCHES"],renderFunc:function(e,t,a){var n=a.id;return c().createElement(P.Z,{to:"/systems/".concat(n)},null==e?void 0:e.toLocaleString())}},{title:j.formatMessage(S.Z.lastScan),key:"lastScanDate",sortBy:["LAST_SCAN_DATE"],renderFunc:function(e){return c().createElement(O.u,{content:c().createElement(w.Z,{date:new Date(e),type:"exact"})},c().createElement("span",null,c().createElement(w.Z,{date:new Date(e)})))}}],F=function(e){return k.map((function(t){var a="string"==typeof t,n=e.find((function(e){return e.key===t.key}));return t.requiresDefault&&void 0===n?void 0:_(_(_({},a?{key:t}:t),n),{},{props:_(_({},null==n?void 0:n.props),null==t?void 0:t.props)})})).filter(Boolean)},R=function(e,t){return null==e?void 0:e.map((function(e){return"".concat(e,"_").concat(t)}))},B=function(e){return(k||[]).find((function(t){return t.key===e}))},L=[{label:"All",value:"All"},{label:"Matched",value:!0},{label:"Not Matched",value:!1}],V=a(63652),x=a(84580),I=a(51957),G=a(80810),H=a(70044),q=a(67463),$=a(82779),W=a(86896),Y=a(88676),z=a(28216),U=a(83237);const J=function(e,t){return{label:"Status",type:U.Y.radio,filterValues:{onChange:function(e,a){var n=parseInt(a);t("2"===a?L[n].value:a)},items:L,value:e,placeholder:"Filter by status"}}};var K=function(e,t){return{filters:(a=e,r=[],a&&(r=r.concat([{category:"Status",id:"Status",chips:(n=L.find((function(e){return e.value===a.filterValues.value})),n?[{name:n.label,value:a.filterValues.value,id:n.value}]:[])}])),r),onDelete:function(e,a,n){n?t(!0):a.map((function(e){"Status"===e.category&&t("All"===e.chips[0].value||"All")}))},showDeleteButton:!0};var a,n,r};function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function X(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ee=function(){var e,t=(0,o.useRef)(null),a=(0,W.Z)(),n=(0,o.useContext)(M.gE).getRegistry,l=(0,z.useDispatch)(),u=(0,o.useState)(!0),m=(0,s.Z)(u,2),f=m[0],p=m[1];(0,o.useEffect)((function(){var e;l({type:"INVENTORY_INIT"}),l({type:"RESET_PAGE"}),null==t||null===(e=t.current)||void 0===e||e.onRefreshData()}),[l]);var g,b,h,E,Z,D=(0,o.useCallback)((g={query:x.c5},b=g.query,h=g.onComplete,E=g.onError,Z=(0,d.x)(),function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Z.query({query:b,fetchResults:!0,fetchPolicy:"no-cache",variables:v({limit:e,offset:t},a)}).then((function(e){var t,n=e.data,r={entities:(null==n?void 0:n.hostsList)||[],meta:v(v({},a.tags&&{tags:a.tags}),{},{totalCount:(null==n||null===(t=n.hosts)||void 0===t?void 0:t.totalCount)||0})};return null==h||h(r),r})).catch((function(e){if(E)return E(e),{entities:[],meta:{totalCount:0}};throw e}))}),[]),O=(null===(e=J(f,p))||void 0===e?void 0:e.filterValues).value;return c().createElement(c().Fragment,null,c().createElement(H.bZ,{isInline:!0,variant:"info",ouiaId:"SystemsListIsDifferentAlert",title:a.formatMessage(S.Z.systemsListIsDifferent)}),c().createElement(V.Z,{isFullView:!0,autoRefresh:!0,initialLoading:!0,hideFilters:{all:!0,name:!1,tags:!1,operatingSystem:!1,hostGroupFilter:!1},columns:F,hasCheckbox:!1,showTags:!0,ref:t,fallback:c().createElement(q.Spinner,null),onLoad:N(k,n),getEntities:function(){var e=(0,r.Z)(i().mark((function e(t,a){var n,r,s,l,o,c,u,d,m,f,p,g,v,b,h;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.page,r=void 0===n?1:n,s=a.per_page,l=a.orderBy,o=a.orderDirection,c=a.filters,"All"===O?delete c.hasMatch:c=X(X({},c),{},{hasMatch:O}),u=B(l),d=R(null==u?void 0:u.sortBy,o),m=y(c),f=s,p=r*s-s,e.next=9,D(f,p,X(X({},m),{},{orderBy:d}));case 9:return g=e.sent,b=(v=g||{}).entities,h=v.meta.totalCount,e.abrupt("return",{results:b.map((function(e){return X(X({},e),{},{display_name:e.displayName})})),orderBy:l,orderDirection:o,total:h});case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),tableProps:{canSelectAll:!1,className:"sysTable",isStickyHeader:!0},noSystemsTable:c().createElement(I.Z,{className:"pf-c-card",icon:G.W1,variant:"large",title:a.formatMessage(S.Z.noResults),text:a.formatMessage(S.Z.noResultsMatch)}),customFilters:{malwareParams:X({},(0,Y.Rm)()),params:f},filterConfig:{items:[J(f,p)]},activeFiltersConfig:K(J(f,p),p)}))};ee.propTypes=$.R$;const te=ee},24101:(e,t,a)=>{"use strict";a.d(t,{_:()=>i,E:()=>o});var n,r,s=a(30168),l=a(92471),i=(0,l.Ps)(n||(n=(0,s.Z)(["mutation DisableRule ($input: DisableRuleInput = {}) {\n  disableRule(input: $input) {\n    clientMutationId\n  }\n}"]))),o=(0,l.Ps)(r||(r=(0,s.Z)(["mutation EnableRule ($input: EnableRuleInput = {}) {\n  enableRule(input: $input) {\n    clientMutationId\n  }\n}"])))},32857:()=>{},3162:()=>{},10108:()=>{},28992:()=>{},30187:()=>{},21626:()=>{},21064:()=>{},82014:()=>{},93398:()=>{},46928:()=>{},91993:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},67761:()=>{},87234:()=>{}}]);
//# sourceMappingURL=../sourcemaps/SigTable.244de5fb8b74afd45ee447412431eedd.js.map