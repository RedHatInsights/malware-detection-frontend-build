(self.webpackChunkmalware=self.webpackChunkmalware||[]).push([[982],{89837:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});var n=a(69291),l=a(45697),o=a.n(l),r=a(93264),s=a.n(r),i=function(e){var t=e.items,a=t.pop();return s().createElement(n.Breadcrumb,null,t.map((function(e,t){return s().createElement(n.BreadcrumbItem,{key:t,to:e.to},e.name)})),s().createElement(n.BreadcrumbItem,{isActive:!0},a.name))};i.propTypes={items:o().array};const c=i},2087:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p});var n=a(99332),l=a(51957),o=a(88461),r=a(45697),s=a.n(r),i=a(93264),c=a.n(i),u=a(30893),m=a(86896);function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=function(e){return"".concat(1==="".concat(e).length?"0":"").concat(e)},a=new Date(e);if(a instanceof Date&&!isNaN(a)){var n=a.getFullYear(),l=a.getMonth()+1,o=a.getDate(),r=a.getUTCHours(),s=a.getUTCMinutes(),i=a.getUTCSeconds();return"".concat(n,"-").concat(t(l),"-").concat(t(o),"_").concat(t(r),"-").concat(t(s),"-").concat(t(i),"-UTC")}return a}a(18446);var f=function(e){var t=e.code,a=e.language,r=e.isReadOnly,s=e.isDownloadEnabled,i=e.isCopyEnabled,f=e.height,p=void 0===f?"400px":f,g=(0,m.Z)();return c().createElement(o.p,{isDownloadEnabled:s,downloadFileName:"malware-detection_signature--".concat(d(Date.now())),isCopyEnabled:i,isReadOnly:r,isLanguageLabelVisible:a,code:t,language:a,emptyState:c().createElement(l.Z,{className:"",icon:n.mB,variant:"small",title:g.formatMessage(u.Z.sigCompiled),text:g.formatMessage(u.Z.sigCompiledBody)}),height:p})};f.propTypes={code:s().any,language:s().string,isReadOnly:s().bool,isCopyEnabled:s().bool,isDownloadEnabled:s().bool,height:s().string},f.defaultProps={codeType:"Code"};const p=f},51957:(e,t,a)=>{"use strict";a.d(t,{Z:()=>f});var n=a(9947),l=a(38424),o=a(75106),r=a(76473),s=a(45697),i=a.n(s),c=a(93264),u=a.n(c),m=a(60485),d=function(e){var t=e.className,a=e.children,r=e.icon,s=e.iconClass,i=e.iconStyle,c=e.text,d=e.title,f=e.variant;return u().createElement(n.u,{className:t,variant:f},"none"!==r&&u().createElement(l.k,{className:s,style:i,icon:r}),u().createElement(m.D,{headingLevel:"h5",size:"lg"},d),u().createElement(o.B,{style:{marginBottom:"16px"}},c),a)};d.propTypes={children:i().any,icon:i().any,iconClass:i().any,iconStyle:i().any,text:i().any,title:i().string,variant:i().any,className:i().string},d.defaultProps={icon:r.ZP,title:"",variant:n.I.full};const f=d},42946:(e,t,a)=>{"use strict";a.d(t,{Z:()=>y});var n=a(93264),l=a.n(n),o=a(34348),r=a(6202),s=a(219),i=a(86728),c=a(74183),u=a(5913),m=a(86896),d=a(30893),f=a(45697),p=a.n(f),g=a(82779),v=function(e){var t=e.message,a=e.className,n=(0,m.Z)();return l().createElement(s.ub,{className:a,variant:"large"},l().createElement(i.k,{icon:u.ZP}),l().createElement(o.Title,{headingLevel:"h4",size:"lg"},n.formatMessage(d.Z.emptyAccountTitle)),l().createElement(c.B,null,t),l().createElement(r.Button,{variant:"primary",component:"a",href:g.ie,target:"_blank"},n.formatMessage(d.Z.emptyAccountButton)))};v.propTypes={message:p().string,className:p().string};const y=v},53830:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>fe});var n=a(70885),l=a(22910),o=a(96823),r=a(80765),s=a(49287),i=a(18038),c=a(23218),u=a(19535),m=a(50470),d=a(84564),f=a(60485),p=a(89837),g=a(62410),v=a(84580),y=a(24101),E=a(52661),b=a(14748),h=a(89376),Z=a(39173),M=a(93264),C=a.n(M),D=a(42982),w=a(4942),N=a(44733),S=a(68868),P=a(62480),A=a(7732),T=a(1082),B=a(86379),x=a(22546),O=a(3351),k=a(6934),F=a(22860),L=a(65550),R=a(68778),V=a(2087),_=a(82779),H=a(51957),I=a(3962),G=a(80810),j=a(30893),U=a(45697),W=a.n(U),z=a(86896),$=a(90570),q=a(42946),Q=a(92397),Y=a(80710),J=a(96486);function K(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function X(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?K(Object(a),!0).forEach((function(t){(0,w.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):K(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ee={1:"DISPLAY_NAME",2:"GROUP_NAME",3:"OS_VERSION",4:"LAST_SCAN_DATE",5:"MATCH_COUNT"},te=function(e){var t=e.index,a=e.direction;return"".concat(ee[t],"_").concat(a===S.B.asc?"ASC":"DESC")},ae=function(e,t){switch(t.type){case"setTableVars":return X(X({},e),{},{tableVars:X(X({},e.tableVars),t.payload)});case"setSortBy":return X(X({},e),{},{sortBy:t.payload,tableVars:X(X({},e.tableVars),t.tableVars)});case"setRows":return X(X({},e),{},{rows:t.payload});case"setGroups":return X(X({},e),{},{groups:t.payload})}return e},ne=function(e){var t,a,l,o,r,s,i,c,u=e.ruleName,m=e.affectedCount,d=e.isEmptyAccount,f=(0,z.Z)(),p={tableVars:{limit:10,offset:0,orderBy:"LAST_SCAN_DATE_DESC",displayName:"",hostGroupFilter:void 0,ruleName:u},sortBy:{index:4,direction:S.B.desc},rows:[],groups:[]},y=(0,M.useReducer)(ae,X({},p)),E=(0,n.Z)(y,2),b=E[0],h=b.tableVars,Z=b.sortBy,w=b.rows,U=b.groups,W=E[1],K=(0,$.a)(v.I8,{variables:h}),ee=K.data,ne=K.loading,le=K.error,oe=(0,$.a)(v.Fl,{variables:h}),re=oe.data,se=oe.loading,ie=[{title:f.formatMessage(j.Z.name),cellFormatters:[P.zW],transforms:[A.p,(0,T.d)(45)]},{title:f.formatMessage(j.Z.group),transforms:[A.p,(0,T.d)(15)]},{title:f.formatMessage(j.Z.os),key:"osVersion",transforms:[A.p,(0,T.d)(10)]},{title:f.formatMessage(j.Z.lastMatched),transforms:[A.p,(0,T.d)(10)]},{title:f.formatMessage(j.Z.totalMatches),transforms:[(0,B.u)({tooltip:f.formatMessage(j.Z.totalMatchesNote)}),A.p,(0,T.d)(10)]}],ce=h.offset/h.limit+1,ue=[{label:f.formatMessage(j.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return W({type:"setTableVars",payload:{displayName:t,offset:0}})},value:h.displayName,placeholder:f.formatMessage(j.Z.filterBy,{field:f.formatMessage(j.Z.name).toLowerCase()})}},{label:f.formatMessage(j.Z.group).toLowerCase(),type:(0,J.isEmpty)(U)?"group":"checkbox",filterValues:{key:"group-filter",onChange:function(e,t){W({type:"setTableVars",payload:{hostGroupFilter:t},offset:0})},items:se?[]:(0,J.isEmpty)(U)?[{isDisabled:!0,label:f.formatMessage(j.Z.noGroups)}]:U,value:h.hostGroupFilter,placeholder:f.formatMessage(j.Z.filterBy,{field:f.formatMessage(j.Z.group).toLowerCase()})}}],me=function(e,t){return W({type:"setTableVars",payload:{offset:t*h.limit-h.limit}})},de=function(e,t){return W({type:"setTableVars",payload:{limit:t,offset:0}})};(0,M.useEffect)((function(){var e;W({type:"setRows",payload:function(e){return null==e?void 0:e.flatMap((function(e,t){var a,n,l,o=e;return[{rowId:t,isOpen:!1,cells:[{title:C().createElement(Q.Z,{to:"/systems/".concat(o.id)},o.displayName)},{title:"".concat((null===(a=o.groups)||void 0===a||null===(n=a[0])||void 0===n?void 0:n.name)||f.formatMessage(j.Z.notApplicable))},{title:o.osVersion?"RHEL ".concat(o.osVersion):f.formatMessage(j.Z.dataNotAvailable)},{title:C().createElement(g.Z,{date:new Date(o.matches[o.matches.length-1].scanDate),type:"onlyDate"})},{title:C().createElement(Q.Z,{to:"/systems/".concat(o.id)},null===(l=o.matchCount)||void 0===l?void 0:l.toLocaleString())}]},{parent:2*t,hostData:o,fullWidth:!0,cells:[]}]}))}(null==ee||null===(e=ee.rulesList[0])||void 0===e?void 0:e.affectedHostsList)})}),[f,ee]),(0,M.useEffect)((function(){var e,t=function(e){return null==e?void 0:e.filter((function(e){return!(0,J.isEmpty)(e.groups)})).map((function(e){return{label:e.groups[0].name,value:e.groups[0].name}}))}(null==re||null===(e=re.rulesList[0])||void 0===e?void 0:e.affectedHostsList)||[];t=(0,J.uniqWith)(t,(function(e,t){return e.label===t.label})),W({type:"setGroups",payload:t})}),[re]);var fe,pe=C().createElement(H.Z,{className:"pf-c-card",icon:G.W1,variant:"large",title:f.formatMessage(j.Z.noResults),text:f.formatMessage(j.Z.noResultsMatch)}),ge=C().createElement(H.Z,{className:"pf-c-card",variant:"large",icon:R.ZP,iconClass:"ins-l-success-color",title:f.formatMessage(j.Z.noAffectedHosts),text:f.formatMessage(j.Z.noAffectedHostsBody)}),ve=C().createElement(q.Z,{className:"pf-c-card",message:f.formatMessage(j.Z.emptyAccountTableBody)}),ye=C().createElement(H.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),Ee={deleteTitle:f.formatMessage(j.Z.resetFilters),filters:(fe=[],(null==h?void 0:h.displayName)&&fe.push({category:f.formatMessage(j.Z.name),value:"name",chips:[{name:null==h?void 0:h.displayName,value:null==h?void 0:h.displayName}]}),(null==h?void 0:h.hostGroupFilter)&&fe.push({category:f.formatMessage(j.Z.group),value:"groups",chips:h.hostGroupFilter.map((function(e){return{name:e,value:e}}))}),fe),showDeleteButton:""!==(null==h?void 0:h.displayName)||void 0!==(null==h?void 0:h.hostGroupFilter),onDelete:function(e,t,a){a?W({type:"setTableVars",payload:{displayName:"",hostGroupFilter:void 0,offset:0}}):t.map((function(e){if("name"===e.value&&W({type:"setTableVars",payload:{displayName:""}}),"groups"===e.value){var t=h.hostGroupFilter.filter((function(t){return t!==e.chips[0].name})),a={hostGroupFilter:t.length?t:void 0,offset:0};W({type:"setTableVars",payload:a})}}))}};return C().createElement(C().Fragment,null,C().createElement(I.Z,{pagination:{itemCount:(null==ee||null===(t=ee.rulesList[0])||void 0===t||null===(a=t.affectedHosts)||void 0===a?void 0:a.totalCount)||0,page:ce,perPage:h.limit,onSetPage:function(e,t){me(0,t)},onPerPageSelect:function(e,t){de(0,t)},isCompact:!0},filterConfig:{items:ue},activeFiltersConfig:Ee}),ne?C().createElement(Y.Z,{columns:[{title:"",columnTransforms:[(0,x.A)("skeleton-expandable-column")]}].concat(ie),rowSize:h.limit,sortBy:Z}):C().createElement(O.i,{className:"sigTable","aria-label":"Signature Details table",rows:w,cells:ie,onCollapse:function(e,t,a){var n=(0,D.Z)(w),l=n[t+1].hostData;n[t]=X(X({},n[t]),{},{isOpen:a}),n[t+1].cells=[{title:C().createElement(V.Z,{height:"250px",code:"".concat(l.matches.map((function(e,t){return"Match Source: ".concat(e.source,"\nOffset:").concat(e.stringOffset,"\nMatch Data: ").concat(e.stringData,"\nMatch Identifier: ").concat(e.stringIdentifier,"\nMatch Scan Date: ").concat(new Date(e.scanDate).toUTCString(),"\n").concat(e.metadata?(0,_.Wi)(JSON.parse(e.metadata)):"","\n").concat(l.matches.length>1&&t!==l.matches.length-1?"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n":"")})).join("")),isDownloadEnabled:!0,isCopyEnabled:!0})}],W({type:"setRows",payload:n})},onSort:function(e,t,a){return W({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:te({index:t,direction:a}),offset:0}})},sortBy:(null==ee||null===(l=ee.rulesList[0])||void 0===l||null===(o=l.affectedHosts)||void 0===o?void 0:o.totalCount)>0?Z:void 0,isStickyHeader:!0},C().createElement(k.x,null),C().createElement(F.R,null)),le||ne||0===m?!ne&&(d?ve:ge):0===(null==ee||null===(r=ee.rulesList[0])||void 0===r||null===(s=r.affectedHosts)||void 0===s?void 0:s.totalCount)?pe:C().createElement(C().Fragment,null),le&&C().createElement(ye,null),C().createElement(L.Z,{isFooter:!0},C().createElement(N.t,{itemCount:(null==ee||null===(i=ee.rulesList[0])||void 0===i||null===(c=i.affectedHosts)||void 0===c?void 0:c.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:h.limit,page:ce,variant:N.a.bottom,onSetPage:me,onPerPageSelect:de})))};ne.propTypes={ruleName:W().string,affectedCount:W().number,isEmptyAccount:W().bool};const le=ne;var oe=a(62012),re=a(75709),se=a(55140),ie=a(69957),ce=a(47173),ue=a(28216),me=a(71355),de=a(43707);const fe=function(){var e,t,a,D=(0,z.Z)(),w=(0,ue.useDispatch)(),N=(0,de.TE)("malware-detection",_.aQ.write).hasAccess,S=(0,oe.useParams)().id,P=[{name:D.formatMessage(j.Z.malwareDetectionSignatures),to:"".concat((0,_.hN)(),"/insights/malware")},{name:S,to:"#"}],A={query:v.c3,variables:{ruleName:S}},T=(0,$.a)(A.query,{variables:A.variables}),B=T.data,x=T.loading,O=null==B?void 0:B.rulesList[0],k=null==O?void 0:O.metadata,F=(null==O||null===(e=O.affectedHosts)||void 0===e?void 0:e.totalCount)>0,L=null==O?void 0:O.isDisabled,R=(null==k?void 0:k.references)||[],V=(null==k?void 0:k.xfti_references)||[],I=D.formatMessage(j.Z.dataNotAvailable),G=(0,se.Z)(),U=(0,M.useState)(!1),W=(0,n.Z)(U,2),q=W[0],Q=W[1],Y=(0,M.useState)(!1),J=(0,n.Z)(Y,2),K=J[0],X=J[1],ee={variables:{input:{id:null==O?void 0:O.id}},refetchQueries:[A],onCompleted:function(){Q(!1),X(!1)},onError:function(e){var t=e.networkError;Q(!1),X(!0);var a="".concat(t.response.statusText," - ").concat(t.bodyText);!function(e){w((0,me.addNotification)(e))}({variant:"danger",dismissable:!0,title:D.formatMessage(j.Z.error),description:"".concat(a)})}},te=(0,re.D)(y.E,ee),ae=(0,n.Z)(te,2),ne=ae[0],fe=ae[1].loading,pe=(0,re.D)(y._,ee),ge=(0,n.Z)(pe,2),ve=ge[0],ye=ge[1].loading,Ee=function(e,t){return C().createElement(C().Fragment,null,C().createElement("p",{className:"ins-l-detailBlockHeader"},e),C().createElement("p",null,t||I))},be=function(e,t){return C().createElement("a",{className:"ins-l-referenceLink",rel:"noopener noreferrer",target:"_blank",href:e},t," ",C().createElement(m.ZP,null))};(0,M.useEffect)((function(){G.updateDocumentTitle("".concat(S," - Signatures - Malware | Red Hat Insights"))}),[G,S]),(0,M.useEffect)((function(){X(!0)}),[B]);var he,Ze,Me,Ce,De=C().createElement(H.Z,{variant:"large",icon:ie.ZP,iconClass:"ins-l-custom-color",title:D.formatMessage(j.Z.disabledFromAnalysis),text:D.formatMessage(j.Z.disabledFromAnalysisBody,{disabledBy:(null==O?void 0:O.disabledBy)||"Unknown",disabledAt:C().createElement(g.Z,{date:(null==O?void 0:O.disabledAt)||new Date,type:"onlyDate"})})},N&&C().createElement(ce.zx,{variant:"primary",isLoading:fe,onClick:function(){return ne(ee)}},D.formatMessage(fe?j.Z.enablingSignature:j.Z.enableSignatureForAnalysis))),we=C().createElement(l.L,{ouiaId:"actions",toggle:C().createElement(r.Z,{onToggle:function(){return Q(!q)},isExpanded:q},D.formatMessage(j.Z.actions)),isOpen:q,dropdownItems:L?[C().createElement(o.h,{key:"action",ouiaId:"enable",onClick:function(){ne(ee),X(!1)}},D.formatMessage(fe?j.Z.enablingSignature:j.Z.enableSignatureForAnalysis))]:[C().createElement(o.h,{key:"action",ouiaId:"disable",onClick:function(){ve(ee),X(!1)}},D.formatMessage(ye?j.Z.disablingSignature:j.Z.disableSignatureFromAnalysis))],style:{paddingBottom:0}});return C().createElement(C().Fragment,null,C().createElement(h.Z,null,C().createElement(p.Z,{items:P}),C().createElement(s.r,{hasGutter:!0},C().createElement(i.P,{md:9,sm:9},C().createElement(Z.Z,{title:C().createElement("span",null,S," ",(null==k?void 0:k.threat_type)&&C().createElement(c._,{variant:"outline",color:"blue"},k.threat_type)," ",(L||F)&&C().createElement(c._,{variant:"filled",color:"red"},L?"Disabled":"Matched"))})),N&&C().createElement(i.P,{md:3,sm:3},we),x?C().createElement(E.Z,null):C().createElement(i.P,null,C().createElement(s.r,{hasGutter:!0},C().createElement(i.P,{xl2:7,md:8,sm:12},C().createElement("p",{className:"ins-l-detailBlockHeader"},D.formatMessage(j.Z.description)),C().createElement(u.Z,{text:null==k?void 0:k.description,length:200,inline:!0})),C().createElement(i.P,{xl2:5,md:4,sm:12},Ee(D.formatMessage(j.Z.matchedSystems),L?D.formatMessage(j.Z.notApplicable):F?C().createElement(C().Fragment,null,C().createElement(d.ZP,{color:"var(--pf-global--danger-color--100)"})," ",C().createElement("span",{style:{color:"var(--pf-global--danger-color--200)",fontWeight:"bold"}},"".concat(null==O||null===(he=O.affectedHosts)||void 0===he?void 0:he.totalCount,"/").concat(null==B||null===(Ze=B.hosts)||void 0===Ze?void 0:Ze.totalCount))):C().createElement("span",null,"".concat(null==O||null===(Me=O.affectedHosts)||void 0===Me?void 0:Me.totalCount,"/").concat(null==B||null===(Ce=B.hosts)||void 0===Ce?void 0:Ce.totalCount)))),C().createElement(i.P,{lg:2,md:3,sm:12},Ee(D.formatMessage(j.Z.ruleCategory),null==k?void 0:k.rule_category)),C().createElement(i.P,{xl2:5,lg:6,md:5,sm:12},Ee(D.formatMessage(j.Z.ruleIntendedUsage),null==k?void 0:k.usage)),C().createElement(i.P,{xl2:5,md:4,sm:12},Ee(D.formatMessage(j.Z.lastmatch),L?D.formatMessage(j.Z.notApplicable):null!=O&&O.lastMatchDate?C().createElement(g.Z,{date:new Date(O.lastMatchDate),type:"onlyDate"}):D.formatMessage(j.Z.never))),C().createElement(i.P,{xl2:7,md:8,sm:12},Ee(D.formatMessage(j.Z.author),null==k?void 0:k.author)),(R.length>0||V.length>0)&&C().createElement(i.P,{xl2:7,md:8,sm:12},1===V.length?be(V[0],D.formatMessage(j.Z.ruleAuthorReference)):V.map((function(e,t){return be(e,"".concat(D.formatMessage(j.Z.ruleAuthorReference)," [").concat(t+1,"] "))})),1===R.length?be(R[0],D.formatMessage(j.Z.ruleBackgroundReference)):R.map((function(e,t){return be(e,"".concat(D.formatMessage(j.Z.ruleBackgroundReference)," [").concat(t+1,"] "))}))))))),C().createElement(b.ZP,null,K?L?De:C().createElement(C().Fragment,null,C().createElement(f.D,{className:"ins-l-tableBlockHeader",headingLevel:"h2"},D.formatMessage(j.Z.affectedHosts)),C().createElement(le,{ruleName:S,isEmptyAccount:0===(null==B||null===(t=B.hosts)||void 0===t?void 0:t.totalCount),affectedCount:null==O||null===(a=O.affectedHosts)||void 0===a?void 0:a.totalCount})):C().createElement(E.Z,null)))}},24101:(e,t,a)=>{"use strict";a.d(t,{E:()=>i,_:()=>s});var n,l,o=a(30168),r=a(92471),s=(0,r.Ps)(n||(n=(0,o.Z)(["mutation DisableRule ($input: DisableRuleInput = {}) {\n  disableRule(input: $input) {\n    clientMutationId\n  }\n}"]))),i=(0,r.Ps)(l||(l=(0,o.Z)(["mutation EnableRule ($input: EnableRuleInput = {}) {\n  enableRule(input: $input) {\n    clientMutationId\n  }\n}"])))},65088:()=>{},11452:()=>{},58392:()=>{},34946:()=>{},32857:()=>{},3162:()=>{},28992:()=>{},30187:()=>{},21626:()=>{},21064:()=>{},82014:()=>{},93398:()=>{},46928:()=>{},91993:()=>{},66822:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},67761:()=>{},87234:()=>{},72816:()=>{},75347:()=>{},31777:()=>{},34017:()=>{},59905:()=>{},64604:()=>{}}]);
//# sourceMappingURL=../sourcemaps/Signature Details.d77e7aea58200573522e96d01025e3ee.js.map