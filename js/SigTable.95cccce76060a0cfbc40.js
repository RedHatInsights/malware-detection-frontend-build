(self.webpackChunkmalware=self.webpackChunkmalware||[]).push([[207],{69174:(e,t,a)=>{"use strict";a.d(t,{_:()=>p});var s=a(65353),l=a(28416),r=a(83063),n=a(10483),o=a(46796),i=a(75824),c=a(38296),u=a(24307),m=a(6551);const d={blue:r.Z.modifiers.blue,cyan:r.Z.modifiers.cyan,green:r.Z.modifiers.green,orange:r.Z.modifiers.orange,purple:r.Z.modifiers.purple,red:r.Z.modifiers.red,gold:r.Z.modifiers.gold,grey:""},p=e=>{var{children:t,className:a="",color:p="grey",variant:f="filled",isCompact:g=!1,isEditable:b=!1,editableProps:y,textMaxWidth:v,tooltipPosition:h,icon:E,onClose:M,onClick:Z,onEditCancel:S,onEditComplete:C,closeBtn:_,closeBtnAriaLabel:D,closeBtnProps:w,href:x,isOverflowLabel:N,render:A}=e,k=(0,s.__rest)(e,["children","className","color","variant","isCompact","isEditable","editableProps","textMaxWidth","tooltipPosition","icon","onClose","onClick","onEditCancel","onEditComplete","closeBtn","closeBtnAriaLabel","closeBtnProps","href","isOverflowLabel","render"]);const[T,O]=(0,l.useState)(!1),[P,R]=(0,l.useState)(t),F=l.useRef(),L=l.useRef();l.useEffect((()=>(document.addEventListener("mousedown",j),document.addEventListener("keydown",I),()=>{document.removeEventListener("mousedown",j),document.removeEventListener("keydown",I)}))),l.useEffect((()=>{Z&&x?console.warn("Link labels cannot have onClick passed, this results in invalid HTML. Please remove either the href or onClick prop."):Z&&b&&console.warn("Editable labels cannot have onClick passed, clicking starts the label edit process. Please remove either the isEditable or onClick prop.")}),[Z,x,b]);const j=e=>{T&&L&&L.current&&!L.current.contains(e.target)&&(L.current.value&&C&&C(e,L.current.value),O(!1))},I=e=>{var a,s;const l=e.key;if((T||F&&F.current&&F.current.contains(e.target))&&(!T||L&&L.current&&L.current.contains(e.target))&&(!T||"Enter"!==l&&"Tab"!==l||(e.preventDefault(),e.stopImmediatePropagation(),L.current.value&&C&&C(e,L.current.value),O(!1),null===(a=null==F?void 0:F.current)||void 0===a||a.focus()),T&&"Escape"===l&&(e.preventDefault(),e.stopImmediatePropagation(),L.current.value&&(L.current.value=t,S&&S(e,t)),O(!1),null===(s=null==F?void 0:F.current)||void 0===s||s.focus()),!T&&"Enter"===l)){e.preventDefault(),e.stopImmediatePropagation(),O(!0);const t=e.target,a=document.createRange(),s=window.getSelection();a.selectNodeContents(t),a.collapse(!1),s.removeAllRanges(),s.addRange(a)}},B=N?"button":"span",G=l.createElement(o.zx,Object.assign({type:"button",variant:"plain",onClick:M,"aria-label":D||`Close ${t}`},w),l.createElement(u.ZP,null)),V=l.createElement("span",{className:(0,c.css)(r.Z.labelActions)},_||G),$=l.createRef(),H=l.useRef(),[W,q]=l.useState(!1);(0,m.L)((()=>{const e=b?F:$;T||q(e.current&&e.current.offsetWidth<e.current.scrollWidth)}),[T]);const U=l.createElement(l.Fragment,null,E&&l.createElement("span",{className:(0,c.css)(r.Z.labelIcon)},E),l.createElement("span",Object.assign({ref:$,className:(0,c.css)(r.Z.labelText)},v&&{style:{"--pf-v5-c-label__text--MaxWidth":v}}),t));l.useEffect((()=>{T&&L&&L.current&&L.current.focus()}),[L,T]);let Y="span";x?Y="a":(b||Z&&!N)&&(Y="button");const z={type:"button",onClick:Z},J="button"===Y,K=Object.assign(Object.assign(Object.assign(Object.assign({className:(0,c.css)(r.Z.labelContent)},W&&{tabIndex:0}),x&&{href:x}),J&&z),b&&Object.assign({ref:F,onClick:e=>{O(!0),e.stopPropagation()}},y));let Q=l.createElement(Y,Object.assign({},K),U);return A?Q=l.createElement(l.Fragment,null,W&&l.createElement(i.u,{triggerRef:H,content:t,position:h}),A({className:r.Z.labelContent,content:U,componentRef:H})):W&&(Q=l.createElement(i.u,{content:t,position:h},Q)),l.createElement(B,Object.assign({},k,{className:(0,c.css)(r.Z.label,d[p],"outline"===f&&r.Z.modifiers.outline,N&&r.Z.modifiers.overflow,g&&r.Z.modifiers.compact,b&&n.Z.modifiers.editable,T&&r.Z.modifiers.editableActive,a),onClick:N?Z:void 0}),!T&&Q,!T&&M&&V,T&&l.createElement("input",Object.assign({className:(0,c.css)(r.Z.labelContent),type:"text",id:"editable-input",ref:L,value:P,onChange:()=>{R(L.current.value)}},y)))};p.displayName="Label"},10483:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s}),a(24620);const s={button:"pf-v5-c-button",labelGroup:"pf-v5-c-label-group",labelGroupClose:"pf-v5-c-label-group__close",labelGroupLabel:"pf-v5-c-label-group__label",labelGroupList:"pf-v5-c-label-group__list",labelGroupListItem:"pf-v5-c-label-group__list-item",labelGroupMain:"pf-v5-c-label-group__main",labelGroupTextarea:"pf-v5-c-label-group__textarea",modifiers:{category:"pf-m-category",vertical:"pf-m-vertical",editable:"pf-m-editable",textarea:"pf-m-textarea"}}},83063:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s}),a(82014);const s={button:"pf-v5-c-button",label:"pf-v5-c-label",labelActions:"pf-v5-c-label__actions",labelContent:"pf-v5-c-label__content",labelIcon:"pf-v5-c-label__icon",labelText:"pf-v5-c-label__text",modifiers:{compact:"pf-m-compact",blue:"pf-m-blue",green:"pf-m-green",orange:"pf-m-orange",red:"pf-m-red",purple:"pf-m-purple",cyan:"pf-m-cyan",gold:"pf-m-gold",outline:"pf-m-outline",overflow:"pf-m-overflow",add:"pf-m-add",editable:"pf-m-editable",editableActive:"pf-m-editable-active"},themeDark:"pf-v5-theme-dark"}},54195:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Y});var s=a(55573),l=a(28416),r=a.n(l),n=a(38800),o=a(5756),i=a(7732),c=a(1082),u=a(43416),m=a(49004),d=a(58027),p=a(15433),f=a(33203),g=a(62410),b=a(51364),y=a(66338),v=a(41841),h=a(10097),E=a(4036),M=a(86197),Z=a(75824),S=a(69174),C=a(2550),_=a(21593),D=a(86896),w=a(71641),x=a(50319),N=a(99564),A=a(20864),k=a(50693),T=a(16475),O=a(45697),P=a.n(O),R=a(95499);const F=({signature:e})=>{const t=(0,D.Z)(),[a]=(0,l.useState)(!1);return r().createElement(k.r,{hasGutter:!0},a&&r().createElement(T.P,{span:6},r().createElement(A.Z,{code:e.rawRule,isReadOnly:!0})),r().createElement(T.P,{span:a?6:12}," ",r().createElement(R.Text,{className:"ins-l-sigtable--title",component:R.TextVariants.h6},t.formatMessage(C.Z.description)),e.metadata.description))};F.propTypes={signature:P().object};const L=F;var j=a(92397),I=a(71355),B=a(65422),G=a(43707),V=a(12913);const $={tableVars:{limit:10,offset:0,orderBy:["LAST_MATCH_DATE_NULLS_LAST_DESC","NAME_ASC"],ruleName:""},sortBy:{index:5,direction:n.B.desc},rows:[],selectedSigs:[]},H={2:"NAME",3:"HAS_MATCH",4:"HOST_COUNT",5:"LAST_MATCH_DATE_NULLS_LAST"},W=({index:e,direction:t})=>{const a=`${H[e]}_${t===n.B.asc?"ASC":"DESC"}`;return"NAME"!==H[e]?[a,"NAME_ASC"]:a},q=(e,t)=>{switch(t.type){case"setTableVars":return{...e,tableVars:{...e.tableVars,...t.payload}};case"setSortBy":return{...e,sortBy:t.payload,tableVars:{...e.tableVars,...t.tableVars}};case"setRows":return{...e,rows:t.payload};case"setSelectedSigs":return{...e,selectedSigs:t.payload}}return e},U=({refetchSigPageData:e})=>{const t=(0,D.Z)(),a=(0,B.I0)(),n=(0,G.TE)("malware-detection",f.aQ.write).hasAccess,[{tableVars:A,sortBy:k,rows:T,selectedSigs:O},P]=(0,l.useReducer)(q,{...$}),[R,F]=(0,l.useState)(!1),{data:H,loading:U,error:Y,client:z}=(0,w.a)(b.tE,{variables:{...A,...(J=_.gG,(0,N.$)(l.useCallback((function(e){return J.onNextChange((function t(){e(),J.onNextChange(t)}))}),[J]),J,J))}});var J;const K={variables:{input:{id:O.map((e=>e.id))}},onCompleted:()=>{F(!1),z.resetStore(),e(),P({type:"setSelectedSigs",payload:[]})},onError:({networkError:e})=>{const s=`${e.response.statusText} - ${e.bodyText}`;var l;l={variant:"danger",dismissable:!0,title:t.formatMessage(C.Z.error),description:`${s}`},a((0,I.addNotification)(l))}},[Q,{loading:X}]=(0,x.D)(y.E,K),[ee,{loading:te}]=(0,x.D)(y._,K),ae=[{title:t.formatMessage(C.Z.sigName),cellFormatters:[o.zW],transforms:[i.p,(0,c.d)(45)]},{title:t.formatMessage(C.Z.lastStatus),transforms:[(0,c.d)(10),i.p]},{title:t.formatMessage(C.Z.systems),transforms:[(0,c.d)(10),i.p]},{title:t.formatMessage(C.Z.lastMatched),transforms:[(0,c.d)(10),i.p]}],se=A.offset/A.limit+1,le={items:{hasMatch:"true",isDisabled:[]},condition:{hasMatch:!0,isDisabled:void 0}},re=(e,t)=>{const a=e.map((e=>e.sigData.id)),s=O.filter((e=>!a.includes(e.id)));return t?[...s,...e.map((e=>({id:e.sigData.id,name:e.sigData.name,isDisabled:e.sigData.isDisabled})))]:s},ne=["",{label:t.formatMessage(C.Z.enableSignaturesForAnalysis),onClick:()=>Q(K),props:{isDisabled:0===O.filter((e=>e.isDisabled)).length}},{label:t.formatMessage(C.Z.disableSignaturesFromAnalysis),onClick:()=>ee(K),props:{isDisabled:0===O.filter((e=>!e.isDisabled)).length}}],oe={sig_match:{type:"radio",title:t.formatMessage(C.Z.status),urlParam:"sig_match",values:[{label:t.formatMessage(C.Z.all),value:"all"},{label:t.formatMessage(C.Z.matched),value:"true"},{label:t.formatMessage(C.Z.notMatched),value:"false"}]},sigs_included:{type:"checkbox",title:t.formatMessage(C.Z.signaturesIncludedFilter),urlParam:"sigs_included",values:[{label:t.formatMessage(C.Z.enabledSignaturesFilter),value:"false"},{label:t.formatMessage(C.Z.disabledSignaturesFilter),value:"true"}]}},ie=[{label:oe.sigs_included.title.toLowerCase(),type:oe.sigs_included.type,id:oe.sigs_included.urlParam,filterValues:{key:`${oe.sigs_included.urlParam}-filter`,onChange:(e,t)=>{const a=(0,_.gG)();(0,_.gG)({items:{...a.items,isDisabled:t},condition:{...a.condition,isDisabled:1!==t.length?void 0:JSON.parse(t[0])}})},value:(0,_.gG)().items?.isDisabled||[],items:oe.sigs_included.values}},{label:t.formatMessage(C.Z.signature).toLowerCase(),type:"text",filterValues:{key:"text-filter",onChange:(e,t)=>P({type:"setTableVars",payload:{ruleName:t,offset:0}}),value:A.ruleName,placeholder:t.formatMessage(C.Z.filterBy,{field:t.formatMessage(C.Z.signature).toLowerCase()})}},{label:oe.sig_match.title.toLowerCase(),type:oe.sig_match.type,id:oe.sig_match.urlParam,value:`radio-${oe.sig_match.urlParam}`,filterValues:{key:`${oe.sig_match.urlParam}-filter`,onChange:(e,t)=>{const a=(0,_.gG)();(0,_.gG)({items:{...a.items,hasMatch:t},condition:{...a.condition,hasMatch:"all"===t?void 0:JSON.parse(t)}})},value:(0,_.gG)().items?.hasMatch||"true",items:oe.sig_match.values}}],ce=(e,t)=>P({type:"setTableVars",payload:{offset:t*A.limit-A.limit}}),ue=(e,t)=>P({type:"setTableVars",payload:{limit:t,offset:0}}),me=({event:e,chips:a=[]})=>{const s=(0,_.gG)();if("add"===e){let e=t.formatMessage(C.Z.all);"true"===s.items?.hasMatch?e=t.formatMessage(C.Z.matched):"false"===s.items?.hasMatch&&(e=t.formatMessage(C.Z.notMatched)),a.push({category:t.formatMessage(C.Z.status),value:"matched",chips:[{name:e,value:e}]})}else if("remove"===e){const[e,t]="all"===s.items?.hasMatch?["true",!0]:["all",void 0];(0,_.gG)({items:{...s.items,hasMatch:e},condition:{...s.condition,hasMatch:t}})}},de=({event:e,chips:a=[],item:s=""})=>{const l=(0,_.gG)();if("add"===e){const e=[];l.items?.isDisabled.map((a=>{const s=t.formatMessage("true"===a?C.Z.disabledSignaturesFilter:C.Z.enabledSignaturesFilter);e.push({name:s,value:s})})),a.push({category:t.formatMessage(C.Z.signaturesIncludedFilter),chips:e})}else if("remove"===e){let[e,a]=[[],void 0];1!==l.items?.isDisabled.length&&([e,a]=s.value===t.formatMessage(C.Z.enabledSignaturesFilter)?[["true"],!0]:[["false"],!1]),(0,_.gG)({items:{...l.items,isDisabled:e},condition:{...l.condition,isDisabled:a}})}},pe={deleteTitle:t.formatMessage(C.Z.resetFilters),filters:(()=>{const e=[];return A?.ruleName&&e.push({category:t.formatMessage(C.Z.signature),value:"name",chips:[{name:A?.ruleName,value:A?.ruleName}]}),me({event:"add",chips:e}),de({event:"add",chips:e}),e})(),showDeleteButton:!0,onDelete:(e,t,a)=>{a?((0,_.gG)(le),P({type:"setTableVars",payload:{ruleName:""}})):t.map((e=>{"name"===e.value&&P({type:"setTableVars",payload:{ruleName:""}}),"matched"===e.value&&me({event:"remove"}),"name"!==e.value&&"matched"!==e.value&&de({event:"remove",item:e})}))}};return(0,l.useEffect)((()=>{(0,_.gG)(le)}),[]),(0,l.useEffect)((()=>{P({type:"setTableVars",payload:{offset:0}})}),[(0,_.gG)().condition]),(0,l.useEffect)((()=>{const e=O.map((e=>e.id));var a;P({type:"setRows",payload:(a=H,a?.rulesList?.flatMap(((a,s)=>{const l=a;return[{rowId:s,isOpen:!1,sigData:l,selected:e.includes(l.id),cells:[{title:r().createElement(r().Fragment,null,r().createElement(j.Z,{to:`/signatures/${l.name}`},l.name),l.isDisabled&&r().createElement(r().Fragment,null,r().createElement("br",null),r().createElement(S._,{color:"red",isCompact:!0},t.formatMessage(C.Z.disabled))))},{title:l.isDisabled?t.formatMessage(C.Z.notApplicable):r().createElement(M.Z,{isDisabled:l.isDisabled,hasMatch:l.hasMatch,displayMatch:!0})},{title:l.isDisabled?t.formatMessage(C.Z.notApplicable):r().createElement(j.Z,{to:`/signatures/${l.name}`},l.hostCount?.toLocaleString())},{title:l.isDisabled?t.formatMessage(C.Z.notApplicable):l.lastMatchDate?r().createElement(Z.u,{content:r().createElement(g.Z,{date:new Date(l.lastMatchDate),type:"exact"})},r().createElement("span",null,r().createElement(g.Z,{date:new Date(l.lastMatchDate)}))):r().createElement(Z.u,{content:t.formatMessage(C.Z.noHostHas)},r().createElement("span",null,t.formatMessage(C.Z.never)))}]},{parent:2*s,fullWidth:!0,cells:[]}]})))}),F(!0)}),[t,H]),r().createElement(r().Fragment,null,r().createElement(h.Z,{pagination:{itemCount:H?.rules?.totalCount||0,page:se,perPage:A.limit,onSetPage(e,t){ce(0,t)},onPerPageSelect(e,t){ue(0,t)},isCompact:!0},filterConfig:{items:ie},activeFiltersConfig:pe,actionsConfig:n&&{actions:ne,dropdownProps:{ouiaId:"toolbar-actions"}}}),X||te||!R?r().createElement(V.Z,{rows:A.limit,columns:ae.map((e=>e.title))}):r().createElement(u.i,{className:"sigTable","aria-label":"Signature table",onCollapse:(e,t,a)=>{const s=[...T],l=s[t].sigData;s[t]={...s[t],isOpen:a},s[t+1].cells=[{title:r().createElement(L,{signature:l})}],P({type:"setRows",payload:s})},rows:T,cells:ae,onSort:(e,t,a)=>P({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:W({index:t,direction:a}),offset:0}}),sortBy:H?.rulesList?.length>0?k:void 0,isStickyHeader:!0,canSelectAll:n,onSelect:n&&((e,t,a)=>{let s,l=[...T];-1===a?(l=l.map(((e,a)=>a%2==0?{...e,selected:t}:{...e})),s=re(l.filter(((e,t)=>t%2==0)),t)):(l[a]={...l[a],selected:t},s=re([l[a]],t)),P({type:"setRows",payload:l}),P({type:"setSelectedSigs",payload:s})}),actionResolver:n&&((e,{rowIndex:a})=>{const s=T[a].sigData||null;if(s){const e={...K,variables:{input:{id:s.id}}};return s.isDisabled?[{title:t.formatMessage(C.Z.enableSignatureForAnalysis),onClick:()=>Q(e)}]:[{title:t.formatMessage(C.Z.disableSignatureFromAnalysis),onClick:()=>ee(e)}]}})},r().createElement(m.x,null),r().createElement(d.R,null)),!U&&!Y&&0===H?.rules?.totalCount&&r().createElement(v.Z,{className:"pf-c-card",icon:E.SearchIcon,variant:"large",title:t.formatMessage(C.Z.noResults),text:t.formatMessage(C.Z.noResultsMatch)}),Y&&r().createElement(v.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),r().createElement(p.Z,{isFooter:!0},r().createElement(s.t,{itemCount:H?.rules?.totalCount||0,widgetId:"pagination-options-menu-bottom",perPage:A.limit,page:se,variant:s.a.bottom,onSetPage:ce,onPerPageSelect:ue})))};U.propTypes=f.R$;const Y=U},87709:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>le});var s=a(28416),l=a.n(s),r=a(66252),n=a(96486),o=a(82614),i=a(19548),c=a(92223),u=a(1082),m=a(86379),d=a(2550),p=a(86197),f=a(75824),g=a(62410),b=a(92397);const y=(0,o.Sn)(),v=navigator.language.slice(0,2),h=(0,i.d)({locale:v},y),E=(e,t)=>({INVENTORY_ACTION_TYPES:a,mergeWithEntities:s})=>t().register({...s((0,c.zw)(a,e),{page:1,perPage:10,sortBy:{key:"totalMatches",direction:"desc"}})}),M=[{title:h.formatMessage(d.Z.name),transforms:[(0,u.d)(30)],key:"displayName",sortBy:["DISPLAY_NAME"],renderFunc:(e,t)=>l().createElement(b.Z,{to:`/systems/${t}`},e)},{title:"Group",key:"groups",sortBy:["GROUP_NAME"],requiresDefault:!0,props:{isStatic:!1}},{title:"Tags",key:"tags",props:{width:10,isStatic:!0}},{title:"OS",key:"osVersion",sortBy:["OS_VERSION"],props:{width:10},renderFunc:e=>e?`RHEL ${e}`:h.formatMessage(d.Z.dataNotAvailable)},{title:h.formatMessage(d.Z.lastStatus),transforms:[(0,u.d)(10)],key:"hasMatch",sortBy:["HAS_MATCH"],renderFunc:(e,t,{isDisabled:a})=>l().createElement(p.Z,{isDisabled:a,hasMatch:e,displayMatch:!0})},{title:h.formatMessage(d.Z.lastMatched),transforms:[(0,u.d)(10)],key:"lastMatchDate",sortBy:["LAST_MATCH_DATE"],renderFunc:e=>e?l().createElement(f.u,{content:l().createElement(g.Z,{date:new Date(e),type:"exact"})},l().createElement("span",null,l().createElement(g.Z,{date:new Date(e)}))):l().createElement(f.u,{content:h.formatMessage(d.Z.noHostHas)},l().createElement("span",null,h.formatMessage(d.Z.never)))},{title:h.formatMessage(d.Z.totalMatches),transforms:[(0,u.d)(10),(0,m.u)({tooltip:h.formatMessage(d.Z.totalMatchesNote)})],key:"totalMatches",sortBy:["TOTAL_MATCHES"],renderFunc:(e,t,{id:a})=>l().createElement(b.Z,{to:`/systems/${a}`},e?.toLocaleString())},{title:h.formatMessage(d.Z.lastScan),key:"lastScanDate",sortBy:["LAST_SCAN_DATE"],renderFunc:e=>l().createElement(f.u,{content:l().createElement(g.Z,{date:new Date(e),type:"exact"})},l().createElement("span",null,l().createElement(g.Z,{date:new Date(e)})))}],Z=e=>M.map((t=>{const a="string"==typeof t,s=e.find((e=>e.key===t.key));return t.requiresDefault&&void 0===s?void 0:{...a?{key:t}:t,...s,props:{...s?.props,...t?.props}}})).filter(Boolean),S=[{label:"All",value:"All"},{label:"Matched",value:!0},{label:"Not Matched",value:!1}];var C=a(85893),_=a(45697),D=a.n(_),w=a(65771),x=a(65422),N=a(88087),A=a(62693);const k=function(e){var t=e.component,a=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(s=Object.getOwnPropertySymbols(e);l<s.length;l++)t.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(e,s[l])&&(a[s[l]]=e[s[l]])}return a}(e,["component"]);return(0,s.useEffect)((function(){console.error("Unable to load inventory component. Failed to load ".concat(t,"."),a)}),[]),(0,C.jsxs)("div",{children:[(0,C.jsx)("h1",{children:"Unable to load inventory component"}),(0,C.jsxs)("h2",{children:["Failed to load ",t]}),(0,C.jsx)("code",{children:"More info can be found in browser console output."})]})};var T=a(94184),O=a.n(T),P=a(51663),R=a(55140),F=function(){return F=Object.assign||function(e){for(var t,a=1,s=arguments.length;a<s;a++)for(var l in t=arguments[a])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e},F.apply(this,arguments)},L=function(e,t){var a={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(a[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(s=Object.getOwnPropertySymbols(e);l<s.length;l++)t.indexOf(s[l])<0&&Object.prototype.propertyIsEnumerable.call(e,s[l])&&(a[s[l]]=e[s[l]])}return a},j=function(e){var t=e.Component,a=L(e,["Component"]),s=P.useHistory();return(0,C.jsx)(t,F({history:s},a))},I=function(e){var t=e.Component,a=L(e,["Component"]),s=(0,R.Z)().chromeHistory;return(0,C.jsx)(t,F({history:s},a))};const B=l().forwardRef((function(e,t){var a=e.Component,l=L(e,["Component"]),r=(0,s.useMemo)((function(){return"function"==typeof P.useHistory?j:I}),[a,l]);return(0,C.jsx)(r,F({innerRef:t,Component:a},l))}));var G=function(){return G=Object.assign||function(e){for(var t,a=1,s=arguments.length;a<s;a++)for(var l in t=arguments[a])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e},G.apply(this,arguments)},V=function(e){var t=(0,x.oR)(),a=e.component;return(0,C.jsx)(a,{className:O()(e.className,"inventory"),children:(0,C.jsx)(s.Suspense,{fallback:e.fallback,children:(0,C.jsx)(w.ScalprumComponent,G({history:e.history,store:t,appName:"inventory",module:"./InventoryTable",scope:"inventory",ErrorComponent:(0,C.jsx)(k,G({component:"InventoryDetailHead"},e)),ref:e.innerRef},e))})})};V.propTypes={fallback:D().node,innerRef:D().object,component:D().string,className:D().string,history:D().object};var $=l().forwardRef((function(e,t){return(0,C.jsx)(V,G({innerRef:t},e))}));$.propTypes={fallback:D().node,component:D().string,className:D().string},$.defaultProps={fallback:(0,C.jsx)(N.Bullseye,{className:"pf-v5-u-p-lg",children:(0,C.jsx)(A.Spinner,{size:"xl"})}),component:"section"};const H=l().forwardRef((function(e,t){return(0,C.jsx)(B,G({innerRef:t,Component:$},e))}));var W=a(51364),q=a(41841),U=a(4036),Y=a(13996),z=a(75796),J=a(33203),K=a(86896),Q=a(21593),X=a(87123);const ee=(e,t)=>({label:"Status",type:X.Yu.radio,filterValues:{onChange:(e,a)=>{let s=parseInt(a);t("2"===a?S[s].value:a)},items:S,value:e,placeholder:"Filter by status"}}),te=e=>{let t=[];return e&&(t=t.concat([{category:"Status",id:"Status",chips:(()=>{{const t=S.find((({value:t})=>t===e.filterValues.value));return t?[{name:t.label,value:e.filterValues.value,id:t.value}]:[]}})()}])),t},ae=(e,t)=>({filters:te(e),onDelete:(e,a,s)=>{s?t(!0):a.map((e=>{"Status"===e.category&&t("All"===e.chips[0].value||"All")}))},showDeleteButton:!0}),se=()=>{const e=(0,s.useRef)(null),t=(0,K.Z)(),{getRegistry:a}=(0,s.useContext)(c.gE),o=(0,x.I0)();let[i,u]=(0,s.useState)(!0);(0,s.useEffect)((()=>{o({type:"INVENTORY_INIT"}),o({type:"RESET_PAGE"}),e?.current?.onRefreshData()}),[o]);const m=(0,s.useCallback)((({query:e,onComplete:t,onError:a})=>{const s=(0,r.x)();return(l,r,n={})=>s.query({query:e,fetchResults:!0,fetchPolicy:"no-cache",variables:{limit:l,offset:r,...n}}).then((({data:e})=>{const a={entities:e?.hostsList||[],meta:{...n.tags&&{tags:n.tags},totalCount:e?.hosts?.totalCount||0}};return t?.(a),a})).catch((e=>{if(a)return a(e),{entities:[],meta:{totalCount:0}};throw e}))})({query:W.c5}),[]),{value:p}=ee(i,u)?.filterValues;return l().createElement(l().Fragment,null,l().createElement(Y.Alert,{isInline:!0,variant:"info",ouiaId:"SystemsListIsDifferentAlert",title:t.formatMessage(d.Z.systemsListIsDifferent)}),l().createElement(H,{isFullView:!0,autoRefresh:!0,initialLoading:!0,hideFilters:{all:!0,name:!1,tags:!1,operatingSystem:!1,hostGroupFilter:!1},columns:Z,hasCheckbox:!1,showTags:!0,ref:e,fallback:l().createElement(z.Spinner,null),onLoad:E(M,a),getEntities:async(e,{page:t=1,per_page:a,orderBy:s,orderDirection:l,filters:r})=>{"All"===p?delete r.hasMatch:r={...r,hasMatch:p};const o=(i=s,(M||[]).find((e=>e.key===i)));var i;const c=(u=o?.sortBy,d=l,u?.map((e=>`${e}_${d}`)));var u,d;const f=((e={})=>{const{tagFilters:t,...a}=e;(0,n.isEmpty)(a.hostGroupFilter)&&delete a.hostGroupFilter,(0,n.isEmpty)(a.osFilter)?delete a.osFilter:a.osFilter=a.osFilter.map((e=>(0,n.isString)(e)?e:e.value));const s=t?{tags:t.flatMap((e=>e.values.map((t=>({namespace:e.key,key:t.tagKey,value:t.value})))))}:{};return{...a,...s}})(r),g=a,b=t*a-a,y=await m(g,b,{...f,orderBy:c}),{entities:v,meta:{totalCount:h}}=y||{};return{results:v.map((e=>({...e,display_name:e.displayName}))),orderBy:s,orderDirection:l,total:h}},tableProps:{canSelectAll:!1,className:"sysTable",isStickyHeader:!0},noSystemsTable:l().createElement(q.Z,{className:"pf-c-card",icon:U.SearchIcon,variant:"large",title:t.formatMessage(d.Z.noResults),text:t.formatMessage(d.Z.noResultsMatch)}),customFilters:{malwareParams:{...(0,Q.Rm)()},params:i},filterConfig:{items:[ee(i,u)]},activeFiltersConfig:ae(ee(i,u),u)}))};se.propTypes=J.R$;const le=se},66338:(e,t,a)=>{"use strict";a.d(t,{E:()=>r,_:()=>l});var s=a(76058);const l=s.Ps`mutation DisableRule ($input: DisableRuleInput = {}) {
  disableRule(input: $input) {
    clientMutationId
  }
}`,r=s.Ps`mutation EnableRule ($input: EnableRuleInput = {}) {
  enableRule(input: $input) {
    clientMutationId
  }
}`},24620:()=>{},82014:()=>{}}]);
//# sourceMappingURL=../sourcemaps/SigTable.0d39eb1a48a5974f5bd51ca18f020632.js.map