"use strict";(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[207],{54838:(e,t,a)=>{a.r(t),a.d(t,{default:()=>W});var r=a(56679),l=a(93149),n=a(4942),s=a(50693),o=a(16475),i=a(71070),c=a(93264),m=a.n(c),u=a(38800),d=a(62480),f=a(1082),p=a(7732),g=a(3351),y=a(6934),h=a(22860),v=a(63540),b=a(82779),M=a(38846),E=a(62410),Z=a(84580),w=a(16530),D=a(52661),S=a(51957),O=a(57277),C=a(80810),P=a(19399),T=a(35224),V=a(30893),_=a(88676),N=a(86896),A=a(70846),B=a(90025);function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var L={tableVars:{limit:10,offset:0,orderBy:"LAST_MATCH_DATE_DESC",ruleName:""},sortBy:{index:4,direction:u.B.desc},rows:[]},H={1:"NAME",2:"HAS_MATCH",3:"IS_DISABLED",4:"HOST_COUNT",5:"LAST_MATCH_DATE"},R=function(e){var t=e.index,a=e.direction;return"".concat(H[t],"_").concat(a===u.B.asc?"ASC":"DESC")},k=function(e,t){switch(t.type){case"setTableVars":return x(x({},e),{},{tableVars:x(x({},e.tableVars),t.payload)});case"setSortBy":return x(x({},e),{},{sortBy:t.payload,tableVars:x(x({},e.tableVars),t.tableVars)});case"setRows":return x(x({},e),{},{rows:t.payload})}return e},G=function(){var e,t,a,n,u,j,H,G,W=(0,N.Z)(),F=(0,c.useReducer)(k,x({},L)),I=(0,l.Z)(F,2),X=I[0],U=X.tableVars,J=X.sortBy,$=X.rows,q=I[1],z=(0,A.a)(Z.tE,{variables:x(x({},U),(0,B.l)(_.gG))}),Y=z.data,K=z.loading,Q=z.error,ee=[{title:W.formatMessage(V.Z.sigName),cellFormatters:[d.zW],transforms:[(0,f.d)(45),p.p]},{title:W.formatMessage(V.Z.lastStatus),transforms:[(0,f.d)(10),p.p]},{title:W.formatMessage(V.Z.enablement),transforms:[(0,f.d)(10),p.p]},{title:W.formatMessage(V.Z.systems),transforms:[(0,f.d)(10),p.p]},{title:m().createElement("span",null,(0,b.lH)({tooltip:W.formatMessage(V.Z.totalMatchesNote),title:W.formatMessage(V.Z.totalMatches)})),transforms:[(0,f.d)(15),p.p]}],te=U.offset/U.limit+1,ae={sig_match:{type:"radio",title:W.formatMessage(V.Z.status),urlParam:"sig_match",values:[{label:W.formatMessage(V.Z.all),value:"all"},{label:W.formatMessage(V.Z.matched),value:"true"},{label:W.formatMessage(V.Z.notMatched),value:"false"}]}},re=[{label:W.formatMessage(V.Z.signature).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return q({type:"setTableVars",payload:{ruleName:t}})},value:U.ruleName,placeholder:W.formatMessage(V.Z.filterBy,{field:W.formatMessage(V.Z.signature).toLowerCase()})}},{label:ae.sig_match.title.toLowerCase(),type:ae.sig_match.type,id:ae.sig_match.urlParam,value:"radio-".concat(ae.sig_match.urlParam),filterValues:{key:"".concat(ae.sig_match.urlParam,"-filter"),onChange:function(e,t){var a=(0,_.gG)();"all"===t&&(null==a||delete a.condition),"all"===t?(0,_.gG)(x({},a)):(0,_.gG)(x(x({},a),{},{condition:{hasMatch:JSON.parse(t)}}))},value:JSON.stringify(null===(e=(0,_.gG)().condition)||void 0===e?void 0:e.hasMatch)||"all",items:ae.sig_match.values}}],le=function(e,t){return q({type:"setTableVars",payload:{offset:t*U.limit-U.limit}})},ne=function(e,t){return q({type:"setTableVars",payload:{limit:t,offset:0}})},se={deleteTitle:W.formatMessage(V.Z.resetFilters),filters:(H=[],G=void 0!==(null===(u=(0,_.gG)().condition)||void 0===u?void 0:u.hasMatch)&&(null!==(j=(0,_.gG)().condition)&&void 0!==j&&j.hasMatch?W.formatMessage(V.Z.matched):W.formatMessage(V.Z.notMatched)),(null==U?void 0:U.ruleName)&&H.push({category:W.formatMessage(V.Z.signature),value:"name",chips:[{name:null==U?void 0:U.ruleName,value:null==U?void 0:U.ruleName}]}),G&&H.push({category:W.formatMessage(V.Z.status),value:"matched",chips:[{name:G,value:G}]}),H),onDelete:function(e,t,a){a?((0,_.gG)({}),q({type:"setTableVars",payload:{ruleName:""}})):t.map((function(e){"name"===e.value&&q({type:"setTableVars",payload:{ruleName:""}}),"matched"===e.value&&(0,_.gG)({})}))}};return(0,c.useEffect)((function(){var e,t;q({type:"setRows",payload:(e=Y,null==e||null===(t=e.rulesList)||void 0===t?void 0:t.flatMap((function(e,t){var a,r=e;return[{rowId:t,isOpen:!1,cells:[{title:m().createElement(w.Link,{to:"/signatures/".concat(r.name)},r.name)},{title:m().createElement(P.Z,{isDisabled:r.isDisabled,hasMatch:r.hasMatch,displayMatch:!0})},{title:m().createElement(P.Z,{isDisabled:r.isDisabled,hasMatch:r.hasMatch})},{title:m().createElement(w.Link,{to:"/signatures/".concat(r.name)},null===(a=r.hostCount)||void 0===a?void 0:a.toLocaleString())},{title:r.lastMatchDate?m().createElement(T.u,{content:m().createElement(E.Z,{date:new Date(r.lastMatchDate),type:"exact"})},m().createElement("span",null,m().createElement(E.Z,{date:new Date(r.lastMatchDate),type:"onlyDate"}))):m().createElement(T.u,{content:W.formatMessage(V.Z.noHostHas)},m().createElement("span",null,W.formatMessage(V.Z.never)))}]},{parent:2*t,sigData:r,fullWidth:!0,cells:[]}]})))})}),[W,Y]),m().createElement(m().Fragment,null,m().createElement(O.Z,{pagination:{itemCount:(null==Y||null===(t=Y.rules)||void 0===t?void 0:t.totalCount)||0,page:te,perPage:U.limit,onSetPage:function(e,t){le(0,t)},onPerPageSelect:function(e,t){ne(0,t)},isCompact:!0},filterConfig:{items:re},activeFiltersConfig:se}),m().createElement(g.i,{className:"sigTable","aria-label":"Signature table",onCollapse:function(e,t,a){var l=(0,r.Z)($),n=l[t+1].sigData;l[t]=x(x({},l[t]),{},{isOpen:a}),l[t+1].cells=[{title:m().createElement(s.r,{hasGutter:!0},m().createElement(o.P,{span:6},m().createElement(M.Z,{code:n.rawRule,isReadOnly:!0})),m().createElement(o.P,{span:6}," ",m().createElement(v.xv,{className:"ins-l-sigtable--title",component:v.qO.h6},W.formatMessage(V.Z.description)),n.metadata.description))}],q({type:"setRows",payload:l})},rows:$,cells:ee,onSort:function(e,t,a){return q({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:R({index:t,direction:a}),offset:0}})},sortBy:J,isStickyHeader:!0},m().createElement(y.x,null),m().createElement(h.R,null)),K&&m().createElement(D.Z,{type:"table"}),!K&&!Q&&0===(null==Y||null===(a=Y.rules)||void 0===a?void 0:a.totalCount)&&m().createElement(S.Z,{className:"pf-c-card",icon:C.W1,variant:"large",title:W.formatMessage(V.Z.noResults),text:W.formatMessage(V.Z.noResultsMatch)}),Q&&m().createElement(S.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),m().createElement(i.t,{itemCount:(null==Y||null===(n=Y.rules)||void 0===n?void 0:n.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:U.limit,page:te,variant:i.a.bottom,onSetPage:le,onPerPageSelect:ne}))};G.propTypes=b.R$;const W=G},39149:(e,t,a)=>{a.r(t),a.d(t,{default:()=>x});var r=a(93149),l=a(4942),n=a(71070),s=a(93264),o=a.n(s),i=a(38800),c=a(1082),m=a(7732),u=a(3351),d=a(6934),f=a(22860),p=a(62410),g=a(84580),y=a(16530),h=a(52661),v=a(51957),b=a(57277),M=a(80810),E=a(19399),Z=a(35224),w=a(82779),D=a(30893),S=a(88676),O=a(86896),C=a(70846),P=a(90025);function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function V(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,l.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _={tableVars:{limit:10,offset:0,orderBy:"UPDATED_DESC",name:""},sortBy:{index:4,direction:i.B.desc},rows:[]},N={0:"DISPLAY_NAME",1:"HAS_MATCH",2:"LAST_MATCH_DATE",3:"TOTAL_MATCHES",4:"UPDATED"},A=function(e){var t=e.index,a=e.direction;return"".concat(N[t],"_").concat(a===i.B.asc?"ASC":"DESC")},B=function(e,t){switch(t.type){case"setTableVars":return V(V({},e),{},{tableVars:V(V({},e.tableVars),t.payload)});case"setSortBy":return V(V({},e),{},{sortBy:t.payload,tableVars:V(V({},e.tableVars),t.tableVars)});case"setRows":return V(V({},e),{},{rows:t.payload})}return e},j=function(){var e,t,a,l,i,T,N,j=(0,O.Z)(),x=(0,s.useReducer)(B,V({},_)),L=(0,r.Z)(x,2),H=L[0],R=H.tableVars,k=H.sortBy,G=H.rows,W=L[1],F=(0,C.a)(g.c5,{variables:V(V({},R),(0,P.l)(S.WX))}),I=F.data,X=F.loading,U=F.error,J=[{title:j.formatMessage(D.Z.name),transforms:[(0,c.d)(45),m.p]},{title:j.formatMessage(D.Z.lastStatus),transforms:[m.p,(0,c.d)(10)]},{title:j.formatMessage(D.Z.matched),transforms:[m.p,(0,c.d)(10)]},{title:o().createElement("span",null,(0,w.lH)({tooltip:j.formatMessage(D.Z.totalMatchesNote),title:j.formatMessage(D.Z.totalMatches)})),transforms:[m.p,(0,c.d)(15)]},{title:j.formatMessage(D.Z.lastScan),transforms:[m.p,(0,c.d)(10)]}],$=R.offset/R.limit+1,q=[{label:j.formatMessage(D.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return W({type:"setTableVars",payload:{name:t}})},value:R.name,placeholder:j.formatMessage(D.Z.filterBy,{field:j.formatMessage(D.Z.name).toLowerCase()})}}],z=function(e,t){return W({type:"setTableVars",payload:{offset:t*R.limit-R.limit}})},Y=function(e,t){return W({type:"setTableVars",payload:{limit:t,offset:0}})},K={deleteTitle:j.formatMessage(D.Z.resetFilters),filters:(T=[],N=void 0!==(null===(l=(0,S.WX)().condition)||void 0===l?void 0:l.hasMatch)&&(null!==(i=(0,S.WX)().condition)&&void 0!==i&&i.hasMatch?j.formatMessage(D.Z.matched):j.formatMessage(D.Z.notMatched)),(null==R?void 0:R.name)&&T.push({category:j.formatMessage(D.Z.name),value:"name",chips:[{name:null==R?void 0:R.name,value:null==R?void 0:R.name}]}),N&&T.push({category:j.formatMessage(D.Z.status),value:"matched",chips:[{name:N,value:N}]}),T),onDelete:function(e,t,a){a?((0,S.WX)({}),W({type:"setTableVars",payload:{name:""}})):t.map((function(e){"name"===e.value&&W({type:"setTableVars",payload:{name:""}}),"matched"===e.value&&(0,S.WX)({})}))}};return(0,s.useEffect)((function(){var e,t;W({type:"setRows",payload:(e=I,null==e||null===(t=e.hostsList)||void 0===t?void 0:t.flatMap((function(e,t){var a;return{rowId:t,cells:[{title:o().createElement(y.Link,{to:"/systems/".concat(e.displayName)},e.displayName)},{title:o().createElement(E.Z,{isDisabled:e.isDisabled,hasMatch:e.hasMatch,displayMatch:!0})},{title:e.lastMatchDate?o().createElement(Z.u,{content:o().createElement(p.Z,{date:new Date(e.lastMatchDate),type:"exact"})},o().createElement("span",null,o().createElement(p.Z,{date:new Date(e.lastMatchDate),type:"onlyDate"}))):o().createElement(Z.u,{content:j.formatMessage(D.Z.noHostHas)},o().createElement("span",null,j.formatMessage(D.Z.never)))},{title:o().createElement(y.Link,{to:"/systems/".concat(e.displayName)},null===(a=e.totalMatches)||void 0===a?void 0:a.toLocaleString())},{title:o().createElement(Z.u,{content:o().createElement(p.Z,{date:new Date(e.updated),type:"exact"})},o().createElement("span",null,o().createElement(p.Z,{date:new Date(e.updated)})))}]}})))})}),[j,I]),o().createElement(o().Fragment,null,o().createElement(b.Z,{pagination:{itemCount:(null==I||null===(e=I.hosts)||void 0===e?void 0:e.totalCount)||0,page:$,perPage:R.limit,onSetPage:function(e,t){z(0,t)},onPerPageSelect:function(e,t){Y(0,t)},isCompact:!0},filterConfig:{items:q},activeFiltersConfig:K}),o().createElement(u.i,{className:"sysTable","aria-label":"System table",rows:G,cells:J,onSort:function(e,t,a){return W({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:A({index:t,direction:a}),offset:0}})},sortBy:k,isStickyHeader:!0},o().createElement(d.x,null),o().createElement(f.R,null)),X&&o().createElement(h.Z,{type:"table"}),!X&&!U&&0===(null==I||null===(t=I.hosts)||void 0===t?void 0:t.totalCount)&&o().createElement(v.Z,{className:"pf-c-card",icon:M.W1,variant:"large",title:j.formatMessage(D.Z.noResults),text:j.formatMessage(D.Z.noResultsMatch)}),U&&o().createElement(v.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),o().createElement(n.t,{itemCount:(null==I||null===(a=I.hosts)||void 0===a?void 0:a.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:R.limit,page:$,variant:n.a.bottom,onSetPage:z,onPerPageSelect:Y}))};j.propTypes=w.R$;const x=j}}]);
//# sourceMappingURL=../sourcemaps/SigTable.0960dc1a098b0f54bacc.js.map