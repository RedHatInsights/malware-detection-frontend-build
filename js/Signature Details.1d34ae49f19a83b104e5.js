(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[982],{91072:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>U});var n=a(50693),r=a(16475),l=a(60485),s=a(69291),o=a(45697),c=a.n(o),i=a(93264),u=a.n(i),m=function(e){var t=e.items,a=t.pop();return u().createElement(s.Breadcrumb,null,t.map((function(e,t){return u().createElement(s.BreadcrumbItem,{key:t,to:e.to},e.name)})),u().createElement(s.BreadcrumbItem,{isActive:!0},a.name))};m.propTypes={items:c().array};const d=m;var f=a(38846),p=a(62410),g=a(84580),y=a(52661),E=a(86350),v=a(48716),h=a(85061),b=a(28481),Z=a(96156),w=a(71070),C=a(38800),D=a(62480),M=a(7732),P=a(1082),S=a(3351),O=a(6934),B=a(22860),H=a(68778),N=a(51957),I=a(57277),T=a(80810),x=a(30893),L=a(86896),V=a(46829);function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){(0,Z.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var _={1:"INSIGHTSID",2:"LAST_SCAN_DATE",3:"MATCH_COUNT"},k=function(e){var t=e.index,a=e.direction;return"".concat(_[t],"_").concat(a===C.B.asc?"ASC":"DESC")},R=function(e,t){switch(t.type){case"setTableVars":return A(A({},e),{},{tableVars:A(A({},e.tableVars),t.payload)});case"setSortBy":return A(A({},e),{},{sortBy:t.payload,tableVars:A(A({},e.tableVars),t.tableVars)});case"setRows":return A(A({},e),{},{rows:t.payload})}return e},F=function(e){var t,a,n,r,l,s,o=e.ruleName,c=e.affectedCount,m=(0,L.Z)(),d={tableVars:{limit:10,offset:0,orderBy:"LAST_SCAN_DATE_ASC",insightsId:"",ruleName:o},sortBy:{index:2,direction:C.B.asc},rows:[]},E=(0,i.useReducer)(R,A({},d)),v=(0,b.Z)(E,2),Z=v[0],j=Z.tableVars,_=Z.sortBy,F=Z.rows,z=v[1],G=(0,V.useQuery)(g.I8,{variables:j}),W=G.data,Q=G.loading,U=G.error,q=[{title:m.formatMessage(x.Z.name),cellFormatters:[D.zW],transforms:[M.p,(0,P.d)(45)]},{title:m.formatMessage(x.Z.lastmatch),transforms:[M.p]},{title:m.formatMessage(x.Z.totalMatches),transforms:[M.p]}],J=j.offset/j.limit+1,K=[{label:m.formatMessage(x.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return z({type:"setTableVars",payload:{insightsId:t}})},value:j.insightsId,placeholder:m.formatMessage(x.Z.filterBy,{field:m.formatMessage(x.Z.name).toLowerCase()})}}],X=function(e,t){return z({type:"setTableVars",payload:{offset:t*j.limit-j.limit}})},Y=function(e,t){return z({type:"setTableVars",payload:{limit:t,offset:0}})};return(0,i.useEffect)((function(){var e;z({type:"setRows",payload:function(e){return null==e?void 0:e.flatMap((function(e,t){var a,n=e;return[{rowId:t,isOpen:!1,cells:[{title:u().createElement("span",null,n.insightsId)},{title:u().createElement(p.Z,{date:new Date(n.lastScanDate),type:"onlyDate"})},{title:u().createElement("span",null,null===(a=n.matchCount)||void 0===a?void 0:a.toLocaleString())}]},{parent:2*t,hostData:n,fullWidth:!0,cells:[]}]}))}(null==W||null===(e=W.rulesList[0])||void 0===e?void 0:e.affectedHostsList)})}),[m,W]),u().createElement(u().Fragment,null,u().createElement(I.Z,{pagination:{itemCount:(null==W||null===(t=W.rulesList[0])||void 0===t||null===(a=t.affectedHosts)||void 0===a?void 0:a.totalCount)||0,page:J,perPage:j.limit,onSetPage:function(e,t){X(0,t)},onPerPageSelect:function(e,t){Y(0,t)},isCompact:!0},filterConfig:{items:K}}),u().createElement(S.i,{className:"sigTable","aria-label":"Signature Details table",rows:F,cells:q,onCollapse:function(e,t,a){var n=(0,h.Z)(F),r=n[t+1].hostData;n[t]=A(A({},n[t]),{},{isOpen:a}),n[t+1].cells=[{title:u().createElement(f.Z,{height:"250px",code:"".concat(r.matches.map((function(e,t){return"Match Source: ".concat(e.source,"\nOffset:").concat(e.stringOffset,"\nMatch Data: ").concat(e.stringData,"\nMatch Identifier: ").concat(e.stringIdentifier,"\nMatch Scan Date: ").concat(new Date(e.scanDate),"\n").concat(r.matches.length>1&&t!==r.matches.length-1?"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n":"")})).join("")),isDownloadEnabled:!0,isCopyEnabled:!0})}],z({type:"setRows",payload:n})},onSort:function(e,t,a){return z({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:k({index:t,direction:a}),offset:0}})},sortBy:_,isStickyHeader:!0},u().createElement(O.x,null),u().createElement(B.R,null)),Q&&u().createElement(y.Z,{type:"table"}),U||Q||0===c?!Q&&u().createElement(N.Z,{className:"pf-c-card",variant:"large",icon:H.ZP,iconClass:"ins-l-success-color",title:m.formatMessage(x.Z.noAffectedHosts),text:m.formatMessage(x.Z.noAffectedHostsBody)}):0===(null==W||null===(n=W.rulesList[0])||void 0===n||null===(r=n.affectedHosts)||void 0===r?void 0:r.totalCount)?u().createElement(N.Z,{className:"pf-c-card",icon:T.W1,variant:"large",title:m.formatMessage(x.Z.noResults),text:m.formatMessage(x.Z.noResultsMatch)}):u().createElement(u().Fragment,null),U&&u().createElement(N.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),u().createElement(w.t,{itemCount:(null==W||null===(l=W.rulesList[0])||void 0===l||null===(s=l.affectedHosts)||void 0===s?void 0:s.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:j.limit,page:J,variant:w.a.bottom,onSetPage:X,onPerPageSelect:Y}))};F.propTypes={ruleName:c().string,affectedCount:c().number};const z=F;var G=a(19399),W=a(82779),Q=a(16530);const U=function(){var e,t,a,s,o,c=(0,L.Z)(),i=(0,Q.useParams)().id,m=[{name:c.formatMessage(x.Z.malwareDetection),to:"".concat((0,W.hN)(),"/insights/malware")},{name:i,to:"#"}],h=(0,V.useQuery)(g.c3,{variables:{ruleName:i}}),b=h.data,Z=h.loading,w=null==b?void 0:b.rulesList[0],C=function(e,t){return u().createElement(u().Fragment,null,u().createElement("p",{className:"ins-l-detailBlockHeader"},e),u().createElement("p",null,t))};return u().createElement(u().Fragment,null,u().createElement(v.Z,null,u().createElement(d,{items:m}),u().createElement(l.D,{headingLevel:"h1",size:l.H["3xl"]},i),u().createElement(n.r,{hasGutter:!0},u().createElement(r.P,{md:7,sm:12},w&&u().createElement(f.Z,{height:"250px",code:w.rawRule,isReadOnly:!0,isDownloadEnabled:!0,isCopyEnabled:!0})),Z?u().createElement(y.Z,null):u().createElement(r.P,{md:5,sm:12},u().createElement(n.r,{hasGutter:!0},u().createElement(r.P,{span:6},C(c.formatMessage(x.Z.lastmatch),null!=w&&w.lastMatchDate?u().createElement(p.Z,{date:new Date(w.lastMatchDate),type:"onlyDate"}):c.formatMessage(x.Z.never))),u().createElement(r.P,{span:6},C(c.formatMessage(x.Z.hostmatch),u().createElement("span",null,"".concat(null==w||null===(e=w.affectedHosts)||void 0===e?void 0:e.totalCount,"/").concat(null==b||null===(t=b.hosts)||void 0===t?void 0:t.totalCount)))),u().createElement(r.P,{span:12},C(c.formatMessage(x.Z.description),null==w||null===(a=w.metadata)||void 0===a?void 0:a.description)),u().createElement(r.P,{span:6},C(c.formatMessage(x.Z.status),w&&u().createElement(G.Z,w))),u().createElement(r.P,{span:6},C(c.formatMessage(x.Z.author),null==w||null===(s=w.metadata)||void 0===s?void 0:s.author)))))),u().createElement(E.Z,null,u().createElement(l.D,{className:"ins-l-tableBlockHeader",headingLevel:"h1",size:l.H["3xl"]},c.formatMessage(x.Z.affectedHosts)),u().createElement(z,{ruleName:i,affectedCount:null==w||null===(o=w.affectedHosts)||void 0===o?void 0:o.totalCount})))}}}]);
//# sourceMappingURL=../sourcemaps/Signature Details.177626137c11ed87c35b.js.map