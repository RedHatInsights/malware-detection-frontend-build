(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[207],{87757:(e,t,r)=>{e.exports=r(35666)},69174:(e,t,r)=>{"use strict";r.d(t,{_:()=>p});var n=r(21988),a=r(93264),o=r(83063),s=r(72002),i=r(47173),l=r(35224),c=r(38296),u=r(22586),f=r(6551);const d={blue:o.default.modifiers.blue,cyan:o.default.modifiers.cyan,green:o.default.modifiers.green,orange:o.default.modifiers.orange,purple:o.default.modifiers.purple,red:o.default.modifiers.red,gold:o.default.modifiers.gold,grey:""},p=e=>{var{children:t,className:r="",color:p="grey",variant:m="filled",isCompact:h=!1,isEditable:v=!1,editableProps:g,isTruncated:y=!1,tooltipPosition:b,icon:E,onClose:O,onEditCancel:w,onEditComplete:j,closeBtn:M,closeBtnAriaLabel:x,closeBtnProps:P,href:S,isOverflowLabel:Z,render:_}=e,C=(0,n.__rest)(e,["children","className","color","variant","isCompact","isEditable","editableProps","isTruncated","tooltipPosition","icon","onClose","onEditCancel","onEditComplete","closeBtn","closeBtnAriaLabel","closeBtnProps","href","isOverflowLabel","render"]);const[N,D]=(0,a.useState)(!1),[L,T]=(0,a.useState)(t),k=a.useRef(),R=a.useRef();a.useEffect((()=>(document.addEventListener("mousedown",A),document.addEventListener("keydown",B),()=>{document.removeEventListener("mousedown",A),document.removeEventListener("keydown",B)})));const A=e=>{N&&R&&R.current&&!R.current.contains(e.target)&&(R.current.value&&j&&j(e,R.current.value),D(!1))},B=e=>{var r,n;const a=e.key;if((N||k&&k.current&&k.current.contains(e.target))&&(!N||R&&R.current&&R.current.contains(e.target))&&(!N||"Enter"!==a&&"Tab"!==a||(e.preventDefault(),e.stopImmediatePropagation(),R.current.value&&j&&j(e,R.current.value),D(!1),null===(r=null==k?void 0:k.current)||void 0===r||r.focus()),N&&"Escape"===a&&(e.preventDefault(),e.stopImmediatePropagation(),R.current.value&&(R.current.value=t,w&&w(e,t)),D(!1),null===(n=null==k?void 0:k.current)||void 0===n||n.focus()),!N&&"Enter"===a)){e.preventDefault(),e.stopImmediatePropagation(),D(!0);const t=e.target,r=document.createRange(),n=window.getSelection();r.selectNodeContents(t),r.collapse(!1),n.removeAllRanges(),n.addRange(r)}},F=Z?"button":"span",G=M||a.createElement(i.zx,Object.assign({type:"button",variant:"plain",onClick:O,"aria-label":x||`Close ${t}`},P),a.createElement(u.ZP,null)),I=a.createRef(),V=a.useRef(),[H,$]=a.useState(!1);(0,f.L)((()=>{const e=v?k:I;N||$(e.current&&e.current.offsetWidth<e.current.scrollWidth)}),[N]);const q=a.createElement(a.Fragment,null,E&&a.createElement("span",{className:(0,c.css)(o.default.labelIcon)},E),y&&a.createElement("span",{ref:I,className:(0,c.css)(o.default.labelText)},t),!y&&t);a.useEffect((()=>{N&&R&&R.current&&R.current.focus()}),[R,N]);let z=a.createElement("span",{className:(0,c.css)(o.default.labelContent)},q);return S?z=a.createElement("a",{className:(0,c.css)(o.default.labelContent),href:S},q):v&&(z=a.createElement("button",Object.assign({ref:k,className:(0,c.css)(o.default.labelContent),onClick:e=>{D(!0),e.stopPropagation()}},g),q)),_?z=a.createElement(a.Fragment,null,H&&a.createElement(l.u,{reference:V,content:t,position:b}),_({className:o.default.labelContent,content:q,componentRef:V})):H&&(z=a.createElement(l.u,{content:t,position:b},z)),a.createElement(F,Object.assign({},C,{className:(0,c.css)(o.default.label,d[p],"outline"===m&&o.default.modifiers.outline,Z&&o.default.modifiers.overflow,h&&o.default.modifiers.compact,v&&s.default.modifiers.editable,N&&o.default.modifiers.editableActive,r)}),!N&&z,!N&&O&&G,N&&a.createElement("input",Object.assign({className:(0,c.css)(o.default.labelContent),type:"text",id:"editable-input",ref:R,value:L,onChange:()=>{T(R.current.value)}},g)))};p.displayName="Label"},50693:(e,t,r)=>{"use strict";r.d(t,{r:()=>u});var n=r(21988),a=r(93264),o=r(3246),s=r(38296),i=r(54764),l=r(77712),c=r(80164);const u=e=>{var{children:t=null,className:r="",component:u="div",hasGutter:f,span:d=null,order:p,style:m}=e,h=(0,n.__rest)(e,["children","className","component","hasGutter","span","order","style"]);const v=[o.default.grid,d&&o.default.modifiers[`all_${d}Col`]],g=u;return Object.entries(i.a).forEach((([e,t])=>{const r=e,n=h[r];n&&v.push(o.default.modifiers[`all_${n}ColOn${t}`]),delete h[r]})),a.createElement(g,Object.assign({className:(0,s.css)(...v,f&&o.default.modifiers.gutter,r),style:m||p?Object.assign(Object.assign({},m),(0,c.x8)(p,l.T.name)):void 0},h),t)};u.displayName="Grid"},16475:(e,t,r)=>{"use strict";r.d(t,{P:()=>u});var n=r(21988),a=r(93264),o=r(3246),s=r(38296),i=r(54764),l=r(77712),c=r(80164);const u=e=>{var{children:t=null,className:r="",component:u="div",span:f=null,rowSpan:d=null,offset:p=null,order:m,style:h}=e,v=(0,n.__rest)(e,["children","className","component","span","rowSpan","offset","order","style"]);const g=[o.default.gridItem,f&&o.default.modifiers[`${f}Col`],d&&o.default.modifiers[`${d}Row`],p&&o.default.modifiers[`offset_${p}Col`]],y=u;return Object.entries(i.a).forEach((([e,t])=>{const r=e,n=`${r}RowSpan`,a=`${r}Offset`,s=v[r],i=v[n],l=v[a];s&&g.push(o.default.modifiers[`${s}ColOn${t}`]),i&&g.push(o.default.modifiers[`${i}RowOn${t}`]),l&&g.push(o.default.modifiers[`offset_${l}ColOn${t}`]),delete v[r],delete v[n],delete v[a]})),a.createElement(y,Object.assign({className:(0,s.css)(...g,r),style:h||m?Object.assign(Object.assign({},h),(0,c.x8)(m,l.T.name)):void 0},v),t)};u.displayName="GridItem"},54764:(e,t,r)=>{"use strict";var n,a;r.d(t,{t:()=>n,a:()=>a}),function(e){e.xs="xs",e.sm="sm",e.md="md",e.lg="lg",e.xl="xl",e["2xl"]="2xl",e["3xl"]="3xl",e["4xl"]="4xl"}(n||(n={})),function(e){e.sm="Sm",e.md="Md",e.lg="Lg",e.xl="Xl",e.xl2="_2xl"}(a||(a={}))},63540:(e,t,r)=>{"use strict";t.xv=t.qO=void 0;const n=r(21988),a=n.__importStar(r(93264)),o=r(38296),s=n.__importDefault(r(62873)),i=r(23053);var l;!function(e){e.h1="h1",e.h2="h2",e.h3="h3",e.h4="h4",e.h5="h5",e.h6="h6",e.p="p",e.a="a",e.small="small",e.blockquote="blockquote",e.pre="pre"}(l=t.qO||(t.qO={})),t.xv=e=>{var{children:r=null,className:c="",component:u=l.p,isVisitedLink:f=!1,ouiaId:d,ouiaSafe:p=!0}=e,m=n.__rest(e,["children","className","component","isVisitedLink","ouiaId","ouiaSafe"]);const h=u,v=(0,i.useOUIAProps)(t.xv.displayName,d,p);return a.createElement(h,Object.assign({},v,m,{"data-pf-content":!0,className:(0,o.css)(f&&u===l.a&&s.default.modifiers.visited,c)}),r)},t.xv.displayName="Text"},62873:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n}),r(10108);const n={content:"pf-c-content",modifiers:{visited:"pf-m-visited",plain:"pf-m-plain",overpassFont:"pf-m-overpass-font"}}},77712:(e,t,r)=>{"use strict";r.d(t,{T:()=>n});const n={name:"--pf-l-grid--item--Order",value:"0",var:"var(--pf-l-grid--item--Order)"}},38846:(e,t,r)=>{"use strict";r.d(t,{Z:()=>p});var n=r(99332),a=r(51957),o=r(88461),s=r(45697),i=r.n(s),l=r(93264),c=r.n(l),u=r(30893),f=r(86896),d=function(e){var t=e.code,r=e.language,s=e.isReadOnly,i=e.isDownloadEnabled,l=e.isCopyEnabled,d=e.height,p=void 0===d?"400px":d,m=(0,f.Z)();return c().createElement(o.p,{isDownloadEnabled:i,isCopyEnabled:l,isReadOnly:s,isLanguageLabelVisible:r,code:t,language:r,emptyState:c().createElement(a.Z,{className:"",icon:n.mB,variant:"small",title:m.formatMessage(u.Z.sigCompiled),text:m.formatMessage(u.Z.sigCompiledBody)}),height:p})};d.propTypes={code:i().any,language:i().string,isReadOnly:i().bool,isCopyEnabled:i().bool,isDownloadEnabled:i().bool,height:i().string},d.defaultProps={codeType:"Code"};const p=d},51957:(e,t,r)=>{"use strict";r.d(t,{Z:()=>p});var n=r(9947),a=r(38424),o=r(75106),s=r(76473),i=r(45697),l=r.n(i),c=r(93264),u=r.n(c),f=r(60485),d=function(e){var t=e.className,r=e.children,s=e.icon,i=e.iconClass,l=e.iconStyle,c=e.text,d=e.title,p=e.variant;return u().createElement(n.u,{className:t,variant:p},"none"!==s&&u().createElement(a.k,{className:i,style:l,icon:s}),u().createElement(f.D,{headingLevel:"h5",size:"lg"},d),u().createElement(o.B,{style:{marginBottom:"16px"}},c),r)};d.propTypes={children:l().any,icon:l().any,iconClass:l().any,iconStyle:l().any,text:l().any,title:l().string,variant:l().any,className:l().string},d.defaultProps={icon:s.ZP,title:"",variant:n.I.full};const p=d},49921:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>U});var n=r(42982),a=r(70885),o=r(4942),s=r(44733),i=r(93264),l=r.n(i),c=r(68868),u=r(62480),f=r(7732),d=r(1082),p=r(22546),m=r(3351),h=r(6934),v=r(22860),g=r(82779),y=r(62410),b=r(84580),E=r(51957),O=r(3962),w=r(80810),j=r(19399),M=r(35224),x=r(69174),P=r(30893),S=r(88676),Z=r(86896),_=r(90570),C=r(38846),N=r(50693),D=r(16475),L=r(45697),T=r.n(L),k=r(63540),R=function(e){var t=e.signature,r=(0,Z.Z)(),n=(0,i.useState)(!1),o=(0,a.Z)(n,1)[0];return l().createElement(N.r,{hasGutter:!0},o&&l().createElement(D.P,{span:6},l().createElement(C.Z,{code:t.rawRule,isReadOnly:!0})),l().createElement(D.P,{span:o?6:12}," ",l().createElement(k.xv,{className:"ins-l-sigtable--title",component:k.qO.h6},r.formatMessage(P.Z.description)),t.metadata.description))};R.propTypes={signature:T().object};const A=R;var B=r(92397),F=r(80710);function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){(0,o.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var V={tableVars:{limit:10,offset:0,orderBy:"LAST_MATCH_DATE_NULLS_LAST_DESC",ruleName:""},sortBy:{index:4,direction:c.B.desc},rows:[]},H={1:"NAME",2:"HAS_MATCH",3:"HOST_COUNT",4:"LAST_MATCH_DATE_NULLS_LAST"},$=function(e){var t=e.index,r=e.direction;return"".concat(H[t],"_").concat(r===c.B.asc?"ASC":"DESC")},q=function(e,t){switch(t.type){case"setTableVars":return I(I({},e),{},{tableVars:I(I({},e.tableVars),t.payload)});case"setSortBy":return I(I({},e),{},{sortBy:t.payload,tableVars:I(I({},e.tableVars),t.tableVars)});case"setRows":return I(I({},e),{},{rows:t.payload})}return e},z=function(){var e,t,r,o,c,g,C,N,D,L,T=(0,Z.Z)(),k=(0,i.useReducer)(q,I({},V)),R=(0,a.Z)(k,2),G=R[0],H=G.tableVars,z=G.sortBy,U=G.rows,W=R[1],Y=(0,_.a)(b.tE,{variables:I(I({},H),(C=S.gG,N=C(),D=(0,i.useState)(N)[1],(0,i.useEffect)((function(){var e=C();if(N===e)return C.onNextChange(D);D(e)}),[N]),N))}),J=Y.data,K=Y.loading,X=Y.error,Q=[{title:T.formatMessage(P.Z.sigName),cellFormatters:[u.zW],transforms:[f.p,(0,d.d)(55)]},{title:T.formatMessage(P.Z.lastStatus),transforms:[(0,d.d)(10),f.p]},{title:T.formatMessage(P.Z.systems),transforms:[(0,d.d)(10),f.p]},{title:T.formatMessage(P.Z.lastMatched),transforms:[(0,d.d)(10),f.p]}],ee=H.offset/H.limit+1,te={items:{hasMatch:"true",isDisabled:["false"]},condition:{hasMatch:!0,isDisabled:!1}},re={sig_match:{type:"radio",title:T.formatMessage(P.Z.status),urlParam:"sig_match",values:[{label:T.formatMessage(P.Z.all),value:"all"},{label:T.formatMessage(P.Z.matched),value:"true"},{label:T.formatMessage(P.Z.notMatched),value:"false"}]},sigs_enabled:{type:"checkbox",title:T.formatMessage(P.Z.signaturesEnabledFilter),urlParam:"sigs_enabled",values:[{label:T.formatMessage(P.Z.signaturesEnabled),value:"false"},{label:T.formatMessage(P.Z.signaturesDisabled),value:"true"}]}},ne=[{label:T.formatMessage(P.Z.signature).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return W({type:"setTableVars",payload:{ruleName:t,offset:0}})},value:H.ruleName,placeholder:T.formatMessage(P.Z.filterBy,{field:T.formatMessage(P.Z.signature).toLowerCase()})}},{label:re.sig_match.title.toLowerCase(),type:re.sig_match.type,id:re.sig_match.urlParam,value:"radio-".concat(re.sig_match.urlParam),filterValues:{key:"".concat(re.sig_match.urlParam,"-filter"),onChange:function(e,t){var r=(0,S.gG)();(0,S.gG)({items:I(I({},r.items),{},{hasMatch:t}),condition:I(I({},r.condition),{},{hasMatch:"all"===t?void 0:JSON.parse(t)})})},value:(null===(e=(0,S.gG)().items)||void 0===e?void 0:e.hasMatch)||"true",items:re.sig_match.values}},{label:re.sigs_enabled.title.toLowerCase(),type:re.sigs_enabled.type,id:re.sigs_enabled.urlParam,value:"checkbox-".concat(re.sigs_enabled.urlParam),filterValues:{key:"".concat(re.sigs_enabled.urlParam,"-filter"),onChange:function(e,t){var r=(0,S.gG)();(0,S.gG)({items:I(I({},r.items),{},{isDisabled:t}),condition:I(I({},r.condition),{},{isDisabled:1!==t.length?void 0:JSON.parse(t[0])})})},value:(null===(t=(0,S.gG)().items)||void 0===t?void 0:t.isDisabled)||["false"],items:re.sigs_enabled.values}}],ae=function(e,t){return W({type:"setTableVars",payload:{offset:t*H.limit-H.limit}})},oe=function(e,t){return W({type:"setTableVars",payload:{limit:t,offset:0}})},se=function(e){var t=e.event,r=e.chips,n=void 0===r?[]:r,o=(0,S.gG)();if("add"===t){var s,i,l=T.formatMessage(P.Z.all);"true"===(null===(s=o.items)||void 0===s?void 0:s.hasMatch)?l=T.formatMessage(P.Z.matched):"false"===(null===(i=o.items)||void 0===i?void 0:i.hasMatch)&&(l=T.formatMessage(P.Z.notMatched)),n.push({category:T.formatMessage(P.Z.status),value:"matched",chips:[{name:l,value:l}]})}else if("remove"===t){var c,u="all"===(null===(c=o.items)||void 0===c?void 0:c.hasMatch)?["true",!0]:["all",void 0],f=(0,a.Z)(u,2),d=f[0],p=f[1];(0,S.gG)({items:I(I({},o.items),{},{hasMatch:d}),condition:I(I({},o.condition),{},{hasMatch:p})})}},ie=function(e){var t,r=e.event,n=e.chips,o=void 0===n?[]:n,s=e.item,i=void 0===s?"":s,l=(0,S.gG)();if("add"===r)null===(t=l.items)||void 0===t||t.isDisabled.map((function(e){var t=T.formatMessage("true"===e?P.Z.signaturesDisabled:P.Z.signaturesEnabled);o.push({category:T.formatMessage(P.Z.signaturesEnabledFilter),value:t,chips:[{name:t,value:t}]})}));else if("remove"===r){var c,u=[],f=void 0;if(1!==(null===(c=l.items)||void 0===c?void 0:c.isDisabled.length)){var d=i.value===T.formatMessage(P.Z.signaturesEnabled)?[["true"],!0]:[["false"],!1],p=(0,a.Z)(d,2);u=p[0],f=p[1]}(0,S.gG)({items:I(I({},l.items),{},{isDisabled:u}),condition:I(I({},l.condition),{},{isDisabled:f})})}},le={deleteTitle:T.formatMessage(P.Z.resetFilters),filters:(L=[],(null==H?void 0:H.ruleName)&&L.push({category:T.formatMessage(P.Z.signature),value:"name",chips:[{name:null==H?void 0:H.ruleName,value:null==H?void 0:H.ruleName}]}),se({event:"add",chips:L}),ie({event:"add",chips:L}),L),showDeleteButton:!0,onDelete:function(e,t,r){r?((0,S.gG)(te),W({type:"setTableVars",payload:{ruleName:""}})):t.map((function(e){"name"===e.value&&W({type:"setTableVars",payload:{ruleName:""}}),"matched"===e.value&&se({event:"remove"}),"name"!==e.value&&"matched"!==e.value&&ie({event:"remove",item:e})}))}};return(0,i.useEffect)((function(){(0,S.gG)(te)}),[]),(0,i.useEffect)((function(){var e,t;W({type:"setRows",payload:(e=J,null==e||null===(t=e.rulesList)||void 0===t?void 0:t.flatMap((function(e,t){var r,n=e;return[{rowId:t,isOpen:!1,cells:[{title:l().createElement(l().Fragment,null,l().createElement(B.Z,{to:"/signatures/".concat(n.name)},n.name),n.isDisabled&&l().createElement(l().Fragment,null,l().createElement("br",null),l().createElement(x._,{color:"red",isCompact:!0},T.formatMessage(P.Z.disabled))))},{title:n.isDisabled?"N/A":l().createElement(j.Z,{isDisabled:n.isDisabled,hasMatch:n.hasMatch,displayMatch:!0})},{title:n.isDisabled?"N/A":l().createElement(B.Z,{to:"/signatures/".concat(n.name)},null===(r=n.hostCount)||void 0===r?void 0:r.toLocaleString())},{title:n.isDisabled?"N/A":n.lastMatchDate?l().createElement(M.u,{content:l().createElement(y.Z,{date:new Date(n.lastMatchDate),type:"exact"})},l().createElement("span",null,l().createElement(y.Z,{date:new Date(n.lastMatchDate)}))):l().createElement(M.u,{content:T.formatMessage(P.Z.noHostHas)},l().createElement("span",null,T.formatMessage(P.Z.never)))}]},{parent:2*t,sigData:n,fullWidth:!0,cells:[]}]})))})}),[T,J]),l().createElement(l().Fragment,null,l().createElement(O.Z,{pagination:{itemCount:(null==J||null===(r=J.rules)||void 0===r?void 0:r.totalCount)||0,page:ee,perPage:H.limit,onSetPage:function(e,t){ae(0,t)},onPerPageSelect:function(e,t){oe(0,t)},isCompact:!0},filterConfig:{items:ne},activeFiltersConfig:le}),K?l().createElement(F.Z,{columns:[{title:"",columnTransforms:[(0,p.A)("skeleton-expandable-column")]}].concat(Q),rowSize:H.limit,sortBy:z}):l().createElement(m.i,{className:"sigTable","aria-label":"Signature table",onCollapse:function(e,t,r){var a=(0,n.Z)(U),o=a[t+1].sigData;a[t]=I(I({},a[t]),{},{isOpen:r}),a[t+1].cells=[{title:l().createElement(A,{signature:o})}],W({type:"setRows",payload:a})},rows:U,cells:Q,onSort:function(e,t,r){return W({type:"setSortBy",payload:{index:t,direction:r},tableVars:{orderBy:$({index:t,direction:r}),offset:0}})},sortBy:(null==J||null===(o=J.rulesList)||void 0===o?void 0:o.length)>0?z:void 0,isStickyHeader:!0},l().createElement(h.x,null),l().createElement(v.R,null)),!K&&!X&&0===(null==J||null===(c=J.rules)||void 0===c?void 0:c.totalCount)&&l().createElement(E.Z,{className:"pf-c-card",icon:w.W1,variant:"large",title:T.formatMessage(P.Z.noResults),text:T.formatMessage(P.Z.noResultsMatch)}),X&&l().createElement(E.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),l().createElement(s.t,{itemCount:(null==J||null===(g=J.rules)||void 0===g?void 0:g.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:H.limit,page:ee,variant:s.a.bottom,onSetPage:ae,onPerPageSelect:oe}))};z.propTypes=g.R$;const U=z},19399:(e,t,r)=>{"use strict";r.d(t,{Z:()=>f});var n=r(23218),a=r(45697),o=r.n(a),s=r(93264),i=r.n(s),l=r(30893),c=r(86896),u=function(e){var t=e.isDisabled,r=e.hasMatch,a=e.displayMatch,o=void 0!==a&&a,s=(0,c.Z)();return o?i().createElement("div",null,r&&i().createElement(n._,{color:"red"},s.formatMessage(l.Z.matched)),!r&&i().createElement(n._,{color:"blue"},s.formatMessage(l.Z.notMatched))):i().createElement("div",null,t&&i().createElement(n._,null,s.formatMessage(l.Z.disabled)),!t&&i().createElement(n._,{color:"blue"},s.formatMessage(l.Z.enabled)))};u.propTypes={isDisabled:o().bool,hasMatch:o().bool,displayMatch:o().bool};const f=u},11521:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>Ee});var n=r(4942);function a(e,t,r,n,a,o,s){try{var i=e[o](s),l=i.value}catch(e){return void r(e)}i.done?t(l):Promise.resolve(l).then(n,a)}var o=r(70885),s=r(87757),i=r.n(s),l=r(93264),c=r.n(l),u=r(45987),f=r(43537),d=r(24273),p=r(41609),m=r.n(p),h=["tagFilters"];function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tagFilters,r=(0,u.Z)(e,h);m()(r.hostGroupFilter)&&delete r.hostGroupFilter,m()(r.osFilter)&&delete r.osFilter;var n=t?{tags:t.flatMap((function(e){return e.values.map((function(t){return{namespace:e.key,key:t.tagKey,value:t.value}}))}))}:{};return g(g({},r),n)},b=r(82644),E=r(29558),O=r(30319),w=r(1082),j=r(86379),M=r(30893),x=r(19399),P=r(35224),S=r(62410),Z=r(92397);function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var N=(0,b.Sn)(),D=navigator.language.slice(0,2),L=(0,E.d)({locale:D},N),T=function(e,t){return function(r){var n=r.INVENTORY_ACTION_TYPES,a=r.mergeWithEntities;return t().register(C({},a((0,O.zw)(n,e),{page:1,perPage:10,sortBy:{key:"totalMatches",direction:"desc"}})))}},k=[{title:L.formatMessage(M.Z.name),transforms:[(0,w.d)(30)],key:"displayName",sortBy:["DISPLAY_NAME"],renderFunc:function(e,t){return c().createElement(Z.Z,{to:"/systems/".concat(t)},e)}},{title:"Group",key:"groups",sortBy:["GROUP_NAME"],requiresDefault:!0,props:{isStatic:!1}},{title:"Tags",key:"tags",props:{width:10,isStatic:!0}},{title:"OS",key:"osVersion",sortBy:["OS_VERSION"],props:{width:10},renderFunc:function(e){return e?"RHEL ".concat(e):L.formatMessage(M.Z.dataNotAvailable)}},{title:L.formatMessage(M.Z.lastStatus),transforms:[(0,w.d)(10)],key:"hasMatch",sortBy:["HAS_MATCH"],renderFunc:function(e,t,r){var n=r.isDisabled;return c().createElement(x.Z,{isDisabled:n,hasMatch:e,displayMatch:!0})}},{title:L.formatMessage(M.Z.lastMatched),transforms:[(0,w.d)(10)],key:"lastMatchDate",sortBy:["LAST_MATCH_DATE"],renderFunc:function(e){return e?c().createElement(P.u,{content:c().createElement(S.Z,{date:new Date(e),type:"exact"})},c().createElement("span",null,c().createElement(S.Z,{date:new Date(e)}))):c().createElement(P.u,{content:L.formatMessage(M.Z.noHostHas)},c().createElement("span",null,L.formatMessage(M.Z.never)))}},{title:L.formatMessage(M.Z.totalMatches),transforms:[(0,w.d)(10),(0,j.u)({tooltip:L.formatMessage(M.Z.totalMatchesNote)})],key:"totalMatches",sortBy:["TOTAL_MATCHES"],renderFunc:function(e,t,r){var n=r.id;return c().createElement(Z.Z,{to:"/systems/".concat(n)},null==e?void 0:e.toLocaleString())}},{title:L.formatMessage(M.Z.lastScan),key:"lastScanDate",sortBy:["LAST_SCAN_DATE"],renderFunc:function(e){return c().createElement(P.u,{content:c().createElement(S.Z,{date:new Date(e),type:"exact"})},c().createElement("span",null,c().createElement(S.Z,{date:new Date(e)})))}}],R=function(e){return k.map((function(t){var r="string"==typeof t,n=e.find((function(e){return e.key===t.key}));return t.requiresDefault&&void 0===n?void 0:C(C(C({},r?{key:t}:t),n),{},{props:C(C({},null==n?void 0:n.props),null==t?void 0:t.props)})})).filter(Boolean)},A=function(e,t){return null==e?void 0:e.map((function(e){return"".concat(e,"_").concat(t)}))},B=function(e){return(k||[]).find((function(t){return t.key===e}))},F=[{label:"All",value:"All"},{label:"Matched",value:!0},{label:"Not Matched",value:!1}],G=r(85893),I=r(45697),V=r.n(I),H=r(59823),$=r(28216),q=r(14938);const z=function(e){var t=e.component,r=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}(e,["component"]);return(0,l.useEffect)((function(){console.error("Unable to load inventory component. Failed to load ".concat(t,"."),r)}),[]),(0,G.jsxs)("div",{children:[(0,G.jsx)("h1",{children:"Unable to load inventory component"}),(0,G.jsxs)("h2",{children:["Failed to load ",t]}),(0,G.jsx)("code",{children:"More info can be found in browser console output."})]})};var U=r(94184),W=r.n(U),Y=r(62012),J=r(55140),K=function(){return(K=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},X=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r},Q=function(e){var t=e.Component,r=X(e,["Component"]),n=Y.useHistory();return(0,G.jsx)(t,K({history:n},r))},ee=function(e){var t=e.Component,r=X(e,["Component"]),n=(0,J.Z)().chromeHistory;return(0,G.jsx)(t,K({history:n},r))};const te=c().forwardRef((function(e,t){var r=e.Component,n=X(e,["Component"]),a=(0,l.useMemo)((function(){return"function"==typeof Y.useHistory?Q:ee}),[r,n]);return(0,G.jsx)(a,K({innerRef:t,Component:r},n))}));var re=function(){return(re=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)},ne=function(e){var t=(0,$.useStore)(),r=e.component;return(0,G.jsx)(r,re({className:W()(e.className,"inventory")},{children:(0,G.jsx)(l.Suspense,re({fallback:e.fallback},{children:(0,G.jsx)(H.ScalprumComponent,re({history:e.history,store:t,appName:"inventory",module:"./InventoryTable",scope:"inventory",ErrorComponent:(0,G.jsx)(z,re({component:"InventoryDetailHead"},e)),ref:e.innerRef},e))}))}))};ne.propTypes={fallback:V().node,innerRef:V().object,component:V().string,className:V().string,history:V().object};var ae=c().forwardRef((function(e,t){return(0,G.jsx)(ne,re({innerRef:t},e))}));ae.propTypes={fallback:V().node,component:V().string,className:V().string},ae.defaultProps={fallback:(0,G.jsx)(q.Bullseye,re({className:"pf-u-p-lg"},{children:(0,G.jsx)(q.Spinner,{size:"xl"})})),component:"section"};const oe=c().forwardRef((function(e,t){return(0,G.jsx)(te,re({innerRef:t,Component:ae},e))}));var se=r(84580),ie=r(51957),le=r(80810),ce=r(70044),ue=r(67463),fe=r(82779),de=r(86896),pe=r(88676),me=r(83237);const he=function(e,t){return{label:"Status",type:me.Y.radio,filterValues:{onChange:function(e,r){var n=parseInt(r);t("2"===r?F[n].value:r)},items:F,value:e,placeholder:"Filter by status"}}};var ve=function(e,t){return{filters:(r=e,a=[],r&&(a=a.concat([{category:"Status",id:"Status",chips:(n=F.find((function(e){return e.value===r.filterValues.value})),n?[{name:n.label,value:r.filterValues.value,id:n.value}]:[])}])),a),onDelete:function(e,r,n){n?t(!0):r.map((function(e){"Status"===e.category&&t("All")}))},showDeleteButton:!0};var r,n,a};function ge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ye(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ge(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var be=function(){var e,t=(0,l.useRef)(null),r=(0,de.Z)(),n=(0,l.useContext)(O.gE).getRegistry,s=(0,$.useDispatch)(),u=(0,l.useState)(!0),p=(0,o.Z)(u,2),m=p[0],h=p[1];(0,l.useEffect)((function(){var e;s({type:"INVENTORY_INIT"}),s({type:"RESET_PAGE"}),null==t||null===(e=t.current)||void 0===e||e.onRefreshData()}),[s]);var v,b,E,w,j,x=(0,l.useCallback)((v={query:se.c5},b=v.query,E=v.onComplete,w=v.onError,j=function(){var e=l.useContext((0,d.K)()).client;return __DEV__?(0,f.kG)(e,"No Apollo Client instance can be found. Please ensure that you have called `ApolloProvider` higher up in your tree."):(0,f.kG)(e,33),e}(),function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return j.query({query:b,fetchResults:!0,fetchPolicy:"no-cache",variables:g({limit:e,offset:t},r)}).then((function(e){var t,n=e.data,a={entities:(null==n?void 0:n.hostsList)||[],meta:g(g({},r.tags&&{tags:r.tags}),{},{totalCount:(null==n||null===(t=n.hosts)||void 0===t?void 0:t.totalCount)||0})};return null==E||E(a),a})).catch((function(e){if(w)return w(e),{entities:[],meta:{totalCount:0}};throw e}))}),[]),P=(null===(e=he(m,h))||void 0===e?void 0:e.filterValues).value;return c().createElement(c().Fragment,null,c().createElement(ce.bZ,{isInline:!0,variant:"info",ouiaId:"SystemsListIsDifferentAlert",title:r.formatMessage(M.Z.systemsListIsDifferent)}),c().createElement(oe,{isFullView:!0,autoRefresh:!0,initialLoading:!0,hideFilters:{all:!0,name:!1,tags:!1,operatingSystem:!1,hostGroupFilter:!1},columns:R,hasCheckbox:!1,showTags:!0,ref:t,fallback:c().createElement(ue.Spinner,null),onLoad:T(k,n),getEntities:function(){var e,t=(e=i().mark((function e(t,r){var n,a,o,s,l,c,u,f,d,p,m,h,v,g,b;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.page,a=void 0===n?1:n,o=r.per_page,s=r.orderBy,l=r.orderDirection,c=r.filters,"All"===P?delete c.hasMatch:c=ye(ye({},c),{},{hasMatch:P}),u=B(s),f=A(null==u?void 0:u.sortBy,l),d=y(c),p=o,m=a*o-o,e.next=9,x(p,m,ye(ye({},d),{},{orderBy:f}));case 9:return h=e.sent,g=(v=h||{}).entities,b=v.meta.totalCount,e.abrupt("return",{results:g.map((function(e){return ye(ye({},e),{},{display_name:e.displayName})})),orderBy:s,orderDirection:l,total:b});case 12:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var s=e.apply(t,r);function i(e){a(s,n,o,i,l,"next",e)}function l(e){a(s,n,o,i,l,"throw",e)}i(void 0)}))});return function(e,r){return t.apply(this,arguments)}}(),tableProps:{canSelectAll:!1,className:"sysTable",isStickyHeader:!0},noSystemsTable:c().createElement(ie.Z,{className:"pf-c-card",icon:le.W1,variant:"large",title:r.formatMessage(M.Z.noResults),text:r.formatMessage(M.Z.noResultsMatch)}),customFilters:{malwareParams:ye({},(0,pe.Rm)()),params:m},filterConfig:{items:[he(m,h)]},activeFiltersConfig:ve(he(m,h),h)}))};be.propTypes=fe.R$;const Ee=be},41609:(e,t,r)=>{var n=r(280),a=r(64160),o=r(35694),s=r(1469),i=r(98612),l=r(44144),c=r(25726),u=r(36719),f=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(i(e)&&(s(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||u(e)||o(e)))return!e.length;var t=a(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!n(e).length;for(var r in e)if(f.call(e,r))return!1;return!0}},35666:e=>{var t=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",i=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var a=t&&t.prototype instanceof v?t:v,o=Object.create(a.prototype),s=new Z(n||[]);return o._invoke=function(e,t,r){var n=f;return function(a,o){if(n===p)throw new Error("Generator is already running");if(n===m){if("throw"===a)throw o;return C()}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var i=x(s,r);if(i){if(i===h)continue;return i}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var l=u(e,t,r);if("normal"===l.type){if(n=r.done?m:d,l.arg===h)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n=m,r.method="throw",r.arg=l.arg)}}}(e,r,s),o}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",m="completed",h={};function v(){}function g(){}function y(){}var b={};b[o]=function(){return this};var E=Object.getPrototypeOf,O=E&&E(E(_([])));O&&O!==r&&n.call(O,o)&&(b=O);var w=y.prototype=v.prototype=Object.create(b);function j(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function M(e,t){function r(a,o,s,i){var l=u(e[a],e,o);if("throw"!==l.type){var c=l.arg,f=c.value;return f&&"object"==typeof f&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,s,i)}),(function(e){r("throw",e,s,i)})):t.resolve(f).then((function(e){c.value=e,s(c)}),(function(e){return r("throw",e,s,i)}))}i(l.arg)}var a;this._invoke=function(e,n){function o(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(o,o):o()}}function x(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method))return h;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var a=u(n,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,h;var o=a.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function P(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Z(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(P,this),this.reset(!0)}function _(e){if(e){var r=e[o];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,s=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}return{next:C}}function C(){return{value:t,done:!0}}return g.prototype=w.constructor=y,y.constructor=g,g.displayName=l(y,i,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,i,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},j(M.prototype),M.prototype[s]=function(){return this},e.AsyncIterator=M,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var s=new M(c(t,r,n,a),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},j(w),l(w,i,"Generator"),w[o]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=_,Z.prototype={constructor:Z,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function a(n,a){return i.type="throw",i.arg=e,r.next=n,a&&(r.method="next",r.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],i=s.completion;if("root"===s.tryLoc)return a("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(l&&c){if(this.prev<s.catchLoc)return a(s.catchLoc,!0);if(this.prev<s.finallyLoc)return a(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return a(s.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return a(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;S(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:_(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),h}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}},32857:()=>{},3162:()=>{},10108:()=>{},28992:()=>{},30187:()=>{},21626:()=>{},21064:()=>{},82014:()=>{},93398:()=>{},46928:()=>{},91993:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},67761:()=>{},87234:()=>{}}]);
//# sourceMappingURL=../sourcemaps/SigTable.5827a1932527c80be8b26f609ac859d1.js.map