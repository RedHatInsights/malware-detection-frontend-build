(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[982],{73027:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});var n=a(94015),r=a.n(n),l=a(23645),o=a.n(l)()(r());o.push([e.id,".malware .pf-c-code-editor__main{height:250px;overflow:scroll}.malware .ins-l-detailBlockHeader{font-weight:var(--pf-global--FontWeight--semi-bold)}\n","",{version:3,sources:["webpack://./src/Routes/Signatures/Details.scss"],names:[],mappings:"AAAA,iCACwB,YAAY,CAAC,eAAe,CADpD,kCAC8E,mDAAmD",sourcesContent:[".malware{\n.pf-c-code-editor__main{height:250px;overflow:scroll}.ins-l-detailBlockHeader{font-weight:var(--pf-global--FontWeight--semi-bold)}\n\n}"],sourceRoot:""}]);const s=o},77170:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>q}),a(90974);var n=a(50693),r=a(16475),l=a(60485),o=a(69291),s=a(45697),c=a.n(s),i=a(97522),u=a.n(i),m=function(e){var t=e.items,a=t.pop();return u().createElement(o.Breadcrumb,null,t.map((function(e,t){return u().createElement(o.BreadcrumbItem,{key:t,to:e.to},e.name)})),u().createElement(o.BreadcrumbItem,{isActive:!0},a.name))};m.propTypes={items:c().array};const f=m;var d=a(74153),p=a(62410),g=a(14203),v=a(45134),h=a(86350),E=a(48716),y=a(319),b=a.n(y),w=a(63038),C=a.n(w),Z=a(59713),D=a.n(Z),M=a(71070),A=a(38800),P=a(62480),O=a(7732),S=a(1082),B=a(3351),N=a(6934),H=a(22860),_=a(68778),T=a(49148),j=a(57277),x=a(80810),V=a(18623),k=a(86896),L=a(46829);function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function F(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){D()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var I={1:"HOSTNAME",2:"LAST_SCAN_DATE",3:"MATCH_COUNT"},W=function(e){var t=e.index,a=e.direction;return"".concat(I[t],"_").concat(a===A.B.asc?"ASC":"DESC")},z=function(e,t){switch(t.type){case"setTableVars":return F(F({},e),{},{tableVars:F(F({},e.tableVars),t.payload)});case"setSortBy":return F(F({},e),{},{sortBy:t.payload,tableVars:F(F({},e.tableVars),t.tableVars)});case"setRows":return F(F({},e),{},{rows:t.payload})}return e},G=function(e){var t,a,n,r,l,o,s=e.ruleName,c=e.affectedCount,m=(0,k.Z)(),f={tableVars:{limit:10,offset:0,orderBy:"LAST_SCAN_DATE_ASC",hostName:"",ruleName:s},sortBy:{index:2,direction:A.B.asc},rows:[]},h=(0,i.useReducer)(z,F({},f)),E=C()(h,2),y=E[0],w=y.tableVars,Z=y.sortBy,D=y.rows,R=E[1],I=(0,L.useQuery)(g.I8,{variables:w}),G=I.data,Q=I.loading,Y=I.error,U=[{title:m.formatMessage(V.Z.name),cellFormatters:[P.zW],transforms:[O.p,(0,S.d)(45)]},{title:m.formatMessage(V.Z.status),transforms:[O.p]},{title:m.formatMessage(V.Z.totalMatches),transforms:[O.p]}],q=w.offset/w.limit+1,J=[{label:m.formatMessage(V.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return R({type:"setTableVars",payload:{hostName:t}})},value:w.hostName,placeholder:m.formatMessage(V.Z.filterBy,{field:m.formatMessage(V.Z.name).toLowerCase()})}}],K=function(e,t){return R({type:"setTableVars",payload:{offset:t*w.limit-w.limit}})},X=function(e,t){return R({type:"setTableVars",payload:{limit:t,offset:0}})};return(0,i.useEffect)((function(){var e;R({type:"setRows",payload:function(e){return null==e?void 0:e.flatMap((function(e,t){var a=e;return[{rowId:t,isOpen:!1,cells:[{title:u().createElement("span",null,a.hostname)},{title:u().createElement(p.Z,{date:new Date(a.lastScanDate),type:"onlyDate"})},{title:u().createElement("span",null,a.matchCount)}]},{parent:2*t,hostData:a,fullWidth:!0,cells:[]}]}))}(null==G||null===(e=G.rulesList[0])||void 0===e?void 0:e.affectedHostsList)})}),[m,G]),u().createElement(u().Fragment,null,u().createElement(j.Z,{pagination:{itemCount:(null==G||null===(t=G.rulesList[0])||void 0===t||null===(a=t.affectedHosts)||void 0===a?void 0:a.totalCount)||0,page:q,perPage:w.limit,onSetPage:function(e,t){K(0,t)},onPerPageSelect:function(e,t){X(0,t)},isCompact:!0},filterConfig:{items:J}}),u().createElement(B.i,{className:"sigTable","aria-label":"Signature Details table",rows:D,cells:U,onCollapse:function(e,t,a){var n=b()(D),r=n[t+1].hostData;n[t]=F(F({},n[t]),{},{isOpen:a}),n[t+1].cells=[{title:u().createElement(d.Z,{code:"".concat(r.matches.map((function(e,t){return"Match Source: ".concat(e.source,"\nOffset:").concat(e.stringOffset,"\nMatch Data: ").concat(e.stringData,"\nMatch Identifier: ").concat(e.stringIdentifier,"\nMatch Scan Date: ").concat(new Date(e.scanDate),"\n").concat(r.matches.length>1&&t!==r.matches.length-1?"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n":"")})).join("")),isDownloadEnabled:!0,isCopyEnabled:!0})}],R({type:"setRows",payload:n})},onSort:function(e,t,a){return R({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:W({index:t,direction:a}),offset:0}})},sortBy:Z},u().createElement(N.x,null),u().createElement(H.R,null)),Q&&u().createElement(v.Z,{type:"table"}),Y||Q||0===c?!Q&&u().createElement(T.Z,{className:"pf-c-card",variant:"large",icon:_.ZP,iconClass:"ins-l-success-color",title:m.formatMessage(V.Z.noAffectedHosts),text:m.formatMessage(V.Z.noAffectedHostsBody)}):0===(null==G||null===(n=G.rulesList[0])||void 0===n||null===(r=n.affectedHosts)||void 0===r?void 0:r.totalCount)?u().createElement(T.Z,{className:"pf-c-card",icon:x.W1,variant:"large",title:m.formatMessage(V.Z.noResults),text:m.formatMessage(V.Z.noResultsMatch)}):u().createElement(u().Fragment,null),Y&&u().createElement(T.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),u().createElement(M.t,{itemCount:(null==G||null===(l=G.rulesList[0])||void 0===l||null===(o=l.affectedHosts)||void 0===o?void 0:o.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:w.limit,page:q,variant:M.a.bottom,onSetPage:K,onPerPageSelect:X}))};G.propTypes={ruleName:c().string,affectedCount:c().number};const Q=G;var Y=a(44852),U=a(55399);const q=function(){var e,t,a,o,s,c=(0,k.Z)(),i=(0,U.useParams)().id,m=[{name:c.formatMessage(V.Z.malwareDetection),to:"/insights/malware"},{name:i,to:"#"}],y=(0,L.useQuery)(g.c3,{variables:{ruleName:i}}),b=y.data,w=y.loading,C=null==b?void 0:b.rulesList[0],Z=function(e,t){return u().createElement(u().Fragment,null,u().createElement("p",{className:"ins-l-detailBlockHeader"},e),u().createElement("p",null,t))};return u().createElement(u().Fragment,null,u().createElement(E.Z,null,u().createElement(f,{items:m}),u().createElement(l.D,{headingLevel:"h1",size:l.H["3xl"]},i),u().createElement(n.r,{hasGutter:!0},u().createElement(r.P,{md:7,sm:12},C&&u().createElement(d.Z,{code:C.rawRule,language:"objective-c",isReadOnly:!0,isDownloadEnabled:!0,isCopyEnabled:!0})),w?u().createElement(v.Z,null):u().createElement(r.P,{md:5,sm:12},u().createElement(n.r,{hasGutter:!0},u().createElement(r.P,{span:6},Z(c.formatMessage(V.Z.lastmatch),null!=C&&C.lastMatchDate?u().createElement(p.Z,{date:new Date(C.lastMatchDate),type:"onlyDate"}):c.formatMessage(V.Z.never))),u().createElement(r.P,{span:6},Z(c.formatMessage(V.Z.hostmatch),u().createElement("span",null,"".concat(null==C||null===(e=C.affectedHosts)||void 0===e?void 0:e.totalCount,"/").concat(null==b||null===(t=b.hosts)||void 0===t?void 0:t.totalCount)))),u().createElement(r.P,{span:12},Z(c.formatMessage(V.Z.description),null==C||null===(a=C.metadata)||void 0===a?void 0:a.description)),u().createElement(r.P,{span:6},Z(c.formatMessage(V.Z.status),C&&u().createElement(Y.Z,C))),u().createElement(r.P,{span:6},Z(c.formatMessage(V.Z.author),null==C||null===(o=C.metadata)||void 0===o?void 0:o.author)))))),u().createElement(h.Z,null,u().createElement(l.D,{headingLevel:"h1",size:l.H["3xl"]},c.formatMessage(V.Z.affectedHosts)),u().createElement(Q,{ruleName:i,affectedCount:null==C||null===(s=C.affectedHosts)||void 0===s?void 0:s.totalCount})))}},90974:(e,t,a)=>{"use strict";var n=a(93379),r=a.n(n),l=a(73027),o=r()(l.default,{insert:"head",singleton:!1});if(!l.default.locals||e.hot.invalidate){var s=l.default.locals;e.hot.accept(73027,(t=>{l=a(73027),function(e,t,a){if(!e&&t||e&&!t)return!1;var n;for(n in e)if(e[n]!==t[n])return!1;for(n in t)if(!e[n])return!1;return!0}(s,l.default.locals)?(s=l.default.locals,o(l.default)):e.hot.invalidate()}))}e.hot.dispose((function(){o()})),l.default.locals}}]);
//# sourceMappingURL=Signature Details.8402993d080e0b41716f.js.map