(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[207],{38846:(e,t,a)=>{"use strict";a.d(t,{Z:()=>f});var r=a(99332),n=a(51957),s=a(88461),l=a(45697),i=a.n(l),o=a(93264),c=a.n(o),u=a(30893),d=a(86896),m=function(e){var t=e.code,a=e.language,l=e.isReadOnly,i=e.isDownloadEnabled,o=e.isCopyEnabled,m=e.height,f=void 0===m?"400px":m,p=(0,d.Z)();return c().createElement(s.p,{isDownloadEnabled:i,isCopyEnabled:o,isReadOnly:l,isLanguageLabelVisible:a,code:t,language:a,emptyState:c().createElement(n.Z,{className:"",icon:r.mB,variant:"small",title:p.formatMessage(u.Z.sigCompiled),text:p.formatMessage(u.Z.sigCompiledBody)}),height:f})};m.propTypes={code:i().any,language:i().string,isReadOnly:i().bool,isCopyEnabled:i().bool,isDownloadEnabled:i().bool,height:i().string},m.defaultProps={codeType:"Code"};const f=m},51957:(e,t,a)=>{"use strict";a.d(t,{Z:()=>f});var r=a(9947),n=a(38424),s=a(75106),l=a(76473),i=a(45697),o=a.n(i),c=a(93264),u=a.n(c),d=a(60485),m=function(e){var t=e.className,a=e.children,l=e.icon,i=e.iconClass,o=e.iconStyle,c=e.text,m=e.title,f=e.variant;return u().createElement(r.u,{className:t,variant:f},"none"!==l&&u().createElement(n.k,{className:i,style:o,icon:l}),u().createElement(d.D,{headingLevel:"h5",size:"lg"},m),u().createElement(s.B,{style:{marginBottom:"16px"}},c),a)};m.propTypes={children:o().any,icon:o().any,iconClass:o().any,iconStyle:o().any,text:o().any,title:o().string,variant:o().any,className:o().string},m.defaultProps={icon:l.ZP,title:"",variant:r.I.full};const f=m},58295:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>J});var r=a(42982),n=a(70885),s=a(4942),l=a(44733),i=a(93264),o=a.n(i),c=a(68868),u=a(62480),d=a(7732),m=a(1082),f=a(22546),p=a(3351),g=a(6934),v=a(22860),y=a(82779),b=a(62410),h=a(84580),E=a(51957),M=a(3962),Z=a(80810),D=a(19399),O=a(35224),S=a(69174),w=a(30893),P=a(88676),C=a(86896),_=a(90570),T=a(75709),j=a(90025),N=a(38846),A=a(50693),k=a(16475),B=a(45697),F=a.n(B),R=a(63540),L=function(e){var t=e.signature,a=(0,C.Z)(),r=(0,i.useState)(!1),s=(0,n.Z)(r,1)[0];return o().createElement(A.r,{hasGutter:!0},s&&o().createElement(k.P,{span:6},o().createElement(N.Z,{code:t.rawRule,isReadOnly:!0})),o().createElement(k.P,{span:s?6:12}," ",o().createElement(R.xv,{className:"ins-l-sigtable--title",component:R.qO.h6},a.formatMessage(w.Z.description)),t.metadata.description))};L.propTypes={signature:F().object};const V=L;var x=a(92397),G=a(80710);function I(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function H(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?I(Object(a),!0).forEach((function(t){(0,s.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var q={tableVars:{limit:10,offset:0,orderBy:"LAST_MATCH_DATE_NULLS_LAST_DESC",ruleName:""},sortBy:{index:5,direction:c.B.desc},rows:[],selectedSigs:[]},W={2:"NAME",3:"HAS_MATCH",4:"HOST_COUNT",5:"LAST_MATCH_DATE_NULLS_LAST"},Y=function(e){var t=e.index,a=e.direction;return"".concat(W[t],"_").concat(a===c.B.asc?"ASC":"DESC")},z=function(e,t){switch(t.type){case"setTableVars":return H(H({},e),{},{tableVars:H(H({},e.tableVars),t.payload)});case"setSortBy":return H(H({},e),{},{sortBy:t.payload,tableVars:H(H({},e.tableVars),t.tableVars)});case"setRows":return H(H({},e),{},{rows:t.payload});case"setSelectedSigs":return H(H({},e),{},{selectedSigs:t.payload})}return e},U=function(e){var t,a,s,c,y,N,A,k=e.refetchSigPageData,B=(0,C.Z)(),F=(0,i.useReducer)(z,H({},q)),R=(0,n.Z)(F,2),L=R[0],I=L.tableVars,W=L.sortBy,U=L.rows,J=L.selectedSigs,K=R[1],$=(0,i.useState)(!1),Q=(0,n.Z)($,2),X=Q[0],ee=Q[1],te=(0,_.a)(h.tE,{variables:H(H({},I),(0,j.l)(P.gG))}),ae=te.data,re=te.loading,ne=te.error,se=te.client,le={variables:{input:{id:J.map((function(e){return e.id}))}},onCompleted:function(){ee(!1),se.resetStore(),k(),K({type:"setSelectedSigs",payload:[]})}},ie=(0,T.D)(h.EK,le),oe=(0,n.Z)(ie,2),ce=oe[0],ue=oe[1].loading,de=(0,T.D)(h._g,le),me=(0,n.Z)(de,2),fe=me[0],pe=me[1].loading,ge=[{title:B.formatMessage(w.Z.sigName),cellFormatters:[u.zW],transforms:[d.p,(0,m.d)(55)]},{title:B.formatMessage(w.Z.lastStatus),transforms:[(0,m.d)(10),d.p]},{title:B.formatMessage(w.Z.systems),transforms:[(0,m.d)(10),d.p]},{title:B.formatMessage(w.Z.lastMatched),transforms:[(0,m.d)(10),d.p]}],ve=I.offset/I.limit+1,ye={items:{hasMatch:"true",isDisabled:["false"]},condition:{hasMatch:!0,isDisabled:!1}},be=["",{label:B.formatMessage(w.Z.enableSignaturesForAnalysis),onClick:function(){return ce(le)},props:{isDisabled:0===J.filter((function(e){return e.isDisabled})).length}},{label:B.formatMessage(w.Z.disableSignaturesFromAnalysis),onClick:function(){return fe(le)},props:{isDisabled:0===J.filter((function(e){return!e.isDisabled})).length}}],he={sig_match:{type:"radio",title:B.formatMessage(w.Z.status),urlParam:"sig_match",values:[{label:B.formatMessage(w.Z.all),value:"all"},{label:B.formatMessage(w.Z.matched),value:"true"},{label:B.formatMessage(w.Z.notMatched),value:"false"}]},sigs_enabled:{type:"checkbox",title:B.formatMessage(w.Z.signaturesEnabledFilter),urlParam:"sigs_enabled",values:[{label:B.formatMessage(w.Z.signaturesEnabled),value:"false"},{label:B.formatMessage(w.Z.signaturesDisabled),value:"true"}]}},Ee=[{label:B.formatMessage(w.Z.signature).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return K({type:"setTableVars",payload:{ruleName:t,offset:0}})},value:I.ruleName,placeholder:B.formatMessage(w.Z.filterBy,{field:B.formatMessage(w.Z.signature).toLowerCase()})}},{label:he.sig_match.title.toLowerCase(),type:he.sig_match.type,id:he.sig_match.urlParam,value:"radio-".concat(he.sig_match.urlParam),filterValues:{key:"".concat(he.sig_match.urlParam,"-filter"),onChange:function(e,t){var a=(0,P.gG)();(0,P.gG)({items:H(H({},a.items),{},{hasMatch:t}),condition:H(H({},a.condition),{},{hasMatch:"all"===t?void 0:JSON.parse(t)})})},value:(null===(t=(0,P.gG)().items)||void 0===t?void 0:t.hasMatch)||"true",items:he.sig_match.values}},{label:he.sigs_enabled.title.toLowerCase(),type:he.sigs_enabled.type,id:he.sigs_enabled.urlParam,filterValues:{key:"".concat(he.sigs_enabled.urlParam,"-filter"),onChange:function(e,t){var a=(0,P.gG)();(0,P.gG)({items:H(H({},a.items),{},{isDisabled:t}),condition:H(H({},a.condition),{},{isDisabled:1!==t.length?void 0:JSON.parse(t[0])})})},value:(null===(a=(0,P.gG)().items)||void 0===a?void 0:a.isDisabled)||["false"],items:he.sigs_enabled.values}}],Me=function(e,t){return K({type:"setTableVars",payload:{offset:t*I.limit-I.limit}})},Ze=function(e,t){return K({type:"setTableVars",payload:{limit:t,offset:0}})},De=function(e){var t=e.event,a=e.chips,r=void 0===a?[]:a,s=(0,P.gG)();if("add"===t){var l,i,o=B.formatMessage(w.Z.all);"true"===(null===(l=s.items)||void 0===l?void 0:l.hasMatch)?o=B.formatMessage(w.Z.matched):"false"===(null===(i=s.items)||void 0===i?void 0:i.hasMatch)&&(o=B.formatMessage(w.Z.notMatched)),r.push({category:B.formatMessage(w.Z.status),value:"matched",chips:[{name:o,value:o}]})}else if("remove"===t){var c,u="all"===(null===(c=s.items)||void 0===c?void 0:c.hasMatch)?["true",!0]:["all",void 0],d=(0,n.Z)(u,2),m=d[0],f=d[1];(0,P.gG)({items:H(H({},s.items),{},{hasMatch:m}),condition:H(H({},s.condition),{},{hasMatch:f})})}},Oe=function(e){var t,a=e.event,r=e.chips,s=void 0===r?[]:r,l=e.item,i=void 0===l?"":l,o=(0,P.gG)();if("add"===a)null===(t=o.items)||void 0===t||t.isDisabled.map((function(e){var t=B.formatMessage("true"===e?w.Z.signaturesDisabled:w.Z.signaturesEnabled);s.push({category:B.formatMessage(w.Z.signaturesEnabledFilter),value:t,chips:[{name:t,value:t}]})}));else if("remove"===a){var c,u=[],d=void 0;if(1!==(null===(c=o.items)||void 0===c?void 0:c.isDisabled.length)){var m=i.value===B.formatMessage(w.Z.signaturesEnabled)?[["true"],!0]:[["false"],!1],f=(0,n.Z)(m,2);u=f[0],d=f[1]}(0,P.gG)({items:H(H({},o.items),{},{isDisabled:u}),condition:H(H({},o.condition),{},{isDisabled:d})})}},Se={deleteTitle:B.formatMessage(w.Z.resetFilters),filters:(A=[],(null==I?void 0:I.ruleName)&&A.push({category:B.formatMessage(w.Z.signature),value:"name",chips:[{name:null==I?void 0:I.ruleName,value:null==I?void 0:I.ruleName}]}),De({event:"add",chips:A}),Oe({event:"add",chips:A}),A),showDeleteButton:!0,onDelete:function(e,t,a){a?((0,P.gG)(ye),K({type:"setTableVars",payload:{ruleName:""}})):t.map((function(e){"name"===e.value&&K({type:"setTableVars",payload:{ruleName:""}}),"matched"===e.value&&De({event:"remove"}),"name"!==e.value&&"matched"!==e.value&&Oe({event:"remove",item:e})}))}};return(0,i.useEffect)((function(){(0,P.gG)(ye)}),[]),(0,i.useEffect)((function(){var e,t,a=J.map((function(e){return e.id}));K({type:"setRows",payload:(e=ae,null==e||null===(t=e.rulesList)||void 0===t?void 0:t.flatMap((function(e,t){var r,n=e;return[{rowId:t,isOpen:!1,sigData:n,selected:a.includes(n.id),cells:[{title:o().createElement(o().Fragment,null,o().createElement(x.Z,{to:"/signatures/".concat(n.name)},n.name),n.isDisabled&&o().createElement(o().Fragment,null,o().createElement("br",null),o().createElement(S._,{color:"red",isCompact:!0},B.formatMessage(w.Z.disabled))))},{title:n.isDisabled?"N/A":o().createElement(D.Z,{isDisabled:n.isDisabled,hasMatch:n.hasMatch,displayMatch:!0})},{title:n.isDisabled?"N/A":o().createElement(x.Z,{to:"/signatures/".concat(n.name)},null===(r=n.hostCount)||void 0===r?void 0:r.toLocaleString())},{title:n.isDisabled?"N/A":n.lastMatchDate?o().createElement(O.u,{content:o().createElement(b.Z,{date:new Date(n.lastMatchDate),type:"exact"})},o().createElement("span",null,o().createElement(b.Z,{date:new Date(n.lastMatchDate)}))):o().createElement(O.u,{content:B.formatMessage(w.Z.noHostHas)},o().createElement("span",null,B.formatMessage(w.Z.never)))}]},{parent:2*t,fullWidth:!0,cells:[]}]})))}),ee(!0)}),[B,ae]),o().createElement(o().Fragment,null,o().createElement(M.Z,{pagination:{itemCount:(null==ae||null===(s=ae.rules)||void 0===s?void 0:s.totalCount)||0,page:ve,perPage:I.limit,onSetPage:function(e,t){Me(0,t)},onPerPageSelect:function(e,t){Ze(0,t)},isCompact:!0},filterConfig:{items:Ee},activeFiltersConfig:Se,actionsConfig:{actions:be,dropdownProps:{ouiaId:"toolbar-actions"}}}),ue||pe||!X?o().createElement(G.Z,{columns:[{title:"",columnTransforms:[(0,f.A)("skeleton-expandable-column")]}].concat(ge),rowSize:I.limit,sortBy:W,isSelectable:!0}):o().createElement(p.i,{className:"sigTable","aria-label":"Signature table",onCollapse:function(e,t,a){var n=(0,r.Z)(U),s=n[t].sigData;n[t]=H(H({},n[t]),{},{isOpen:a}),n[t+1].cells=[{title:o().createElement(V,{signature:s})}],K({type:"setRows",payload:n})},rows:U,cells:ge,onSort:function(e,t,a){return K({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:Y({index:t,direction:a}),offset:0}})},sortBy:(null==ae||null===(c=ae.rulesList)||void 0===c?void 0:c.length)>0?W:void 0,isStickyHeader:!0,canSelectAll:!0,onSelect:function(e,t,a){var n=(0,r.Z)(U);-1===a?n=n.map((function(e,a){return a%2==0?H(H({},e),{},{selected:t}):H({},e)})):n[a]=H(H({},n[a]),{},{selected:t});var s=n.filter((function(e){return e.selected})).map((function(e){return{id:e.sigData.id,name:e.sigData.name,isDisabled:e.sigData.isDisabled}}));K({type:"setRows",payload:n}),K({type:"setSelectedSigs",payload:s})},actionResolver:function(e,t){var a=t.rowIndex,r=U[a].sigData||null;if(r){var n=H(H({},le),{},{variables:{input:{id:r.id}}});return r.isDisabled?[{title:B.formatMessage(w.Z.enableSignatureForAnalysis),onClick:function(){return ce(n)}}]:[{title:B.formatMessage(w.Z.disableSignatureFromAnalysis),onClick:function(){return fe(n)}}]}}},o().createElement(g.x,null),o().createElement(v.R,null)),!re&&!ne&&0===(null==ae||null===(y=ae.rules)||void 0===y?void 0:y.totalCount)&&o().createElement(E.Z,{className:"pf-c-card",icon:Z.W1,variant:"large",title:B.formatMessage(w.Z.noResults),text:B.formatMessage(w.Z.noResultsMatch)}),ne&&o().createElement(E.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),o().createElement(l.t,{itemCount:(null==ae||null===(N=ae.rules)||void 0===N?void 0:N.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:I.limit,page:ve,variant:l.a.bottom,onSetPage:Me,onPerPageSelect:Ze}))};U.propTypes=y.R$;const J=U},19399:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d});var r=a(23218),n=a(45697),s=a.n(n),l=a(93264),i=a.n(l),o=a(30893),c=a(86896),u=function(e){var t=e.isDisabled,a=e.hasMatch,n=e.displayMatch,s=void 0!==n&&n,l=(0,c.Z)();return s?i().createElement("div",null,a&&i().createElement(r._,{color:"red"},l.formatMessage(o.Z.matched)),!a&&i().createElement(r._,{color:"blue"},l.formatMessage(o.Z.notMatched))):i().createElement("div",null,t&&i().createElement(r._,null,l.formatMessage(o.Z.disabled)),!t&&i().createElement(r._,{color:"blue"},l.formatMessage(o.Z.enabled)))};u.propTypes={isDisabled:s().bool,hasMatch:s().bool,displayMatch:s().bool};const d=u},76822:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>te});var r=a(4942),n=a(15861),s=a(70885),l=a(87757),i=a.n(l),o=a(93264),c=a.n(o),u=a(45987),d=a(26075),m=a(41609),f=a.n(m),p=["tagFilters"];function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){(0,r.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.tagFilters,a=(0,u.Z)(e,p);f()(a.hostGroupFilter)&&delete a.hostGroupFilter,f()(a.osFilter)&&delete a.osFilter;var r=t?{tags:t.flatMap((function(e){return e.values.map((function(t){return{namespace:e.key,key:t.tagKey,value:t.value}}))}))}:{};return v(v({},a),r)},b=a(82644),h=a(29558),E=a(30319),M=a(1082),Z=a(86379),D=a(30893),O=a(19399),S=a(35224),w=a(62410),P=a(92397);function C(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?C(Object(a),!0).forEach((function(t){(0,r.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var T=(0,b.Sn)(),j=navigator.language.slice(0,2),N=(0,h.d)({locale:j},T),A=function(e,t){return function(a){var r=a.INVENTORY_ACTION_TYPES,n=a.mergeWithEntities;return t().register(_({},n((0,E.zw)(r,e),{page:1,perPage:10,sortBy:{key:"totalMatches",direction:"desc"}})))}},k=[{title:N.formatMessage(D.Z.name),transforms:[(0,M.d)(30)],key:"displayName",sortBy:["DISPLAY_NAME"],renderFunc:function(e,t){return c().createElement(P.Z,{to:"/systems/".concat(t)},e)}},{title:"Group",key:"groups",sortBy:["GROUP_NAME"],requiresDefault:!0,props:{isStatic:!1}},{title:"Tags",key:"tags",props:{width:10,isStatic:!0}},{title:"OS",key:"osVersion",sortBy:["OS_VERSION"],props:{width:10},renderFunc:function(e){return e?"RHEL ".concat(e):N.formatMessage(D.Z.dataNotAvailable)}},{title:N.formatMessage(D.Z.lastStatus),transforms:[(0,M.d)(10)],key:"hasMatch",sortBy:["HAS_MATCH"],renderFunc:function(e,t,a){var r=a.isDisabled;return c().createElement(O.Z,{isDisabled:r,hasMatch:e,displayMatch:!0})}},{title:N.formatMessage(D.Z.lastMatched),transforms:[(0,M.d)(10)],key:"lastMatchDate",sortBy:["LAST_MATCH_DATE"],renderFunc:function(e){return e?c().createElement(S.u,{content:c().createElement(w.Z,{date:new Date(e),type:"exact"})},c().createElement("span",null,c().createElement(w.Z,{date:new Date(e)}))):c().createElement(S.u,{content:N.formatMessage(D.Z.noHostHas)},c().createElement("span",null,N.formatMessage(D.Z.never)))}},{title:N.formatMessage(D.Z.totalMatches),transforms:[(0,M.d)(10),(0,Z.u)({tooltip:N.formatMessage(D.Z.totalMatchesNote)})],key:"totalMatches",sortBy:["TOTAL_MATCHES"],renderFunc:function(e,t,a){var r=a.id;return c().createElement(P.Z,{to:"/systems/".concat(r)},null==e?void 0:e.toLocaleString())}},{title:N.formatMessage(D.Z.lastScan),key:"lastScanDate",sortBy:["LAST_SCAN_DATE"],renderFunc:function(e){return c().createElement(S.u,{content:c().createElement(w.Z,{date:new Date(e),type:"exact"})},c().createElement("span",null,c().createElement(w.Z,{date:new Date(e)})))}}],B=function(e){return k.map((function(t){var a="string"==typeof t,r=e.find((function(e){return e.key===t.key}));return t.requiresDefault&&void 0===r?void 0:_(_(_({},a?{key:t}:t),r),{},{props:_(_({},null==r?void 0:r.props),null==t?void 0:t.props)})})).filter(Boolean)},F=function(e,t){return null==e?void 0:e.map((function(e){return"".concat(e,"_").concat(t)}))},R=function(e){return(k||[]).find((function(t){return t.key===e}))},L=[{label:"All",value:"All"},{label:"Matched",value:!0},{label:"Not Matched",value:!1}],V=a(63652),x=a(84580),G=a(51957),I=a(80810),H=a(70044),q=a(67463),W=a(82779),Y=a(86896),z=a(88676),U=a(28216),J=a(83237);const K=function(e,t){return{label:"Status",type:J.Y.radio,filterValues:{onChange:function(e,a){var r=parseInt(a);t("2"===a?L[r].value:a)},items:L,value:e,placeholder:"Filter by status"}}};var $=function(e,t){return{filters:(a=e,n=[],a&&(n=n.concat([{category:"Status",id:"Status",chips:(r=L.find((function(e){return e.value===a.filterValues.value})),r?[{name:r.label,value:a.filterValues.value,id:r.value}]:[])}])),n),onDelete:function(e,a,r){r?t(!0):a.map((function(e){"Status"===e.category&&t("All")}))},showDeleteButton:!0};var a,r,n};function Q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function X(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(a),!0).forEach((function(t){(0,r.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Q(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ee=function(){var e,t=(0,o.useRef)(null),a=(0,Y.Z)(),r=(0,o.useContext)(E.gE).getRegistry,l=(0,U.useDispatch)(),u=(0,o.useState)(!0),m=(0,s.Z)(u,2),f=m[0],p=m[1];(0,o.useEffect)((function(){var e;l({type:"INVENTORY_INIT"}),l({type:"RESET_PAGE"}),null==t||null===(e=t.current)||void 0===e||e.onRefreshData()}),[l]);var g,b,h,M,Z,O=(0,o.useCallback)((g={query:x.c5},b=g.query,h=g.onComplete,M=g.onError,Z=(0,d.x)(),function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Z.query({query:b,fetchResults:!0,fetchPolicy:"no-cache",variables:v({limit:e,offset:t},a)}).then((function(e){var t,r=e.data,n={entities:(null==r?void 0:r.hostsList)||[],meta:v(v({},a.tags&&{tags:a.tags}),{},{totalCount:(null==r||null===(t=r.hosts)||void 0===t?void 0:t.totalCount)||0})};return null==h||h(n),n})).catch((function(e){if(M)return M(e),{entities:[],meta:{totalCount:0}};throw e}))}),[]),S=(null===(e=K(f,p))||void 0===e?void 0:e.filterValues).value;return c().createElement(c().Fragment,null,c().createElement(H.bZ,{isInline:!0,variant:"info",ouiaId:"SystemsListIsDifferentAlert",title:a.formatMessage(D.Z.systemsListIsDifferent)}),c().createElement(V.Z,{isFullView:!0,autoRefresh:!0,initialLoading:!0,hideFilters:{all:!0,name:!1,tags:!1,operatingSystem:!1,hostGroupFilter:!1},columns:B,hasCheckbox:!1,showTags:!0,ref:t,fallback:c().createElement(q.Spinner,null),onLoad:A(k,r),getEntities:function(){var e=(0,n.Z)(i().mark((function e(t,a){var r,n,s,l,o,c,u,d,m,f,p,g,v,b,h;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.page,n=void 0===r?1:r,s=a.per_page,l=a.orderBy,o=a.orderDirection,c=a.filters,"All"===S?delete c.hasMatch:c=X(X({},c),{},{hasMatch:S}),u=R(l),d=F(null==u?void 0:u.sortBy,o),m=y(c),f=s,p=n*s-s,e.next=9,O(f,p,X(X({},m),{},{orderBy:d}));case 9:return g=e.sent,b=(v=g||{}).entities,h=v.meta.totalCount,e.abrupt("return",{results:b.map((function(e){return X(X({},e),{},{display_name:e.displayName})})),orderBy:l,orderDirection:o,total:h});case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),tableProps:{canSelectAll:!1,className:"sysTable",isStickyHeader:!0},noSystemsTable:c().createElement(G.Z,{className:"pf-c-card",icon:I.W1,variant:"large",title:a.formatMessage(D.Z.noResults),text:a.formatMessage(D.Z.noResultsMatch)}),customFilters:{malwareParams:X({},(0,z.Rm)()),params:f},filterConfig:{items:[K(f,p)]},activeFiltersConfig:$(K(f,p),p)}))};ee.propTypes=W.R$;const te=ee},32857:()=>{},3162:()=>{},10108:()=>{},28992:()=>{},30187:()=>{},21626:()=>{},21064:()=>{},82014:()=>{},93398:()=>{},46928:()=>{},91993:()=>{},54994:()=>{},44690:()=>{},37494:()=>{},67761:()=>{},87234:()=>{}}]);
//# sourceMappingURL=../sourcemaps/SigTable.eeef691162ec133a28257134522f9069.js.map