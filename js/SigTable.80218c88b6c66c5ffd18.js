(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[207],{54838:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>H});var l=a(85061),r=a(28481),s=a(96156),n=(a(13111),a(50693)),o=a(16475),i=a(71070),c=a(93264),u=a.n(c),m=a(38800),f=a(62480),d=a(1082),p=a(7732),g=a(3351),h=a(6934),v=a(22860),y=a(63540),b=a(38846),M=a(62410),E=a(84580),Z=a(16530),w=a(52661),C=a(51957),D=a(57277),O=a(80810),S=a(19399),P=a(35224),_=a(82779),T=a(30893),A=a(88676),N=a(86896),V=a(46829);function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,l)}return a}function R(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(Object(a),!0).forEach((function(t){(0,s.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var j={tableVars:{limit:10,offset:0,orderBy:"LAST_MATCH_DATE_DESC",ruleName:""},sortBy:{index:4,direction:m.B.desc},rows:[]},k={1:"NAME",2:"HAS_MATCH",3:"IS_DISABLED",4:"HOST_COUNT",5:"LAST_MATCH_DATE"},x=function(e){var t=e.index,a=e.direction;return"".concat(k[t],"_").concat(a===m.B.asc?"ASC":"DESC")},G=function(e,t){switch(t.type){case"setTableVars":return R(R({},e),{},{tableVars:R(R({},e.tableVars),t.payload)});case"setSortBy":return R(R({},e),{},{sortBy:t.payload,tableVars:R(R({},e.tableVars),t.tableVars)});case"setRows":return R(R({},e),{},{rows:t.payload})}return e},L=function(){var e,t,a,s,m,_,B,k,L=(0,N.Z)(),H=(0,c.useReducer)(G,R({},j)),F=(0,r.Z)(H,2),W=F[0],I=W.tableVars,J=W.sortBy,q=W.rows,z=F[1],Q=(0,V.useQuery)(E.tE,{variables:R(R({},I),(0,V.useReactiveVar)(A.gG))}),U=Q.data,$=Q.loading,K=Q.error,X=[{title:L.formatMessage(T.Z.sigName),cellFormatters:[f.zW],transforms:[(0,d.d)(45),p.p]},{title:L.formatMessage(T.Z.status),transforms:[p.p]},{title:L.formatMessage(T.Z.enabled),transforms:[p.p]},{title:L.formatMessage(T.Z.systems),transforms:[p.p]},{title:L.formatMessage(T.Z.matched),transforms:[p.p]}],Y=I.offset/I.limit+1,ee={sig_match:{type:"radio",title:L.formatMessage(T.Z.status),urlParam:"sig_match",values:[{label:L.formatMessage(T.Z.all),value:"all"},{label:L.formatMessage(T.Z.matched),value:"true"},{label:L.formatMessage(T.Z.notMatched),value:"false"}]}},te=[{label:L.formatMessage(T.Z.signature).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return z({type:"setTableVars",payload:{ruleName:t}})},value:I.ruleName,placeholder:L.formatMessage(T.Z.filterBy,{field:L.formatMessage(T.Z.signature).toLowerCase()})}},{label:ee.sig_match.title.toLowerCase(),type:ee.sig_match.type,id:ee.sig_match.urlParam,value:"radio-".concat(ee.sig_match.urlParam),filterValues:{key:"".concat(ee.sig_match.urlParam,"-filter"),onChange:function(e,t){var a=(0,A.gG)();"all"===t&&(null==a||delete a.condition),"all"===t?(0,A.gG)(R({},a)):(0,A.gG)(R(R({},a),{},{condition:{hasMatch:JSON.parse(t)}}))},value:JSON.stringify(null===(e=(0,A.gG)().condition)||void 0===e?void 0:e.hasMatch)||"all",items:ee.sig_match.values}}],ae=function(e,t){return z({type:"setTableVars",payload:{offset:t*I.limit-I.limit}})},le=function(e,t){return z({type:"setTableVars",payload:{limit:t,offset:0}})},re={deleteTitle:L.formatMessage(T.Z.resetFilters),filters:(B=[],k=void 0!==(null===(m=(0,A.gG)().condition)||void 0===m?void 0:m.hasMatch)&&(null!==(_=(0,A.gG)().condition)&&void 0!==_&&_.hasMatch?L.formatMessage(T.Z.matched):L.formatMessage(T.Z.notMatched)),(null==I?void 0:I.ruleName)&&B.push({category:L.formatMessage(T.Z.signature),value:"name",chips:[{name:null==I?void 0:I.ruleName,value:null==I?void 0:I.ruleName}]}),k&&B.push({category:L.formatMessage(T.Z.status),value:"matched",chips:[{name:k,value:k}]}),B),onDelete:function(e,t,a){a?((0,A.gG)({}),z({type:"setTableVars",payload:{ruleName:""}})):t.map((function(e){"name"===e.value&&z({type:"setTableVars",payload:{ruleName:""}}),"matched"===e.value&&(0,A.gG)({})}))}};return(0,c.useEffect)((function(){var e,t;z({type:"setRows",payload:(e=U,null==e||null===(t=e.rulesList)||void 0===t?void 0:t.flatMap((function(e,t){var a=e;return[{rowId:t,isOpen:!1,cells:[{title:u().createElement(Z.Link,{to:"/".concat(a.name)},a.name)},{title:u().createElement(S.Z,{isDisabled:a.isDisabled,hasMatch:a.hasMatch,displayMatch:!0})},{title:u().createElement(S.Z,{isDisabled:a.isDisabled,hasMatch:a.hasMatch})},{title:u().createElement(Z.Link,{to:"/".concat(a.name)},a.hostCount)},{title:a.lastMatchDate?u().createElement(P.u,{content:u().createElement(M.Z,{date:new Date(a.lastMatchDate),type:"exact"})},u().createElement("span",null,u().createElement(M.Z,{date:new Date(a.lastMatchDate),type:"onlyDate"}))):u().createElement(P.u,{content:L.formatMessage(T.Z.noHostHas)},u().createElement("span",null,L.formatMessage(T.Z.never)))}]},{parent:2*t,sigData:a,fullWidth:!0,cells:[]}]})))})}),[L,U]),u().createElement(u().Fragment,null,u().createElement(D.Z,{pagination:{itemCount:(null==U||null===(t=U.rules)||void 0===t?void 0:t.totalCount)||0,page:Y,perPage:I.limit,onSetPage:function(e,t){ae(0,t)},onPerPageSelect:function(e,t){le(0,t)},isCompact:!0},filterConfig:{items:te},activeFiltersConfig:re}),u().createElement(g.i,{className:"sigTable","aria-label":"Signature table",onCollapse:function(e,t,a){var r=(0,l.Z)(q),s=r[t+1].sigData;r[t]=R(R({},r[t]),{},{isOpen:a}),r[t+1].cells=[{title:u().createElement(n.r,{hasGutter:!0},u().createElement(o.P,{span:6},u().createElement(b.Z,{code:s.rawRule,isReadOnly:!0})),u().createElement(o.P,{span:6}," ",u().createElement(y.xv,{className:"ins-l-sigtable--title",component:y.qO.h6},L.formatMessage(T.Z.description)),s.metadata.description))}],z({type:"setRows",payload:r})},rows:q,cells:X,onSort:function(e,t,a){return z({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:x({index:t,direction:a}),offset:0}})},sortBy:J,isStickyHeader:!0},u().createElement(h.x,null),u().createElement(v.R,null)),$&&u().createElement(w.Z,{type:"table"}),!$&&!K&&0===(null==U||null===(a=U.rules)||void 0===a?void 0:a.totalCount)&&u().createElement(C.Z,{className:"pf-c-card",icon:O.W1,variant:"large",title:L.formatMessage(T.Z.noResults),text:L.formatMessage(T.Z.noResultsMatch)}),K&&u().createElement(C.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),u().createElement(i.t,{itemCount:(null==U||null===(s=U.rules)||void 0===s?void 0:s.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:I.limit,page:Y,variant:i.a.bottom,onSetPage:ae,onPerPageSelect:le}))};L.propTypes=_.R$;const H=L},78286:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var l=a(94015),r=a.n(l),s=a(23645),n=a.n(s)()(r());n.push([e.id,".malware .ins-l-sigtable--title{font-weight:var(--pf-global--FontWeight--semi-bold)}\n","",{version:3,sources:["webpack://./src/Components/SigTable/SigTable.scss"],names:[],mappings:"AAAA,gCACuB,mDAAmD",sourcesContent:[".malware{\n.ins-l-sigtable--title{font-weight:var(--pf-global--FontWeight--semi-bold)}\n\n}"],sourceRoot:""}]);const o=n},13111:(e,t,a)=>{"use strict";var l=a(93379),r=a.n(l),s=a(78286),n=r()(s.default,{insert:"head",singleton:!1});if(!s.default.locals||e.hot.invalidate){var o=s.default.locals;e.hot.accept(78286,(t=>{s=a(78286),function(e,t,a){if(!e&&t||e&&!t)return!1;var l;for(l in e)if(e[l]!==t[l])return!1;for(l in t)if(!e[l])return!1;return!0}(o,s.default.locals)?(o=s.default.locals,n(s.default)):e.hot.invalidate()}))}e.hot.dispose((function(){n()})),s.default.locals}}]);
//# sourceMappingURL=../sourcemaps/SigTable.6ca1f104b107ce538321.js.map