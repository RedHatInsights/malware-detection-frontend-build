"use strict";(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[322],{21448:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});var n=a(50693),l=a(16475),r=a(60485),s=a(89837),o=a(62410),c=a(84580),i=a(52661),m=a(86350),u=a(48716),d=a(93264),f=a.n(d),p=a(93433),g=a(29439),h=a(4942),y=a(71070),E=a(38800),b=a(62480),M=a(7732),Z=a(1082),v=a(3351),D=a(6934),S=a(22860),w=a(68778),C=a(38846),P=a(82779),O=a(51957),T=a(66031),N=a(80810),B=a(19399),A=a(30893),x=a(45697),H=a.n(x),V=a(86896),j=a(70846);function _(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_(Object(a),!0).forEach((function(t){(0,h.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var R={1:"NAME",2:"LAST_STATUS",3:"LAST_MATCH_DATE",4:"MATCH_COUNT"},L=function(e){var t=e.index,a=e.direction;return"".concat(R[t],"_").concat(a===E.B.asc?"ASC":"DESC")},I=function(e,t){switch(t.type){case"setTableVars":return k(k({},e),{},{tableVars:k(k({},e.tableVars),t.payload)});case"setSortBy":return k(k({},e),{},{sortBy:t.payload,tableVars:k(k({},e.tableVars),t.tableVars)});case"setRows":return k(k({},e),{},{rows:t.payload})}return e},F=function(e){var t,a,n,l,r,s,m,u=e.systemId,h=(0,V.Z)(),x={tableVars:{limit:10,offset:0,orderBy:"LAST_MATCH_DATE_ASC",ruleName:"",systemId:u},sortBy:{index:2,direction:E.B.asc},rows:[]},H=(0,d.useReducer)(I,k({},x)),_=(0,g.Z)(H,2),R=_[0],F=R.tableVars,W=R.sortBy,z=R.rows,U=_[1],G=(0,j.a)(c.W0,{variables:F}),J=G.data,K=G.loading,q=G.error,Q=[{title:h.formatMessage(A.Z.sigName),cellFormatters:[b.zW],transforms:[M.p,(0,Z.d)(55)]},{title:h.formatMessage(A.Z.lastStatus),transforms:[(0,Z.d)(10),M.p]},{title:h.formatMessage(A.Z.matched),transforms:[M.p,(0,Z.d)(10)]},{title:f().createElement("span",null,(0,P.lH)({tooltip:h.formatMessage(A.Z.totalMatchesNote),title:h.formatMessage(A.Z.totalMatches)})),transforms:[M.p,(0,Z.d)(15)]}],X=F.offset/F.limit+1,Y=[{label:h.formatMessage(A.Z.sig).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return U({type:"setTableVars",payload:{ruleName:t,offset:0}})},value:F.ruleName,placeholder:h.formatMessage(A.Z.filterBy,{field:h.formatMessage(A.Z.sig).toLowerCase()})}}],$=function(e,t){return U({type:"setTableVars",payload:{offset:t*F.limit-F.limit}})},ee=function(e,t){return U({type:"setTableVars",payload:{limit:t,offset:0}})};return(0,d.useEffect)((function(){!K&&U({type:"setRows",payload:function(e){return null==e?void 0:e.host.affectedRulesList.flatMap((function(e,t){var a;return[{rowId:t,isOpen:!1,cells:[{title:f().createElement("span",null,e.name)},{title:f().createElement(B.Z,{isDisabled:e.isDisabled,hasMatch:e.lastStatus,displayMatch:!0})},{title:f().createElement(o.Z,{date:new Date(e.lastMatchDate),type:"onlyDate"})},{title:f().createElement("span",null,null===(a=e.matchCount)||void 0===a?void 0:a.toLocaleString())}]},{parent:2*t,hostData:e,fullWidth:!0,cells:[]}]}))}(J)})}),[h,J,K]),f().createElement(f().Fragment,null,f().createElement(T.Z,{pagination:{itemCount:(null==J||null===(t=J.host)||void 0===t||null===(a=t.affectedRules)||void 0===a?void 0:a.totalCount)||0,page:X,perPage:F.limit,onSetPage:function(e,t){$(0,t)},onPerPageSelect:function(e,t){ee(0,t)},isCompact:!0},filterConfig:{items:Y}}),f().createElement(v.i,{className:"sigTable","aria-label":"Signature Details table",rows:z,cells:Q,onCollapse:function(e,t,a){var n=(0,p.Z)(z),l=n[t+1].hostData;n[t]=k(k({},n[t]),{},{isOpen:a}),n[t+1].cells=[{title:f().createElement(C.Z,{height:"250px",code:"".concat(l.matches.map((function(e,t){return"Match Source: ".concat(e.source,"\nOffset:").concat(e.stringOffset,"\nMatch Data: ").concat(e.stringData,"\nMatch Identifier: ").concat(e.stringIdentifier,"\nMatch Scan Date: ").concat(new Date(e.scanDate).toUTCString(),"\n").concat(e.metadata?(0,P.Wi)(JSON.parse(e.metadata)):"","\n").concat(l.matches.length>1&&t!==l.matches.length-1?"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n":"")})).join("")),isDownloadEnabled:!0,isCopyEnabled:!0})}],U({type:"setRows",payload:n})},onSort:function(e,t,a){return U({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:L({index:t,direction:a}),offset:0}})},sortBy:W,isStickyHeader:!0},f().createElement(D.x,null),f().createElement(S.R,null)),K?f().createElement(i.Z,{type:"table"}):q?f().createElement(O.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}):null!=J&&null!==(n=J.host)&&void 0!==n&&n.lastMatchDate?0===(null==J||null===(l=J.host)||void 0===l||null===(r=l.affectedRules)||void 0===r?void 0:r.totalCount)?f().createElement(O.Z,{className:"pf-c-card",icon:N.W1,variant:"large",title:h.formatMessage(A.Z.noResults),text:h.formatMessage(A.Z.noResultsMatch)}):f().createElement(f().Fragment,null):f().createElement(O.Z,{className:"pf-c-card",variant:"large",icon:w.ZP,iconClass:"ins-l-success-color",title:h.formatMessage(A.Z.noAffectedHosts),text:h.formatMessage(A.Z.noAffectedHostsBody)}),f().createElement(y.t,{itemCount:(null==J||null===(s=J.host)||void 0===s||null===(m=s.affectedRules)||void 0===m?void 0:m.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:F.limit,page:X,variant:y.a.bottom,onSetPage:$,onPerPageSelect:ee}))};F.propTypes={systemId:H().string};const W=F;var z=a(75662);const U=function(){var e,t=(0,V.Z)(),a=(0,z.useParams)().id,d=[{name:t.formatMessage(A.Z.malwareDetectionSys),to:"".concat((0,P.hN)(),"/insights/malware/systems")},{name:a,to:"#"}],p=(0,j.a)(c.kK,{variables:{name:a}}),g=p.data,h=p.loading,y=null==g||null===(e=g.hosts)||void 0===e?void 0:e.nodes[0],E=function(e,t){return f().createElement(f().Fragment,null,f().createElement("p",{className:"ins-l-detailBlockHeader"},e),f().createElement("p",null,t))};return f().createElement(f().Fragment,null,f().createElement(u.Z,null,f().createElement(s.Z,{items:d}),f().createElement(r.D,{headingLevel:"h1",size:r.H["3xl"]},a),f().createElement(n.r,{hasGutter:!0},h?f().createElement(i.Z,null):f().createElement(l.P,{md:5,sm:12},f().createElement(n.r,{hasGutter:!0},f().createElement(l.P,{span:12},f().createElement("p",{className:"ins-l-detailBlockHeader"},"".concat(t.formatMessage(A.Z.uuid),": ").concat(y.id))),f().createElement(l.P,{span:4},E(t.formatMessage(A.Z.lastmatch),null!=y&&y.lastMatchDate?f().createElement(o.Z,{date:new Date(y.lastMatchDate),type:"onlyDate"}):t.formatMessage(A.Z.never))),f().createElement(l.P,{span:4},E(t.formatMessage(A.Z.lastScan),f().createElement(o.Z,{date:new Date(y.lastScanDate),type:"exact"}))),f().createElement(l.P,{span:4},E((0,P.lH)({tooltip:t.formatMessage(A.Z.totalMatchesNote),title:t.formatMessage(A.Z.totalMatches)}),null==y?void 0:y.totalMatches)))),f().createElement(l.P,{md:7,sm:0}))),f().createElement(m.Z,null,f().createElement(r.D,{className:"ins-l-tableBlockHeader",headingLevel:"h1",size:r.H["3xl"]},t.formatMessage(A.Z.matchedSignatures)),h?f().createElement(i.Z,null):f().createElement(W,{systemId:y.id})))}}}]);
//# sourceMappingURL=../sourcemaps/System Details.9c09173b12b4485b951c846c8a25f07e.js.map