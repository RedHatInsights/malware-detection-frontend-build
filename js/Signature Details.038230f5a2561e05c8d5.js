(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[982],{53830:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>G});var n=a(50693),l=a(16475),r=a(60485),o=a(89837),s=a(38846),c=a(62410),i=a(84580),u=a(52661),m=a(86350),d=a(48716),f=a(93264),p=a.n(f),g=a(85061),y=a(28481),E=a(96156),v=a(71070),h=a(38800),b=a(62480),Z=a(7732),w=a(1082),C=a(3351),M=a(6934),D=a(22860),P=a(68778),O=a(51957),S=a(57277),N=a(80810),H=a(30893),B=a(45697),L=a.n(B),x=a(86896),A=a(46829);function V(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?V(Object(a),!0).forEach((function(t){(0,E.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):V(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var T={1:"DISPLAY_NAME",2:"LAST_SCAN_DATE",3:"MATCH_COUNT"},_=function(e){var t=e.index,a=e.direction;return"".concat(T[t],"_").concat(a===h.B.asc?"ASC":"DESC")},k=function(e,t){switch(t.type){case"setTableVars":return j(j({},e),{},{tableVars:j(j({},e.tableVars),t.payload)});case"setSortBy":return j(j({},e),{},{sortBy:t.payload,tableVars:j(j({},e.tableVars),t.tableVars)});case"setRows":return j(j({},e),{},{rows:t.payload})}return e},R=function(e){var t,a,n,l,r,o,m=e.ruleName,d=e.affectedCount,E=(0,x.Z)(),B={tableVars:{limit:10,offset:0,orderBy:"LAST_SCAN_DATE_ASC",displayName:"",ruleName:m},sortBy:{index:2,direction:h.B.asc},rows:[]},L=(0,f.useReducer)(k,j({},B)),V=(0,y.Z)(L,2),T=V[0],R=T.tableVars,I=T.sortBy,F=T.rows,z=V[1],W=(0,A.useQuery)(i.I8,{variables:R}),G=W.data,Q=W.loading,U=W.error,Y=[{title:E.formatMessage(H.Z.name),cellFormatters:[b.zW],transforms:[Z.p,(0,w.d)(45)]},{title:E.formatMessage(H.Z.lastmatch),transforms:[Z.p]},{title:E.formatMessage(H.Z.totalMatches),transforms:[Z.p]}],q=R.offset/R.limit+1,J=[{label:E.formatMessage(H.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return z({type:"setTableVars",payload:{displayName:t}})},value:R.displayName,placeholder:E.formatMessage(H.Z.filterBy,{field:E.formatMessage(H.Z.name).toLowerCase()})}}],K=function(e,t){return z({type:"setTableVars",payload:{offset:t*R.limit-R.limit}})},X=function(e,t){return z({type:"setTableVars",payload:{limit:t,offset:0}})};return(0,f.useEffect)((function(){var e;z({type:"setRows",payload:function(e){return null==e?void 0:e.flatMap((function(e,t){var a,n=e;return[{rowId:t,isOpen:!1,cells:[{title:p().createElement("span",null,n.displayName)},{title:p().createElement(c.Z,{date:new Date(n.lastScanDate),type:"onlyDate"})},{title:p().createElement("span",null,null===(a=n.matchCount)||void 0===a?void 0:a.toLocaleString())}]},{parent:2*t,hostData:n,fullWidth:!0,cells:[]}]}))}(null==G||null===(e=G.rulesList[0])||void 0===e?void 0:e.affectedHostsList)})}),[E,G]),p().createElement(p().Fragment,null,p().createElement(S.Z,{pagination:{itemCount:(null==G||null===(t=G.rulesList[0])||void 0===t||null===(a=t.affectedHosts)||void 0===a?void 0:a.totalCount)||0,page:q,perPage:R.limit,onSetPage:function(e,t){K(0,t)},onPerPageSelect:function(e,t){X(0,t)},isCompact:!0},filterConfig:{items:J}}),p().createElement(C.i,{className:"sigTable","aria-label":"Signature Details table",rows:F,cells:Y,onCollapse:function(e,t,a){var n=(0,g.Z)(F),l=n[t+1].hostData;n[t]=j(j({},n[t]),{},{isOpen:a}),n[t+1].cells=[{title:p().createElement(s.Z,{height:"250px",code:"".concat(l.matches.map((function(e,t){return"Match Source: ".concat(e.source,"\nOffset:").concat(e.stringOffset,"\nMatch Data: ").concat(e.stringData,"\nMatch Identifier: ").concat(e.stringIdentifier,"\nMatch Scan Date: ").concat(new Date(e.scanDate),"\n").concat(e.metadata?"Metadata:".concat(e.metadata):"","\n").concat(l.matches.length>1&&t!==l.matches.length-1?"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n":"")})).join("")),isDownloadEnabled:!0,isCopyEnabled:!0})}],z({type:"setRows",payload:n})},onSort:function(e,t,a){return z({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:_({index:t,direction:a}),offset:0}})},sortBy:I,isStickyHeader:!0},p().createElement(M.x,null),p().createElement(D.R,null)),Q&&p().createElement(u.Z,{type:"table"}),U||Q||0===d?!Q&&p().createElement(O.Z,{className:"pf-c-card",variant:"large",icon:P.ZP,iconClass:"ins-l-success-color",title:E.formatMessage(H.Z.noAffectedHosts),text:E.formatMessage(H.Z.noAffectedHostsBody)}):0===(null==G||null===(n=G.rulesList[0])||void 0===n||null===(l=n.affectedHosts)||void 0===l?void 0:l.totalCount)?p().createElement(O.Z,{className:"pf-c-card",icon:N.W1,variant:"large",title:E.formatMessage(H.Z.noResults),text:E.formatMessage(H.Z.noResultsMatch)}):p().createElement(p().Fragment,null),U&&p().createElement(O.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),p().createElement(v.t,{itemCount:(null==G||null===(r=G.rulesList[0])||void 0===r||null===(o=r.affectedHosts)||void 0===o?void 0:o.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:R.limit,page:q,variant:v.a.bottom,onSetPage:K,onPerPageSelect:X}))};R.propTypes={ruleName:L().string,affectedCount:L().number};const I=R;var F=a(19399),z=a(82779),W=a(16530);const G=function(){var e,t,a,f,g,y=(0,x.Z)(),E=(0,W.useParams)().id,v=[{name:y.formatMessage(H.Z.malwareDetection),to:"".concat((0,z.hN)(),"/insights/malware")},{name:E,to:"#"}],h=(0,A.useQuery)(i.c3,{variables:{ruleName:E}}),b=h.data,Z=h.loading,w=null==b?void 0:b.rulesList[0],C=function(e,t){return p().createElement(p().Fragment,null,p().createElement("p",{className:"ins-l-detailBlockHeader"},e),p().createElement("p",null,t))};return p().createElement(p().Fragment,null,p().createElement(d.Z,null,p().createElement(o.Z,{items:v}),p().createElement(r.D,{headingLevel:"h1",size:r.H["3xl"]},E),p().createElement(n.r,{hasGutter:!0},p().createElement(l.P,{md:7,sm:12},w&&p().createElement(s.Z,{height:"250px",code:w.rawRule,isReadOnly:!0,isDownloadEnabled:!0,isCopyEnabled:!0})),Z?p().createElement(u.Z,null):p().createElement(l.P,{md:5,sm:12},p().createElement(n.r,{hasGutter:!0},p().createElement(l.P,{span:6},C(y.formatMessage(H.Z.lastmatch),null!=w&&w.lastMatchDate?p().createElement(c.Z,{date:new Date(w.lastMatchDate),type:"onlyDate"}):y.formatMessage(H.Z.never))),p().createElement(l.P,{span:6},C(y.formatMessage(H.Z.hostmatch),p().createElement("span",null,"".concat(null==w||null===(e=w.affectedHosts)||void 0===e?void 0:e.totalCount,"/").concat(null==b||null===(t=b.hosts)||void 0===t?void 0:t.totalCount)))),p().createElement(l.P,{span:12},C(y.formatMessage(H.Z.description),null==w||null===(a=w.metadata)||void 0===a?void 0:a.description)),p().createElement(l.P,{span:6},C(y.formatMessage(H.Z.status),w&&p().createElement(F.Z,w))),p().createElement(l.P,{span:6},C(y.formatMessage(H.Z.author),null==w||null===(f=w.metadata)||void 0===f?void 0:f.author)))))),p().createElement(m.Z,null,p().createElement(r.D,{className:"ins-l-tableBlockHeader",headingLevel:"h1",size:r.H["3xl"]},y.formatMessage(H.Z.affectedHosts)),p().createElement(I,{ruleName:E,affectedCount:null==w||null===(g=w.affectedHosts)||void 0===g?void 0:g.totalCount})))}}}]);
//# sourceMappingURL=../sourcemaps/Signature Details.5113d1bd83350f0dbc36.js.map