{"version":3,"file":"js/Signature Details.d61495f2d35fca893427.js","mappings":"4lCA4BA,IAAMA,EAAc,CAAE,EAAG,eAAgB,EAAG,iBAAkB,EAAG,eAC3DC,EAAU,SAAC,GAAD,IAAGC,EAAH,EAAGA,MAAOC,EAAV,EAAUA,UAAV,gBAA6BH,EAAYE,GAAzC,YAAmDC,IAAcC,EAAAA,EAAAA,IAAsB,MAAQ,SAEzGC,EAAe,SAACC,EAAOC,GACzB,OAAQA,EAAOC,MACX,IAAK,eACD,cAAYF,GAAZ,IAAmBG,UAAW,EAAF,KAAOH,EAAMG,WAAcF,EAAOG,WAClE,IAAK,YACD,cAAYJ,GAAZ,IAAmBK,OAAQJ,EAAOG,QAASD,UAAW,EAAF,KAAOH,EAAMG,WAAcF,EAAOE,aAC1F,IAAK,UACD,cAAYH,GAAZ,IAAmBM,KAAML,EAAOG,UAGxC,OAAOJ,GAGLO,EAAkB,SAAC,GAAgD,gBAA9CC,EAA8C,EAA9CA,SAAUC,EAAoC,EAApCA,cAAeC,EAAqB,EAArBA,eAC1CC,GAAOC,EAAAA,EAAAA,KACPC,EAAe,CACjBV,UAAW,CACPW,MAAO,GACPC,OAAQ,EACRpB,QAAS,qBACTqB,YAAa,GACbR,SAAAA,GAEJH,OAAQ,CACJT,MAAO,EACPC,UAAWC,EAAAA,EAAAA,KAEfQ,KAAM,IAEV,GAAgDW,EAAAA,EAAAA,YAAWlB,EAAD,KACnDc,IADP,sBAASV,EAAT,EAASA,UAAWE,EAApB,EAAoBA,OAAQC,EAA5B,EAA4BA,KAAQY,EAApC,KAGA,GACIC,EAAAA,EAAAA,GAASC,EAAAA,GAA6B,CAAEC,UAAWlB,IAD/CmB,EAAR,EAAQA,KAAMC,EAAd,EAAcA,QAASC,EAAvB,EAAuBA,MAEjBC,EAAU,CACZ,CAAEC,MAAOf,EAAKgB,cAAcC,EAAAA,EAAAA,MAAgBC,eAAgB,CAACC,EAAAA,IAAaC,WAAY,CAACC,EAAAA,GAAUC,EAAAA,EAAAA,GAAU,MAC3G,CAAEP,MAAOf,EAAKgB,cAAcC,EAAAA,EAAAA,SAAmBG,WAAY,CAACC,EAAAA,IAC5D,CAAEN,MAAO,+BAAOQ,EAAAA,EAAAA,IAAkB,CAAEC,QAASxB,EAAKgB,cAAcC,EAAAA,EAAAA,kBAC5DF,MAAOf,EAAKgB,cAAcC,EAAAA,EAAAA,iBAAmCG,WAAY,CAACC,EAAAA,KAG5EI,EAAOjC,EAAUY,OAASZ,EAAUW,MAAQ,EAE5CuB,EAAoB,CAAC,CACvBC,MAAO3B,EAAKgB,cAAcC,EAAAA,EAAAA,MAAeW,cACzCC,aAAc,CACVC,IAAK,cACLC,SAAU,SAACC,EAAGC,GAAJ,OAAc1B,EAAS,CAAEhB,KAAM,eAAgBE,QAAS,CAAEY,YAAa4B,MACjFA,MAAOzC,EAAUa,YACjB6B,YAAalC,EAAKgB,cAAcC,EAAAA,EAAAA,SAAmB,CAAEkB,MAAOnC,EAAKgB,cAAcC,EAAAA,EAAAA,MAAeW,mBAIhGQ,GAAY,SAACJ,EAAGP,GAAJ,OAAalB,EAAS,CAAEhB,KAAM,eAAgBE,QAAS,CAAEW,OAAQqB,EAAOjC,EAAUW,MAAQX,EAAUW,UAEhHkC,GAAkB,SAACL,EAAGM,GAAJ,OAAgB/B,EAAS,CAAEhB,KAAM,eAAgBE,QAAS,CAAEU,MAAOmC,EAASlC,OAAQ,OAuB5GmC,EAAAA,EAAAA,YAAU,WAAM,MAoBZhC,EAAS,CAAEhB,KAAM,UAAWE,QAnBT,SAAAkB,GAAI,OAAIA,MAAAA,OAAJ,EAAIA,EAAM6B,SAAQ,SAAC7B,EAAMmB,GAAQ,MAC9CW,EAAO9B,EACb,MAAO,CAAC,CACJ+B,MAAOZ,EACPa,QAAQ,EACRC,MAAO,CACH,CAAE7B,MAAO,8BAAO0B,EAAKpC,cACrB,CAAEU,MAAO,kBAAC8B,EAAA,EAAD,CAAYC,KAAM,IAAIC,KAAKN,EAAKO,cAAezD,KAAK,cAC7D,CAAEwB,MAAO,wCAAO0B,EAAKQ,kBAAZ,aAAO,EAAiBC,qBAGtC,CACCC,OAAc,EAANrB,EACRsB,SAAUX,EACVY,WAAW,EACXT,MAAO,QAIsBU,CAAW3C,MAAAA,GAAD,UAACA,EAAM4C,UAAU,UAAjB,aAAC,EAAoBC,uBACrE,CAACxD,EAAMW,IAEV,IAAM8C,GACF,kBAACC,EAAA,EAAD,CAAcC,UAAU,YAAYC,KAAMC,EAAAA,GAAYC,QAAQ,QAAQ/C,MAAOf,EAAKgB,cAAcC,EAAAA,EAAAA,WAC5F8C,KAAM/D,EAAKgB,cAAcC,EAAAA,EAAAA,kBAG3B+C,GACF,kBAACN,EAAA,EAAD,CAAcC,UAAU,YAAYG,QAAQ,QAAQF,KAAMK,EAAAA,GAAiBC,UAAU,sBACjFnD,MAAOf,EAAKgB,cAAcC,EAAAA,EAAAA,iBAC1B8C,KAAM/D,EAAKgB,cAAcC,EAAAA,EAAAA,uBAG3BkD,GACF,kBAACC,EAAA,EAAD,CAAcT,UAAU,YAAYU,QAASrE,EAAKgB,cAAcC,EAAAA,EAAAA,yBAG9DqD,GACF,kBAACZ,EAAA,EAAD,CAAcC,UAAU,YAAYG,QAAQ,QAAQ/C,MAAM,QAAQgD,KAAK,UAG3E,OAAO,kBAAC,aAAD,KACH,kBAACQ,EAAA,EAAD,CACIC,WAAY,CACRC,WAAW9D,MAAAA,GAAA,UAAAA,EAAM4C,UAAU,UAAhB,mBAAoBmB,qBAApB,eAAmCC,aAAc,EAC5DlD,KAAAA,EACAa,QAAS9C,EAAUW,MACnBiC,UAJQ,SAIEJ,EAAGP,GAAQW,GAAUJ,EAAGP,IAClCY,gBALQ,SAKQL,EAAGM,GAAWD,GAAgBL,EAAGM,IACjDsC,WAAW,GAEfC,aAAc,CAAEC,MAAOpD,KAE3B,kBAACqD,EAAA,EAAD,CAAOpB,UAAU,WAAW,aAAW,0BACnChE,KAAMA,EAAMiD,MAAO9B,EAASkE,WAzEjB,SAAChD,EAAGiD,EAAQtC,GAC3B,IAAMuC,GAAe,OAAIvF,GACnB8C,EAAOyC,EAAaD,EAAS,GAAG7B,SAEtC8B,EAAaD,GAAb,OAA4BC,EAAaD,IAAzC,IAAkDtC,OAAAA,IAClDuC,EAAaD,EAAS,GAAGrC,MAAS,CAAC,CAC/B7B,MAAO,kBAACoE,EAAA,EAAD,CAAYC,OAAO,QAAQC,KAAI,UAAK5C,EAAK6C,QAAQC,KAAI,SAACC,EAAO1D,GAAR,8BAAiC0D,EAAMC,OAAvC,oBAC/DD,EAAME,aADyD,yBAE1DF,EAAMG,WAFoD,+BAGpDH,EAAMI,iBAH8C,8BAIrD,IAAI7C,KAAKyC,EAAMK,UAAUC,cAJ4B,aAKtEN,EAAMO,UAAWC,EAAAA,EAAAA,IAAoBC,KAAKC,MAAMV,EAAMO,WAAa,GALG,aAMtEtD,EAAK6C,QAAQa,OAAS,GAAKrE,IAAQW,EAAK6C,QAAQa,OAAS,EAAzD,+EACE,OAAMC,KAAK,KACHC,mBAAiB,EAACC,eAAa,MACnC/F,EAAS,CAAEhB,KAAM,UAAWE,QAASyF,KA2DjCqB,OA7EO,SAACvE,EAAG/C,EAAOC,GAAX,OACXqB,EAAS,CAAEhB,KAAM,YAAaE,QAAS,CAAER,MAAAA,EAAOC,UAAAA,GAAaM,UAAW,CAAER,QAASA,EAAQ,CAAEC,MAAAA,EAAOC,UAAAA,IAAckB,OAAQ,MA4EtGV,OAAQA,EAAQ8G,gBAAc,GAC9C,kBAAC,IAAD,MACA,kBAAC,IAAD,OAEH5F,GAAW,kBAAC6F,EAAA,EAAD,CAASlH,KAAK,UAEpBsB,GAAUD,GAA6B,IAAlBd,GAGfc,IACCb,EAAiBoE,GAAoBH,IAHW,KAAlDrD,MAAAA,GAAA,UAAAA,EAAM4C,UAAU,UAAhB,mBAAoBmB,qBAApB,eAAmCC,YAChClB,GAAiB,kBAAC,aAAD,MAK9B5C,GAAS,kBAACyD,GAAD,MACV,kBAACoC,EAAA,EAAD,CACIjC,WAAW9D,MAAAA,GAAA,UAAAA,EAAM4C,UAAU,UAAhB,mBAAoBmB,qBAApB,eAAmCC,aAAc,EAC5DgC,SAAS,iCACTrE,QAAS9C,EAAUW,MACnBsB,KAAMA,EACNqC,QAAS8C,EAAAA,EAAAA,OACTxE,UAAWA,GACXC,gBAAiBA,OAK7BzC,EAAgBiH,UAAY,CACxBhH,SAAUgH,IAAAA,OACV/G,cAAe+G,IAAAA,OACf9G,eAAgB8G,IAAAA,MAGpB,U,0BC3GA,QArEgB,WAAM,kBACZ7G,GAAOC,EAAAA,EAAAA,KACb,EAA8B6G,IAAAA,UAAe,GAAtCC,GAAP,eACYC,GAAUC,EAAAA,EAAAA,aAAdC,GACFC,EAAc,CAAC,CAAEC,KAAMpH,EAAKgB,cAAcC,EAAAA,EAAAA,4BAC5CoG,GAAI,GAAF,QAAKC,EAAAA,EAAAA,MAAL,sBAAoC,CAAEF,KAAMJ,EAAOK,GAAI,MAC7D,GAA0B7G,EAAAA,EAAAA,GAAS+G,EAAAA,GAA4B,CAC3D7G,UAAW,CAAEb,SAAUmH,KADnBrG,EAAR,EAAQA,KAAMC,EAAd,EAAcA,QAGR4G,EAAiB7G,MAAAA,OAAH,EAAGA,EAAM4C,UAAU,GACjCkE,EAAc,SAAC1G,EAAO2G,GAAR,OAAmB,kBAAC,aAAD,KACnC,uBAAG/D,UAAU,2BAA2B5C,GACxC,2BAAI2G,KAGR,OAAO,kBAAC,aAAD,KACH,kBAACC,EAAA,EAAD,KACI,kBAACC,EAAA,EAAD,CAAY9C,MAAOqC,IACnB,kBAACU,EAAA,EAAD,CAAMC,WAAS,GACX,kBAACC,EAAA,EAAD,CAAUC,GAAI,GAAIC,GAAI,IAClB,kBAACC,EAAA,EAAD,CAAOC,aAAa,KAAKC,KAAMC,EAAAA,EAAAA,QAAqBrB,IAGvDD,GAAwB,kBAACgB,EAAA,EAAD,CAAUC,GAAI,EAAGC,GAAI,IACxCT,GAAkB,kBAACrC,EAAA,EAAD,CAAYC,OAAO,QAAQC,KAAMmC,EAAec,QAASC,YAAU,EAAClC,mBAAiB,EAACC,eAAa,KAG1H1F,EAAU,kBAAC6F,EAAA,EAAD,MACP,kBAACsB,EAAA,EAAD,CAAUC,GAAIjB,EAAuB,EAAK,GAAIkB,GAAI,IAC9C,kBAACJ,EAAA,EAAD,CAAMC,WAAS,GACX,kBAACC,EAAA,EAAD,CAAUS,KAAMzB,EAAuB,EAAK,GACvCU,EAAYzH,EAAKgB,cAAcC,EAAAA,EAAAA,WAAqBuG,MAAAA,GAAAA,EAAgBiB,cACjE,kBAAC5F,EAAA,EAAD,CAAYC,KAAM,IAAIC,KAAKyE,EAAeiB,eAAgBlJ,KAAK,aAC7DS,EAAKgB,cAAcC,EAAAA,EAAAA,SAE7B,kBAAC8G,EAAA,EAAD,CAAUS,KAAMzB,EAAuB,EAAK,GACvCU,EAAYzH,EAAKgB,cAAcC,EAAAA,EAAAA,WAC5B,wCAAUuG,MAAAA,GAAV,UAAUA,EAAgB9C,qBAA1B,aAAU,EAA+BC,WAAzC,YAAuDhE,MAAAA,GAAvD,UAAuDA,EAAM+H,aAA7D,aAAuD,EAAa/D,eAE3EoC,GAAuB,kBAACgB,EAAA,EAAD,CAAUS,KAAM,GACnCf,EAAYzH,EAAKgB,cAAcC,EAAAA,EAAAA,aAAuBuG,MAAAA,GAA3C,UAA2CA,EAAgBzB,gBAA3D,aAA2C,EAA0B4C,cAErF,kBAACZ,EAAA,EAAD,CAAUS,KAAMzB,EAAuB,EAAK,GACvCU,EAAYzH,EAAKgB,cAAcC,EAAAA,EAAAA,YAAsBuG,GAAkB,kBAACoB,EAAA,EAAgBpB,KAE7F,kBAACO,EAAA,EAAD,CAAUS,KAAMzB,EAAuB,EAAK,GACvCU,EAAYzH,EAAKgB,cAAcC,EAAAA,EAAAA,QAAkBuG,MAAAA,GAAtC,UAAsCA,EAAgBzB,gBAAtD,aAAsC,EAA0B8C,UAE9E9B,GAAuB,kBAACgB,EAAA,EAAD,CAAUS,KAAM,GACpCf,EAAYzH,EAAKgB,cAAcC,EAAAA,EAAAA,aAAuBuG,MAAAA,GAA3C,UAA2CA,EAAgBzB,gBAA3D,aAA2C,EAA0B4C,kBAOzG,kBAACG,EAAA,EAAD,KACI,kBAACZ,EAAA,EAAD,CAAOvE,UAAU,yBAAyBwE,aAAa,KAAKC,KAAMC,EAAAA,EAAAA,QAC7DrI,EAAKgB,cAAcC,EAAAA,EAAAA,gBAExB,kBAAC,EAAD,CACIpB,SAAUmH,EACVjH,eAA4C,KAA5BY,MAAAA,GAAA,UAAAA,EAAM+H,aAAN,eAAa/D,YAC7B7E,cAAe0H,MAAAA,GAAF,UAAEA,EAAgB9C,qBAAlB,aAAE,EAA+BC","sources":["webpack:///./src/Components/SigDetailsTable/SigDetailsTable.js","webpack:///./src/Routes/Signatures/Details.js"],"sourcesContent":["import { Pagination, PaginationVariant } from '@patternfly/react-core/dist/esm/components/Pagination';\nimport React, { useEffect, useReducer } from 'react';\nimport {\n    SortByDirection,\n    Table,\n    TableBody,\n    TableHeader,\n    cellWidth,\n    expandable,\n    sortable\n} from '@patternfly/react-table/dist/esm/components/Table';\n\nimport CheckCircleIcon from '@patternfly/react-icons/dist/esm/icons/check-circle-icon';\nimport CodeEditor from '../CodeEditor/CodeEditor';\nimport { DateFormat } from '@redhat-cloud-services/frontend-components/DateFormat';\nimport { expandMatchMetadata } from '../Common';\nimport { GET_SIGNATURE_DETAILS_TABLE } from '../../operations/queries';\nimport Loading from '../Loading/Loading';\nimport MessageState from '../MessageState/MessageState';\nimport { PrimaryToolbar } from '@redhat-cloud-services/frontend-components/PrimaryToolbar';\nimport { SearchIcon } from '@patternfly/react-icons/dist/esm/icons/search-icon';\nimport messages from '../../Messages';\nimport propTypes from 'prop-types';\nimport { totalMatchesTitle } from '../Common';\nimport { useIntl } from 'react-intl';\nimport { useQuery } from '@apollo/client';\nimport EmptyAccount from '../SharedComponents/EmptyAccount';\n\nconst sortIndices = { 1: 'DISPLAY_NAME', 2: 'LAST_SCAN_DATE', 3: 'MATCH_COUNT' };\nconst orderBy = ({ index, direction }) => `${sortIndices[index]}_${direction === SortByDirection.asc ? 'ASC' : 'DESC'}`;\n\nconst tableReducer = (state, action) => {\n    switch (action.type) {\n        case 'setTableVars':\n            return { ...state, tableVars: { ...state.tableVars, ...action.payload } };\n        case 'setSortBy':\n            return { ...state, sortBy: action.payload, tableVars: { ...state.tableVars, ...action.tableVars } };\n        case 'setRows':\n            return { ...state, rows: action.payload };\n    }\n\n    return state;\n};\n\nconst SigDetailsTable = ({ ruleName, affectedCount, isEmptyAccount }) => {\n    const intl = useIntl();\n    const initialState = {\n        tableVars: {\n            limit: 10,\n            offset: 0,\n            orderBy: 'LAST_SCAN_DATE_ASC',\n            displayName: '',\n            ruleName\n        },\n        sortBy: {\n            index: 2,\n            direction: SortByDirection.asc\n        },\n        rows: []\n    };\n    const [{ tableVars, sortBy, rows }, stateSet] = useReducer(tableReducer, {\n        ...initialState\n    });\n    const { data, loading, error } =\n        useQuery(GET_SIGNATURE_DETAILS_TABLE, { variables: tableVars });\n    const columns = [\n        { title: intl.formatMessage(messages.name), cellFormatters: [expandable], transforms: [sortable, cellWidth(45)] },\n        { title: intl.formatMessage(messages.matched), transforms: [sortable] },\n        { title: <span>{totalMatchesTitle({ tooltip: intl.formatMessage(messages.totalMatchesNote),\n            title: intl.formatMessage(messages.totalMatches) })}</span>, transforms: [sortable] }\n    ];\n\n    const page = tableVars.offset / tableVars.limit + 1;\n\n    const filterConfigItems = [{\n        label: intl.formatMessage(messages.name).toLowerCase(),\n        filterValues: {\n            key: 'text-filter',\n            onChange: (e, value) => stateSet({ type: 'setTableVars', payload: { displayName: value } }),\n            value: tableVars.displayName,\n            placeholder: intl.formatMessage(messages.filterBy, { field: intl.formatMessage(messages.name).toLowerCase() })\n        }\n    }];\n\n    const onSetPage = (e, page) => stateSet({ type: 'setTableVars', payload: { offset: page * tableVars.limit - tableVars.limit } });\n\n    const onPerPageSelect = (e, perPage) => stateSet({ type: 'setTableVars', payload: { limit: perPage, offset: 0 } });\n\n    const onSort = (e, index, direction) =>\n        stateSet({ type: 'setSortBy', payload: { index, direction }, tableVars: { orderBy: orderBy({ index, direction }), offset: 0 } });\n\n    const onCollapse = (e, rowKey, isOpen) => {\n        const collapseRows = [...rows];\n        const host = collapseRows[rowKey + 1].hostData;\n\n        collapseRows[rowKey] = { ...collapseRows[rowKey], isOpen };\n        collapseRows[rowKey + 1].cells =  [{\n            title: <CodeEditor height='250px' code={`${host.matches.map((match, key) => `Match Source: ${match.source}\nOffset:${match.stringOffset}\nMatch Data: ${match.stringData}\nMatch Identifier: ${match.stringIdentifier}\nMatch Scan Date: ${new Date(match.scanDate).toUTCString()}\n${match.metadata ? expandMatchMetadata(JSON.parse(match.metadata)) : ''}\n${host.matches.length > 1 && key !== host.matches.length - 1 ? `~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n` : ''}`).join('')}`}\n            isDownloadEnabled isCopyEnabled/> }];\n        stateSet({ type: 'setRows', payload: collapseRows });\n    };\n\n    useEffect(() => {\n        const rowBuilder = data => data?.flatMap((data, key) => {\n            const host = data;\n            return [{\n                rowId: key,\n                isOpen: false,\n                cells: [\n                    { title: <span>{host.displayName}</span> },\n                    { title: <DateFormat date={new Date(host.lastScanDate)} type='onlyDate' /> },\n                    { title: <span>{host.matchCount?.toLocaleString()}</span> }\n\n                ]\n            }, {\n                parent: key * 2,\n                hostData: host,\n                fullWidth: true,\n                cells: []\n            }];\n        });\n\n        stateSet({ type: 'setRows', payload: rowBuilder(data?.rulesList[0]?.affectedHostsList) });\n    }, [intl, data]);\n\n    const NoResultsMatch = (\n        <MessageState className='pf-c-card' icon={SearchIcon} variant='large' title={intl.formatMessage(messages.noResults)}\n            text={intl.formatMessage(messages.noResultsMatch)} />\n    );\n\n    const NoAffectedHosts = (\n        <MessageState className='pf-c-card' variant='large' icon={CheckCircleIcon} iconClass='ins-l-success-color'\n            title={intl.formatMessage(messages.noAffectedHosts)}\n            text={intl.formatMessage(messages.noAffectedHostsBody)} />\n    );\n\n    const EmptyAccountState = (\n        <EmptyAccount className='pf-c-card' message={intl.formatMessage(messages.emptyAccountTableBody)} />\n    );\n\n    const ErrorState = (\n        <MessageState className='pf-c-card' variant='large' title='Error' text='error' />\n    );\n\n    return <React.Fragment>\n        <PrimaryToolbar\n            pagination={{\n                itemCount: data?.rulesList[0]?.affectedHosts?.totalCount || 0,\n                page,\n                perPage: tableVars.limit,\n                onSetPage(e, page) { onSetPage(e, page); },\n                onPerPageSelect(e, perPage) { onPerPageSelect(e, perPage); },\n                isCompact: true\n            }}\n            filterConfig={{ items: filterConfigItems }}\n        />\n        <Table className='sigTable' aria-label='Signature Details table'\n            rows={rows} cells={columns} onCollapse={onCollapse}\n            onSort={onSort} sortBy={sortBy} isStickyHeader>\n            <TableHeader />\n            <TableBody />\n        </Table>\n        {loading && <Loading type='table' />}\n        {\n            (!error && !loading && affectedCount !== 0)\n                ? (data?.rulesList[0]?.affectedHosts?.totalCount === 0)\n                    ? NoResultsMatch : <React.Fragment />\n                : (!loading &&\n                    (isEmptyAccount ? EmptyAccountState : NoAffectedHosts)\n                )\n        }\n        {error && <ErrorState />}\n        <Pagination\n            itemCount={data?.rulesList[0]?.affectedHosts?.totalCount || 0}\n            widgetId='pagination-options-menu-bottom'\n            perPage={tableVars.limit}\n            page={page}\n            variant={PaginationVariant.bottom}\n            onSetPage={onSetPage}\n            onPerPageSelect={onPerPageSelect}\n        />\n    </React.Fragment>;\n};\n\nSigDetailsTable.propTypes = {\n    ruleName: propTypes.string,\n    affectedCount: propTypes.number,\n    isEmptyAccount: propTypes.bool\n};\n\nexport default SigDetailsTable;\n","import './Details.scss';\n\nimport { Grid, GridItem } from '@patternfly/react-core/dist/esm/layouts/Grid/index';\nimport { Title, TitleSizes } from '@patternfly/react-core/dist/esm/components/Title';\n\nimport Breadcrumb from '../../Components/Breadcrumb/Breadcrumb';\nimport CodeEditor from '../../Components/CodeEditor/CodeEditor';\nimport { DateFormat } from '@redhat-cloud-services/frontend-components/DateFormat';\nimport { GET_SIGNATURE_DETAILS_PAGE } from '../../operations/queries';\nimport Loading from '../../Components/Loading/Loading';\nimport { Main } from '@redhat-cloud-services/frontend-components/Main';\nimport { PageHeader } from '@redhat-cloud-services/frontend-components/PageHeader';\nimport React from 'react';\nimport SigDetailsTable from '../../Components/SigDetailsTable/SigDetailsTable';\nimport StatusLabel from '../../Components/StatusLabel/StatusLabel';\nimport { isBeta } from '../../Components/Common';\nimport messages from '../../Messages';\nimport { useIntl } from 'react-intl';\nimport { useParams } from 'react-router-dom';\nimport { useQuery } from '@apollo/client';\n\nconst Details = () => {\n    const intl = useIntl();\n    const [isCodeEditorEnabled] = React.useState(false);\n    const { id: sigId } = useParams();\n    const breadcrumbs = [{ name: intl.formatMessage(messages.malwareDetectionSignatures),\n        to: `${isBeta()}/insights/malware` }, { name: sigId, to: '#' }];\n    const { data, loading } = useQuery(GET_SIGNATURE_DETAILS_PAGE, {\n        variables: { ruleName: sigId  }\n    });\n    const sigDetailsData = data?.rulesList[0];\n    const detailBlock = (title, detail) => <React.Fragment>\n        <p className='ins-l-detailBlockHeader'>{title}</p>\n        <p>{detail}</p>\n    </React.Fragment>;\n\n    return <React.Fragment>\n        <PageHeader>\n            <Breadcrumb items={breadcrumbs} />\n            <Grid hasGutter>\n                <GridItem md={12} sm={12}>\n                    <Title headingLevel='h1' size={TitleSizes['3xl']} >{sigId}</Title>\n                </GridItem>\n\n                {isCodeEditorEnabled && (<GridItem md={7} sm={12}>\n                    { sigDetailsData && <CodeEditor height='250px' code={sigDetailsData.rawRule} isReadOnly isDownloadEnabled isCopyEnabled />}\n                </GridItem>)}\n\n                {loading ? <Loading /> :\n                    <GridItem md={isCodeEditorEnabled && 5 || 12} sm={12}>\n                        <Grid hasGutter>\n                            <GridItem span={isCodeEditorEnabled && 6 || 1}>\n                                {detailBlock(intl.formatMessage(messages.lastmatch), sigDetailsData?.lastMatchDate ?\n                                    <DateFormat date={new Date(sigDetailsData.lastMatchDate)} type=\"onlyDate\" />\n                                    : intl.formatMessage(messages.never))}\n                            </GridItem>\n                            <GridItem span={isCodeEditorEnabled && 6 || 1}>\n                                {detailBlock(intl.formatMessage(messages.hostmatch),\n                                    <span>{`${sigDetailsData?.affectedHosts?.totalCount}/${data?.hosts?.totalCount}`}</span>)}\n                            </GridItem>\n                            {isCodeEditorEnabled && <GridItem span={6}>\n                                {detailBlock(intl.formatMessage(messages.description), sigDetailsData?.metadata?.description)}\n                            </GridItem>}\n                            <GridItem span={isCodeEditorEnabled && 6 || 1}>\n                                {detailBlock(intl.formatMessage(messages.enablement), sigDetailsData && <StatusLabel {...sigDetailsData} />)}\n                            </GridItem>\n                            <GridItem span={isCodeEditorEnabled && 6 || 2}>\n                                {detailBlock(intl.formatMessage(messages.author), sigDetailsData?.metadata?.author)}\n                            </GridItem>\n                            {!isCodeEditorEnabled && <GridItem span={7}>\n                                {detailBlock(intl.formatMessage(messages.description), sigDetailsData?.metadata?.description)}\n                            </GridItem>}\n                        </Grid>\n                    </GridItem>\n                }\n            </Grid>\n        </PageHeader>\n        <Main>\n            <Title className='ins-l-tableBlockHeader' headingLevel='h1' size={TitleSizes['3xl']}>\n                {intl.formatMessage(messages.affectedHosts)}\n            </Title>\n            <SigDetailsTable\n                ruleName={sigId}\n                isEmptyAccount={data?.hosts?.totalCount === 0}\n                affectedCount={sigDetailsData?.affectedHosts?.totalCount}\n            />\n        </Main>\n    </React.Fragment>;\n};\n\nexport default Details;\n"],"names":["sortIndices","orderBy","index","direction","SortByDirection","tableReducer","state","action","type","tableVars","payload","sortBy","rows","SigDetailsTable","ruleName","affectedCount","isEmptyAccount","intl","useIntl","initialState","limit","offset","displayName","useReducer","stateSet","useQuery","GET_SIGNATURE_DETAILS_TABLE","variables","data","loading","error","columns","title","formatMessage","messages","cellFormatters","expandable","transforms","sortable","cellWidth","totalMatchesTitle","tooltip","page","filterConfigItems","label","toLowerCase","filterValues","key","onChange","e","value","placeholder","field","onSetPage","onPerPageSelect","perPage","useEffect","flatMap","host","rowId","isOpen","cells","DateFormat","date","Date","lastScanDate","matchCount","toLocaleString","parent","hostData","fullWidth","rowBuilder","rulesList","affectedHostsList","NoResultsMatch","MessageState","className","icon","SearchIcon","variant","text","NoAffectedHosts","CheckCircleIcon","iconClass","EmptyAccountState","EmptyAccount","message","ErrorState","PrimaryToolbar","pagination","itemCount","affectedHosts","totalCount","isCompact","filterConfig","items","Table","onCollapse","rowKey","collapseRows","CodeEditor","height","code","matches","map","match","source","stringOffset","stringData","stringIdentifier","scanDate","toUTCString","metadata","expandMatchMetadata","JSON","parse","length","join","isDownloadEnabled","isCopyEnabled","onSort","isStickyHeader","Loading","Pagination","widgetId","PaginationVariant","propTypes","React","isCodeEditorEnabled","sigId","useParams","id","breadcrumbs","name","to","isBeta","GET_SIGNATURE_DETAILS_PAGE","sigDetailsData","detailBlock","detail","PageHeader","Breadcrumb","Grid","hasGutter","GridItem","md","sm","Title","headingLevel","size","TitleSizes","rawRule","isReadOnly","span","lastMatchDate","hosts","description","StatusLabel","author","Main"],"sourceRoot":""}