"use strict";(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[207],{54838:(e,t,a)=>{a.r(t),a.d(t,{default:()=>W});var r=a(93433),l=a(29439),n=a(4942),s=a(50693),o=a(16475),i=a(71070),c=a(93264),m=a.n(c),u=a(38800),d=a(62480),f=a(1082),p=a(7732),g=a(3351),y=a(6934),v=a(22860),h=a(63540),b=a(82779),M=a(38846),E=a(62410),Z=a(84580),S=a(86235),w=a(52661),D=a(51957),C=a(66031),O=a(80810),P=a(19399),T=a(35224),_=a(30893),V=a(88676),A=a(86896),N=a(70846),B=a(90025);function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){(0,n.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var x={tableVars:{limit:10,offset:0,orderBy:"LAST_MATCH_DATE_DESC",ruleName:""},sortBy:{index:4,direction:u.B.desc},rows:[]},R={1:"NAME",2:"HAS_MATCH",3:"IS_DISABLED",4:"HOST_COUNT",5:"LAST_MATCH_DATE"},H=function(e){var t=e.index,a=e.direction;return"".concat(R[t],"_").concat(a===u.B.asc?"ASC":"DESC")},k=function(e,t){switch(t.type){case"setTableVars":return L(L({},e),{},{tableVars:L(L({},e.tableVars),t.payload)});case"setSortBy":return L(L({},e),{},{sortBy:t.payload,tableVars:L(L({},e.tableVars),t.tableVars)});case"setRows":return L(L({},e),{},{rows:t.payload})}return e},G=function(){var e,t,a,n,u,b,j,R,G=(0,A.Z)(),W=(0,c.useReducer)(k,L({},x)),F=(0,l.Z)(W,2),I=F[0],X=I.tableVars,J=I.sortBy,$=I.rows,q=F[1],z=(0,N.a)(Z.tE,{variables:L(L({},X),(0,B.l)(V.gG))}),U=z.data,Y=z.loading,K=z.error,Q=[{title:G.formatMessage(_.Z.sigName),cellFormatters:[d.zW],transforms:[(0,f.d)(45),p.p]},{title:G.formatMessage(_.Z.lastStatus),transforms:[(0,f.d)(10),p.p]},{title:G.formatMessage(_.Z.enablement),transforms:[(0,f.d)(10),p.p]},{title:G.formatMessage(_.Z.systems),transforms:[(0,f.d)(10),p.p]},{title:G.formatMessage(_.Z.matched),transforms:[(0,f.d)(10),p.p]}],ee=X.offset/X.limit+1,te={sig_match:{type:"radio",title:G.formatMessage(_.Z.status),urlParam:"sig_match",values:[{label:G.formatMessage(_.Z.all),value:"all"},{label:G.formatMessage(_.Z.matched),value:"true"},{label:G.formatMessage(_.Z.notMatched),value:"false"}]}},ae=[{label:G.formatMessage(_.Z.signature).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return q({type:"setTableVars",payload:{ruleName:t}})},value:X.ruleName,placeholder:G.formatMessage(_.Z.filterBy,{field:G.formatMessage(_.Z.signature).toLowerCase()})}},{label:te.sig_match.title.toLowerCase(),type:te.sig_match.type,id:te.sig_match.urlParam,value:"radio-".concat(te.sig_match.urlParam),filterValues:{key:"".concat(te.sig_match.urlParam,"-filter"),onChange:function(e,t){var a=(0,V.gG)();"all"===t&&(null==a||delete a.condition),"all"===t?(0,V.gG)(L({},a)):(0,V.gG)(L(L({},a),{},{condition:{hasMatch:JSON.parse(t)}}))},value:JSON.stringify(null===(e=(0,V.gG)().condition)||void 0===e?void 0:e.hasMatch)||"all",items:te.sig_match.values}}],re=function(e,t){return q({type:"setTableVars",payload:{offset:t*X.limit-X.limit}})},le=function(e,t){return q({type:"setTableVars",payload:{limit:t,offset:0}})},ne={deleteTitle:G.formatMessage(_.Z.resetFilters),filters:(j=[],R=void 0!==(null===(u=(0,V.gG)().condition)||void 0===u?void 0:u.hasMatch)&&(null!==(b=(0,V.gG)().condition)&&void 0!==b&&b.hasMatch?G.formatMessage(_.Z.matched):G.formatMessage(_.Z.notMatched)),(null==X?void 0:X.ruleName)&&j.push({category:G.formatMessage(_.Z.signature),value:"name",chips:[{name:null==X?void 0:X.ruleName,value:null==X?void 0:X.ruleName}]}),R&&j.push({category:G.formatMessage(_.Z.status),value:"matched",chips:[{name:R,value:R}]}),j),onDelete:function(e,t,a){a?((0,V.gG)({}),q({type:"setTableVars",payload:{ruleName:""}})):t.map((function(e){"name"===e.value&&q({type:"setTableVars",payload:{ruleName:""}}),"matched"===e.value&&(0,V.gG)({})}))}};return(0,c.useEffect)((function(){var e,t;q({type:"setRows",payload:(e=U,null==e||null===(t=e.rulesList)||void 0===t?void 0:t.flatMap((function(e,t){var a,r=e;return[{rowId:t,isOpen:!1,cells:[{title:m().createElement(S.Link,{to:"/signatures/".concat(r.name)},r.name)},{title:m().createElement(P.Z,{isDisabled:r.isDisabled,hasMatch:r.hasMatch,displayMatch:!0})},{title:m().createElement(P.Z,{isDisabled:r.isDisabled,hasMatch:r.hasMatch})},{title:m().createElement(S.Link,{to:"/signatures/".concat(r.name)},null===(a=r.hostCount)||void 0===a?void 0:a.toLocaleString())},{title:r.lastMatchDate?m().createElement(T.u,{content:m().createElement(E.Z,{date:new Date(r.lastMatchDate),type:"exact"})},m().createElement("span",null,m().createElement(E.Z,{date:new Date(r.lastMatchDate),type:"onlyDate"}))):m().createElement(T.u,{content:G.formatMessage(_.Z.noHostHas)},m().createElement("span",null,G.formatMessage(_.Z.never)))}]},{parent:2*t,sigData:r,fullWidth:!0,cells:[]}]})))})}),[G,U]),m().createElement(m().Fragment,null,m().createElement(C.Z,{pagination:{itemCount:(null==U||null===(t=U.rules)||void 0===t?void 0:t.totalCount)||0,page:ee,perPage:X.limit,onSetPage:function(e,t){re(0,t)},onPerPageSelect:function(e,t){le(0,t)},isCompact:!0},filterConfig:{items:ae},activeFiltersConfig:ne}),m().createElement(g.i,{className:"sigTable","aria-label":"Signature table",onCollapse:function(e,t,a){var l=(0,r.Z)($),n=l[t+1].sigData;l[t]=L(L({},l[t]),{},{isOpen:a}),l[t+1].cells=[{title:m().createElement(s.r,{hasGutter:!0},m().createElement(o.P,{span:6},m().createElement(M.Z,{code:n.rawRule,isReadOnly:!0})),m().createElement(o.P,{span:6}," ",m().createElement(h.xv,{className:"ins-l-sigtable--title",component:h.qO.h6},G.formatMessage(_.Z.description)),n.metadata.description))}],q({type:"setRows",payload:l})},rows:$,cells:Q,onSort:function(e,t,a){return q({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:H({index:t,direction:a}),offset:0}})},sortBy:J,isStickyHeader:!0},m().createElement(y.x,null),m().createElement(v.R,null)),Y&&m().createElement(w.Z,{type:"table"}),!Y&&!K&&0===(null==U||null===(a=U.rules)||void 0===a?void 0:a.totalCount)&&m().createElement(D.Z,{className:"pf-c-card",icon:O.W1,variant:"large",title:G.formatMessage(_.Z.noResults),text:G.formatMessage(_.Z.noResultsMatch)}),K&&m().createElement(D.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),m().createElement(i.t,{itemCount:(null==U||null===(n=U.rules)||void 0===n?void 0:n.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:X.limit,page:ee,variant:i.a.bottom,onSetPage:re,onPerPageSelect:le}))};G.propTypes=b.R$;const W=G},39149:(e,t,a)=>{a.r(t),a.d(t,{default:()=>L});var r=a(29439),l=a(4942),n=a(71070),s=a(93264),o=a.n(s),i=a(38800),c=a(1082),m=a(7732),u=a(3351),d=a(6934),f=a(22860),p=a(62410),g=a(84580),y=a(86235),v=a(52661),h=a(51957),b=a(66031),M=a(80810),E=a(19399),Z=a(35224),S=a(82779),w=a(30893),D=a(88676),C=a(86896),O=a(70846),P=a(90025);function T(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?T(Object(a),!0).forEach((function(t){(0,l.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):T(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var V={tableVars:{limit:10,offset:0,orderBy:"LAST_SCAN_DATE_DESC",name:""},sortBy:{index:4,direction:i.B.desc},rows:[]},A={0:"DISPLAY_NAME",1:"HAS_MATCH",2:"LAST_MATCH_DATE",3:"TOTAL_MATCHES",4:"LAST_SCAN_DATE"},N=function(e){var t=e.index,a=e.direction;return"".concat(A[t],"_").concat(a===i.B.asc?"ASC":"DESC")},B=function(e,t){switch(t.type){case"setTableVars":return _(_({},e),{},{tableVars:_(_({},e.tableVars),t.payload)});case"setSortBy":return _(_({},e),{},{sortBy:t.payload,tableVars:_(_({},e.tableVars),t.tableVars)});case"setRows":return _(_({},e),{},{rows:t.payload})}return e},j=function(){var e,t,a,l,i,T,A,j=(0,C.Z)(),L=(0,s.useReducer)(B,_({},V)),x=(0,r.Z)(L,2),R=x[0],H=R.tableVars,k=R.sortBy,G=R.rows,W=x[1],F=(0,O.a)(g.c5,{variables:_(_({},H),(0,P.l)(D.WX))}),I=F.data,X=F.loading,J=F.error,$=[{title:j.formatMessage(w.Z.name),transforms:[(0,c.d)(45),m.p]},{title:j.formatMessage(w.Z.lastStatus),transforms:[m.p,(0,c.d)(10)]},{title:j.formatMessage(w.Z.matched),transforms:[m.p,(0,c.d)(10)]},{title:o().createElement("span",null,(0,S.lH)({tooltip:j.formatMessage(w.Z.totalMatchesNote),title:j.formatMessage(w.Z.totalMatches)})),transforms:[m.p,(0,c.d)(15)]},{title:j.formatMessage(w.Z.lastScan),transforms:[m.p,(0,c.d)(10)]}],q=H.offset/H.limit+1,z=[{label:j.formatMessage(w.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return W({type:"setTableVars",payload:{name:t}})},value:H.name,placeholder:j.formatMessage(w.Z.filterBy,{field:j.formatMessage(w.Z.name).toLowerCase()})}}],U=function(e,t){return W({type:"setTableVars",payload:{offset:t*H.limit-H.limit}})},Y=function(e,t){return W({type:"setTableVars",payload:{limit:t,offset:0}})},K={deleteTitle:j.formatMessage(w.Z.resetFilters),filters:(T=[],A=void 0!==(null===(l=(0,D.WX)().condition)||void 0===l?void 0:l.hasMatch)&&(null!==(i=(0,D.WX)().condition)&&void 0!==i&&i.hasMatch?j.formatMessage(w.Z.matched):j.formatMessage(w.Z.notMatched)),(null==H?void 0:H.name)&&T.push({category:j.formatMessage(w.Z.name),value:"name",chips:[{name:null==H?void 0:H.name,value:null==H?void 0:H.name}]}),A&&T.push({category:j.formatMessage(w.Z.status),value:"matched",chips:[{name:A,value:A}]}),T),onDelete:function(e,t,a){a?((0,D.WX)({}),W({type:"setTableVars",payload:{name:""}})):t.map((function(e){"name"===e.value&&W({type:"setTableVars",payload:{name:""}}),"matched"===e.value&&(0,D.WX)({})}))}};return(0,s.useEffect)((function(){var e,t;W({type:"setRows",payload:(e=I,null==e||null===(t=e.hostsList)||void 0===t?void 0:t.flatMap((function(e,t){var a;return{rowId:t,cells:[{title:o().createElement(y.Link,{to:"/systems/".concat(e.displayName)},e.displayName)},{title:o().createElement(E.Z,{isDisabled:e.isDisabled,hasMatch:e.hasMatch,displayMatch:!0})},{title:e.lastMatchDate?o().createElement(Z.u,{content:o().createElement(p.Z,{date:new Date(e.lastMatchDate),type:"exact"})},o().createElement("span",null,o().createElement(p.Z,{date:new Date(e.lastMatchDate),type:"onlyDate"}))):o().createElement(Z.u,{content:j.formatMessage(w.Z.noHostHas)},o().createElement("span",null,j.formatMessage(w.Z.never)))},{title:o().createElement(y.Link,{to:"/systems/".concat(e.displayName)},null===(a=e.totalMatches)||void 0===a?void 0:a.toLocaleString())},{title:o().createElement(Z.u,{content:o().createElement(p.Z,{date:new Date(e.lastScanDate),type:"exact"})},o().createElement("span",null,o().createElement(p.Z,{date:new Date(e.lastScanDate)})))}]}})))})}),[j,I]),o().createElement(o().Fragment,null,o().createElement(b.Z,{pagination:{itemCount:(null==I||null===(e=I.hosts)||void 0===e?void 0:e.totalCount)||0,page:q,perPage:H.limit,onSetPage:function(e,t){U(0,t)},onPerPageSelect:function(e,t){Y(0,t)},isCompact:!0},filterConfig:{items:z},activeFiltersConfig:K}),o().createElement(u.i,{className:"sysTable","aria-label":"System table",rows:G,cells:$,onSort:function(e,t,a){return W({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:N({index:t,direction:a}),offset:0}})},sortBy:k,isStickyHeader:!0},o().createElement(d.x,null),o().createElement(f.R,null)),X&&o().createElement(v.Z,{type:"table"}),!X&&!J&&0===(null==I||null===(t=I.hosts)||void 0===t?void 0:t.totalCount)&&o().createElement(h.Z,{className:"pf-c-card",icon:M.W1,variant:"large",title:j.formatMessage(w.Z.noResults),text:j.formatMessage(w.Z.noResultsMatch)}),J&&o().createElement(h.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),o().createElement(n.t,{itemCount:(null==I||null===(a=I.hosts)||void 0===a?void 0:a.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:H.limit,page:q,variant:n.a.bottom,onSetPage:U,onPerPageSelect:Y}))};j.propTypes=S.R$;const L=j}}]);