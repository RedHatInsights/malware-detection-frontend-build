(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[207],{90025:(e,t,a)=>{"use strict";a.d(t,{l:()=>l});var n=a(93264);function l(e){var t=e(),a=(0,n.useState)(t)[1];return(0,n.useEffect)((function(){var n=e();if(t===n)return e.onNextChange(a);a(n)}),[t]),t}},63540:(e,t,a)=>{"use strict";t.xv=t.qO=void 0;const n=a(21988),l=n.__importStar(a(93264)),r=a(38296),s=n.__importDefault(a(67526)),o=a(23053);var i;!function(e){e.h1="h1",e.h2="h2",e.h3="h3",e.h4="h4",e.h5="h5",e.h6="h6",e.p="p",e.a="a",e.small="small",e.blockquote="blockquote",e.pre="pre"}(i=t.qO||(t.qO={})),t.xv=e=>{var{children:a=null,className:c="",component:u=i.p,isVisitedLink:m=!1,ouiaId:d,ouiaSafe:p=!0}=e,f=n.__rest(e,["children","className","component","isVisitedLink","ouiaId","ouiaSafe"]);const g=u,y=o.useOUIAProps(t.xv.displayName,d,p);return l.createElement(g,Object.assign({},y,f,{"data-pf-content":!0,className:r.css(m&&u===i.a&&s.default.modifiers.visited,c)}),a)},t.xv.displayName="Text"},38846:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p});var n=a(99332),l=a(51957),r=a(33211),s=a(45697),o=a.n(s),i=a(93264),c=a.n(i),u=a(30893),m=a(86896),d=function(e){var t=e.code,a=e.language,s=e.isReadOnly,o=e.isDownloadEnabled,i=e.isCopyEnabled,d=e.height,p=void 0===d?"400px":d,f=(0,m.Z)();return c().createElement(r.p,{isDownloadEnabled:o,isCopyEnabled:i,isReadOnly:s,isLanguageLabelVisible:a,code:t,language:a,emptyState:c().createElement(l.Z,{className:"",icon:n.mB,variant:"small",title:f.formatMessage(u.Z.sigCompiled),text:f.formatMessage(u.Z.sigCompiledBody)}),height:p})};d.propTypes={code:o().any,language:o().string,isReadOnly:o().bool,isCopyEnabled:o().bool,isDownloadEnabled:o().bool,height:o().string},d.defaultProps={codeType:"Code"};const p=d},51957:(e,t,a)=>{"use strict";a.d(t,{Z:()=>p});var n=a(9947),l=a(38424),r=a(75106),s=a(76473),o=a(45697),i=a.n(o),c=a(93264),u=a.n(c),m=a(60485),d=function(e){var t=e.className,a=e.children,s=e.icon,o=e.iconClass,i=e.iconStyle,c=e.text,d=e.title,p=e.variant;return u().createElement(n.u,{className:t,variant:p},"none"!==s&&u().createElement(l.k,{className:o,style:i,icon:s}),u().createElement(m.D,{headingLevel:"h5",size:"lg"},d),u().createElement(r.B,{style:{marginBottom:"16px"}},c),a)};d.propTypes={children:i().any,icon:i().any,iconClass:i().any,iconStyle:i().any,text:i().any,title:i().string,variant:i().any,className:i().string},d.defaultProps={icon:s.ZP,title:"",variant:n.I.full};const p=d},58295:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>X});var n=a(42982),l=a(70885),r=a(4942),s=a(71070),o=a(93264),i=a.n(o),c=a(48585),u=a(62480),m=a(1082),d=a(7732),p=a(3351),f=a(6934),g=a(22860),y=a(82779),h=a(62410),v=a(84580),b=a(75662),E=a(52661),M=a(51957),Z=a(66031),S=a(80810),C=a(19399),O=a(35224),w=a(30893),D=a(88676),T=a(86896),P=a(70846),_=a(90025),N=a(38846),V=a(50693),x=a(16475),A=a(45697),B=a.n(A),L=a(63540),j=function(e){var t=e.signature,a=(0,T.Z)(),n=(0,o.useState)(!1),r=(0,l.Z)(n,1)[0];return i().createElement(V.r,{hasGutter:!0},r&&i().createElement(x.P,{span:6},i().createElement(N.Z,{code:t.rawRule,isReadOnly:!0})),i().createElement(x.P,{span:r?6:12}," ",i().createElement(L.xv,{className:"ins-l-sigtable--title",component:L.qO.h6},a.formatMessage(w.Z.description)),t.metadata.description))};j.propTypes={signature:B().object};const k=j;function R(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function H(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?R(Object(a),!0).forEach((function(t){(0,r.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):R(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var G={tableVars:{limit:10,offset:0,orderBy:"LAST_MATCH_DATE_DESC",ruleName:""},sortBy:{index:4,direction:c.B.desc},rows:[]},F={1:"NAME",2:"HAS_MATCH",3:"HOST_COUNT",4:"LAST_MATCH_DATE"},I=function(e){var t=e.index,a=e.direction;return"".concat(F[t],"_").concat(a===c.B.asc?"ASC":"DESC")},W=function(e,t){switch(t.type){case"setTableVars":return H(H({},e),{},{tableVars:H(H({},e.tableVars),t.payload)});case"setSortBy":return H(H({},e),{},{sortBy:t.payload,tableVars:H(H({},e.tableVars),t.tableVars)});case"setRows":return H(H({},e),{},{rows:t.payload})}return e},q=function(){var e,t,a,r,c,y,N,V,x=(0,T.Z)(),A=(0,o.useReducer)(W,H({},G)),B=(0,l.Z)(A,2),L=B[0],j=L.tableVars,R=L.sortBy,F=L.rows,q=B[1],X=(0,P.a)(v.tE,{variables:H(H({},j),(0,_.l)(D.gG))}),z=X.data,J=X.loading,U=X.error,$=[{title:x.formatMessage(w.Z.sigName),cellFormatters:[u.zW],transforms:[(0,m.d)(45),d.p]},{title:x.formatMessage(w.Z.lastStatus),transforms:[(0,m.d)(10),d.p]},{title:x.formatMessage(w.Z.systems),transforms:[(0,m.d)(10),d.p]},{title:x.formatMessage(w.Z.matched),transforms:[(0,m.d)(10),d.p]}],Y=j.offset/j.limit+1,K={sig_match:{type:"radio",title:x.formatMessage(w.Z.status),urlParam:"sig_match",values:[{label:x.formatMessage(w.Z.all),value:"all"},{label:x.formatMessage(w.Z.matched),value:"true"},{label:x.formatMessage(w.Z.notMatched),value:"false"}]}},Q=[{label:x.formatMessage(w.Z.signature).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return q({type:"setTableVars",payload:{ruleName:t,offset:0}})},value:j.ruleName,placeholder:x.formatMessage(w.Z.filterBy,{field:x.formatMessage(w.Z.signature).toLowerCase()})}},{label:K.sig_match.title.toLowerCase(),type:K.sig_match.type,id:K.sig_match.urlParam,value:"radio-".concat(K.sig_match.urlParam),filterValues:{key:"".concat(K.sig_match.urlParam,"-filter"),onChange:function(e,t){var a=(0,D.gG)();"all"===t&&(null==a||delete a.condition),"all"===t?(0,D.gG)(H({},a)):(0,D.gG)(H(H({},a),{},{condition:{hasMatch:JSON.parse(t)}}))},value:JSON.stringify(null===(e=(0,D.gG)().condition)||void 0===e?void 0:e.hasMatch)||"all",items:K.sig_match.values}}],ee=function(e,t){return q({type:"setTableVars",payload:{offset:t*j.limit-j.limit}})},te=function(e,t){return q({type:"setTableVars",payload:{limit:t,offset:0}})},ae={deleteTitle:x.formatMessage(w.Z.resetFilters),filters:(N=[],V=void 0!==(null===(c=(0,D.gG)().condition)||void 0===c?void 0:c.hasMatch)&&(null!==(y=(0,D.gG)().condition)&&void 0!==y&&y.hasMatch?x.formatMessage(w.Z.matched):x.formatMessage(w.Z.notMatched)),(null==j?void 0:j.ruleName)&&N.push({category:x.formatMessage(w.Z.signature),value:"name",chips:[{name:null==j?void 0:j.ruleName,value:null==j?void 0:j.ruleName}]}),V&&N.push({category:x.formatMessage(w.Z.status),value:"matched",chips:[{name:V,value:V}]}),N),onDelete:function(e,t,a){a?((0,D.gG)({}),q({type:"setTableVars",payload:{ruleName:""}})):t.map((function(e){"name"===e.value&&q({type:"setTableVars",payload:{ruleName:""}}),"matched"===e.value&&(0,D.gG)({})}))}};return(0,o.useEffect)((function(){var e,t;q({type:"setRows",payload:(e=z,null==e||null===(t=e.rulesList)||void 0===t?void 0:t.flatMap((function(e,t){var a,n=e;return[{rowId:t,isOpen:!1,cells:[{title:i().createElement(b.Link,{to:"/signatures/".concat(n.name)},n.name)},{title:i().createElement(C.Z,{isDisabled:n.isDisabled,hasMatch:n.hasMatch,displayMatch:!0})},{title:i().createElement(b.Link,{to:"/signatures/".concat(n.name)},null===(a=n.hostCount)||void 0===a?void 0:a.toLocaleString())},{title:n.lastMatchDate?i().createElement(O.u,{content:i().createElement(h.Z,{date:new Date(n.lastMatchDate),type:"exact"})},i().createElement("span",null,i().createElement(h.Z,{date:new Date(n.lastMatchDate),type:"onlyDate"}))):i().createElement(O.u,{content:x.formatMessage(w.Z.noHostHas)},i().createElement("span",null,x.formatMessage(w.Z.never)))}]},{parent:2*t,sigData:n,fullWidth:!0,cells:[]}]})))})}),[x,z]),i().createElement(i().Fragment,null,i().createElement(Z.Z,{pagination:{itemCount:(null==z||null===(t=z.rules)||void 0===t?void 0:t.totalCount)||0,page:Y,perPage:j.limit,onSetPage:function(e,t){ee(0,t)},onPerPageSelect:function(e,t){te(0,t)},isCompact:!0},filterConfig:{items:Q},activeFiltersConfig:ae}),i().createElement(p.i,{className:"sigTable","aria-label":"Signature table",onCollapse:function(e,t,a){var l=(0,n.Z)(F),r=l[t+1].sigData;l[t]=H(H({},l[t]),{},{isOpen:a}),l[t+1].cells=[{title:i().createElement(k,{signature:r})}],q({type:"setRows",payload:l})},rows:F,cells:$,onSort:function(e,t,a){return q({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:I({index:t,direction:a}),offset:0}})},sortBy:R,isStickyHeader:!0},i().createElement(f.x,null),i().createElement(g.R,null)),J&&i().createElement(E.Z,{type:"table"}),!J&&!U&&0===(null==z||null===(a=z.rules)||void 0===a?void 0:a.totalCount)&&i().createElement(M.Z,{className:"pf-c-card",icon:S.W1,variant:"large",title:x.formatMessage(w.Z.noResults),text:x.formatMessage(w.Z.noResultsMatch)}),U&&i().createElement(M.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),i().createElement(s.t,{itemCount:(null==z||null===(r=z.rules)||void 0===r?void 0:r.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:j.limit,page:Y,variant:s.a.bottom,onSetPage:ee,onPerPageSelect:te}))};q.propTypes=y.R$;const X=q},19399:(e,t,a)=>{"use strict";a.d(t,{Z:()=>m});var n=a(23218),l=a(45697),r=a.n(l),s=a(93264),o=a.n(s),i=a(30893),c=a(86896),u=function(e){var t=e.isDisabled,a=e.hasMatch,l=e.displayMatch,r=void 0!==l&&l,s=(0,c.Z)();return r?o().createElement(o().Fragment,null,a&&o().createElement(n._,{color:"red"},s.formatMessage(i.Z.matched)),!a&&o().createElement(n._,{color:"blue"},s.formatMessage(i.Z.notMatched))):o().createElement(o().Fragment,null,t&&o().createElement(n._,null,s.formatMessage(i.Z.disabled)),!t&&o().createElement(n._,{color:"blue"},s.formatMessage(i.Z.enabled)))};u.propTypes={isDisabled:r().bool,hasMatch:r().bool,displayMatch:r().bool};const m=u},39149:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>L});var n=a(70885),l=a(4942),r=a(71070),s=a(93264),o=a.n(s),i=a(48585),c=a(1082),u=a(7732),m=a(3351),d=a(6934),p=a(22860),f=a(62410),g=a(84580),y=a(75662),h=a(52661),v=a(51957),b=a(66031),E=a(80810),M=a(19399),Z=a(35224),S=a(82779),C=a(30893),O=a(88676),w=a(86896),D=a(70846),T=a(90025);function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,l.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var N={tableVars:{limit:10,offset:0,orderBy:"LAST_SCAN_DATE_DESC",name:""},sortBy:{index:4,direction:i.B.desc},rows:[]},V={0:"DISPLAY_NAME",1:"HAS_MATCH",2:"LAST_MATCH_DATE",3:"TOTAL_MATCHES",4:"LAST_SCAN_DATE"},x=function(e){var t=e.index,a=e.direction;return"".concat(V[t],"_").concat(a===i.B.asc?"ASC":"DESC")},A=function(e,t){switch(t.type){case"setTableVars":return _(_({},e),{},{tableVars:_(_({},e.tableVars),t.payload)});case"setSortBy":return _(_({},e),{},{sortBy:t.payload,tableVars:_(_({},e.tableVars),t.tableVars)});case"setRows":return _(_({},e),{},{rows:t.payload})}return e},B=function(){var e,t,a,l,i,P,V,B=(0,w.Z)(),L=(0,s.useReducer)(A,_({},N)),j=(0,n.Z)(L,2),k=j[0],R=k.tableVars,H=k.sortBy,G=k.rows,F=j[1],I=(0,D.a)(g.c5,{variables:_(_({},R),(0,T.l)(O.WX))}),W=I.data,q=I.loading,X=I.error,z=[{title:B.formatMessage(C.Z.name),transforms:[(0,c.d)(45),u.p]},{title:B.formatMessage(C.Z.lastStatus),transforms:[u.p,(0,c.d)(10)]},{title:B.formatMessage(C.Z.matched),transforms:[u.p,(0,c.d)(10)]},{title:o().createElement("span",null,(0,S.lH)({tooltip:B.formatMessage(C.Z.totalMatchesNote),title:B.formatMessage(C.Z.totalMatches)})),transforms:[u.p,(0,c.d)(15)]},{title:B.formatMessage(C.Z.lastScan),transforms:[u.p,(0,c.d)(10)]}],J=R.offset/R.limit+1,U=[{label:B.formatMessage(C.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return F({type:"setTableVars",payload:{name:t,offset:0}})},value:R.name,placeholder:B.formatMessage(C.Z.filterBy,{field:B.formatMessage(C.Z.name).toLowerCase()})}}],$=function(e,t){return F({type:"setTableVars",payload:{offset:t*R.limit-R.limit}})},Y=function(e,t){return F({type:"setTableVars",payload:{limit:t,offset:0}})},K={deleteTitle:B.formatMessage(C.Z.resetFilters),filters:(P=[],V=void 0!==(null===(l=(0,O.WX)().condition)||void 0===l?void 0:l.hasMatch)&&(null!==(i=(0,O.WX)().condition)&&void 0!==i&&i.hasMatch?B.formatMessage(C.Z.matched):B.formatMessage(C.Z.notMatched)),(null==R?void 0:R.name)&&P.push({category:B.formatMessage(C.Z.name),value:"name",chips:[{name:null==R?void 0:R.name,value:null==R?void 0:R.name}]}),V&&P.push({category:B.formatMessage(C.Z.status),value:"matched",chips:[{name:V,value:V}]}),P),onDelete:function(e,t,a){a?((0,O.WX)({}),F({type:"setTableVars",payload:{name:""}})):t.map((function(e){"name"===e.value&&F({type:"setTableVars",payload:{name:""}}),"matched"===e.value&&(0,O.WX)({})}))}};return(0,s.useEffect)((function(){var e,t;F({type:"setRows",payload:(e=W,null==e||null===(t=e.hostsList)||void 0===t?void 0:t.flatMap((function(e,t){var a;return{rowId:t,cells:[{title:o().createElement(y.Link,{to:"/systems/".concat(e.displayName)},e.displayName)},{title:o().createElement(M.Z,{isDisabled:e.isDisabled,hasMatch:e.hasMatch,displayMatch:!0})},{title:e.lastMatchDate?o().createElement(Z.u,{content:o().createElement(f.Z,{date:new Date(e.lastMatchDate),type:"exact"})},o().createElement("span",null,o().createElement(f.Z,{date:new Date(e.lastMatchDate),type:"onlyDate"}))):o().createElement(Z.u,{content:B.formatMessage(C.Z.noHostHas)},o().createElement("span",null,B.formatMessage(C.Z.never)))},{title:o().createElement(y.Link,{to:"/systems/".concat(e.displayName)},null===(a=e.totalMatches)||void 0===a?void 0:a.toLocaleString())},{title:o().createElement(Z.u,{content:o().createElement(f.Z,{date:new Date(e.lastScanDate),type:"exact"})},o().createElement("span",null,o().createElement(f.Z,{date:new Date(e.lastScanDate)})))}]}})))})}),[B,W]),o().createElement(o().Fragment,null,o().createElement(b.Z,{pagination:{itemCount:(null==W||null===(e=W.hosts)||void 0===e?void 0:e.totalCount)||0,page:J,perPage:R.limit,onSetPage:function(e,t){$(0,t)},onPerPageSelect:function(e,t){Y(0,t)},isCompact:!0},filterConfig:{items:U},activeFiltersConfig:K}),o().createElement(m.i,{className:"sysTable","aria-label":"System table",rows:G,cells:z,onSort:function(e,t,a){return F({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:x({index:t,direction:a}),offset:0}})},sortBy:H,isStickyHeader:!0},o().createElement(d.x,null),o().createElement(p.R,null)),q&&o().createElement(h.Z,{type:"table"}),!q&&!X&&0===(null==W||null===(t=W.hosts)||void 0===t?void 0:t.totalCount)&&o().createElement(v.Z,{className:"pf-c-card",icon:E.W1,variant:"large",title:B.formatMessage(C.Z.noResults),text:B.formatMessage(C.Z.noResultsMatch)}),X&&o().createElement(v.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),o().createElement(r.t,{itemCount:(null==W||null===(a=W.hosts)||void 0===a?void 0:a.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:R.limit,page:J,variant:r.a.bottom,onSetPage:$,onPerPageSelect:Y}))};B.propTypes=S.R$;const L=B},32857:()=>{},3162:()=>{},28992:()=>{},21626:()=>{},21064:()=>{},82014:()=>{},54994:()=>{},37494:()=>{},67761:()=>{}}]);
//# sourceMappingURL=../sourcemaps/SigTable.426081767556e4d898688274d27f6066.js.map