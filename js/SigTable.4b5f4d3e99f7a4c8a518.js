(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[207],{78286:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var r=a(94015),l=a.n(r),n=a(23645),s=a.n(n)()(l());s.push([e.id,".malware .ins-l-sigtable--title{font-weight:var(--pf-global--FontWeight--semi-bold)}\n","",{version:3,sources:["webpack://./src/Components/SigTable/SigTable.scss"],names:[],mappings:"AAAA,gCACuB,mDAAmD",sourcesContent:[".malware{\n.ins-l-sigtable--title{font-weight:var(--pf-global--FontWeight--semi-bold)}\n\n}"],sourceRoot:""}]);const o=s},56317:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>I});var r=a(319),l=a.n(r),n=a(63038),s=a.n(n),o=a(59713),i=a.n(o),c=(a(13111),a(50693)),u=a(16475),m=a(71070),f=a(97522),d=a.n(f),p=a(38800),g=a(62480),b=a(1082),y=a(7732),v=a(3351),h=a(6934),E=a(22860),w=a(63540),C=a(74153),M=a(62410),O=a(14203),Z=a(55399),P=a(45134),S=a(49148),_=a(57277),D=a(80810),A=a(44852),T=a(35224),V=a(10407),R=a(18623),B=a(39963),j=a(86896),N=a(46829);function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function x(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){i()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var G={tableVars:{limit:10,offset:0,orderBy:"CREATED_AT_ASC",ruleName:""},sortBy:{index:4,direction:p.B.asc},rows:[]},L={2:"IS_DISABLED",3:"HOST_COUNT",4:"CREATED_AT",5:"HAS_MATCH"},H=function(e){var t=e.index,a=e.direction;return"".concat(L[t],"_").concat(a===p.B.asc?"ASC":"DESC")},W=function(e,t){switch(t.type){case"setTableVars":return x(x({},e),{},{tableVars:x(x({},e.tableVars),t.payload)});case"setSortBy":return x(x({},e),{},{sortBy:t.payload,tableVars:x(x({},e.tableVars),t.tableVars)});case"setRows":return x(x({},e),{},{rows:t.payload})}return e},F=function(){var e,t,a,r,n=(0,j.Z)(),o=(0,f.useReducer)(W,x({},G)),i=s()(o,2),p=i[0],V=p.tableVars,k=p.sortBy,L=p.rows,F=i[1],I=(0,N.useQuery)(O.tE,{variables:x(x({},V),(0,N.useReactiveVar)(B.gG))}),J=I.data,q=I.loading,z=I.error,Q=[{title:n.formatMessage(R.Z.sigName),cellFormatters:[g.zW],transforms:[(0,b.d)(45)]},{title:n.formatMessage(R.Z.status),transforms:[y.p]},{title:n.formatMessage(R.Z.hosts),transforms:[y.p]},{title:n.formatMessage(R.Z.added),transforms:[y.p]},{title:n.formatMessage(R.Z.matched),transforms:[y.p]}],U=V.offset/V.limit+1,K={sig_match:{type:"radio",title:n.formatMessage(R.Z.status),urlParam:"sig_match",values:[{label:n.formatMessage(R.Z.all),value:"all"},{label:n.formatMessage(R.Z.matched),value:"true"},{label:n.formatMessage(R.Z.notMatched),value:"false"}]}},X=[{label:n.formatMessage(R.Z.signature).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return F({type:"setTableVars",payload:{ruleName:t}})},value:V.ruleName,placeholder:n.formatMessage(R.Z.filterBy,{field:n.formatMessage(R.Z.signature).toLowerCase()})}},{label:K.sig_match.title,type:K.sig_match.type,id:K.sig_match.urlParam,value:"radio-".concat(K.sig_match.urlParam),filterValues:{key:"".concat(K.sig_match.urlParam,"-filter"),onChange:function(e,t){var a=(0,B.gG)();"all"===t&&(null==a||delete a.condition),"all"===t?(0,B.gG)(x({},a)):(0,B.gG)(x(x({},a),{},{condition:{hasMatch:JSON.parse(t)}}))},value:JSON.stringify(null===(e=(0,B.gG)().condition)||void 0===e?void 0:e.hasMatch)||"all",items:K.sig_match.values}}],Y=function(e,t){return F({type:"setTableVars",payload:{offset:t*V.limit-V.limit}})},$=function(e,t){return F({type:"setTableVars",payload:{limit:t,offset:0}})};return(0,f.useEffect)((function(){var e,t;F({type:"setRows",payload:(e=J,null==e||null===(t=e.rulesList)||void 0===t?void 0:t.flatMap((function(e,t){var a=e;return[{rowId:t,isOpen:!1,cells:[{title:d().createElement(Z.Link,{to:"/".concat(a.name)},a.name)},{title:d().createElement("span",null,d().createElement(A.Z,a))},{title:d().createElement(Z.Link,{to:"/".concat(a.name)},a.hostCount)},{title:d().createElement("span",null,a.metadata.date)},{title:a.lastMatchDate?d().createElement(M.Z,{date:new Date(a.lastMatchDate),type:"onlyDate"}):d().createElement(T.u,{content:n.formatMessage(R.Z.noHostHas)},d().createElement("span",null,n.formatMessage(R.Z.never)))}]},{parent:2*t,sigData:a,fullWidth:!0,cells:[]}]})))})}),[n,J]),d().createElement(d().Fragment,null,d().createElement(_.Z,{pagination:{itemCount:(null==J||null===(t=J.rules)||void 0===t?void 0:t.totalCount)||0,page:U,perPage:V.limit,onSetPage:function(e,t){Y(0,t)},onPerPageSelect:function(e,t){$(0,t)},isCompact:!0},filterConfig:{items:X}}),d().createElement(v.i,{className:"sigTable","aria-label":"Signature table",onCollapse:function(e,t,a){var r=l()(L),s=r[t+1].sigData;r[t]=x(x({},r[t]),{},{isOpen:a}),r[t+1].cells=[{title:d().createElement(c.r,{hasGutter:!0},d().createElement(u.P,{span:6},d().createElement(C.Z,{code:s.rawRule,language:"objective-c",isReadOnly:!0})),d().createElement(u.P,{span:6}," ",d().createElement(w.xv,{className:"ins-l-sigtable--title",component:w.qO.h6},n.formatMessage(R.Z.description)),s.metadata.description))}],F({type:"setRows",payload:r})},rows:L,cells:Q,onSort:function(e,t,a){return F({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:H({index:t,direction:a}),offset:0}})},sortBy:k},d().createElement(h.x,null),d().createElement(E.R,null)),q&&d().createElement(P.Z,{type:"table"}),!q&&!z&&0===(null==J||null===(a=J.rules)||void 0===a?void 0:a.totalCount)&&d().createElement(S.Z,{className:"pf-c-card",icon:D.W1,variant:"large",title:n.formatMessage(R.Z.noResults),text:n.formatMessage(R.Z.noResultsMatch)}),z&&d().createElement(S.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"}),d().createElement(m.t,{itemCount:(null==J||null===(r=J.rules)||void 0===r?void 0:r.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:V.limit,page:U,variant:m.a.bottom,onSetPage:Y,onPerPageSelect:$}))};F.propTypes=V.R;const I=F},13111:(e,t,a)=>{"use strict";var r=a(93379),l=a.n(r),n=a(78286),s=l()(n.default,{insert:"head",singleton:!1});if(!n.default.locals||e.hot.invalidate){var o=n.default.locals;e.hot.accept(78286,(t=>{n=a(78286),function(e,t,a){if(!e&&t||e&&!t)return!1;var r;for(r in e)if(e[r]!==t[r])return!1;for(r in t)if(!e[r])return!1;return!0}(o,n.default.locals)?(o=n.default.locals,s(n.default)):e.hot.invalidate()}))}e.hot.dispose((function(){s()})),n.default.locals}}]);
//# sourceMappingURL=SigTable.4b5f4d3e99f7a4c8a518.js.map