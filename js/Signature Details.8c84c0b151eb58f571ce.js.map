{"version":3,"sources":["webpack://malware-detection-frontend/./src/Routes/Signatures/Details.scss","webpack://malware-detection-frontend/./src/Components/Breadcrumb/Breadcrumb.js","webpack://malware-detection-frontend/./src/Components/SigDetailsTable/SigDetailsTable.js","webpack://malware-detection-frontend/./src/Routes/Signatures/Details.js","webpack://malware-detection-frontend/./src/Routes/Signatures/Details.scss?44f1"],"names":["___CSS_LOADER_EXPORT___","push","module","id","BreadcrumbComponent","items","last","pop","Breadcrumb","map","value","key","BreadcrumbItem","to","name","isActive","propTypes","PropTypes","sortIndices","1","2","3","orderBy","index","direction","SortByDirection","tableReducer","state","action","type","tableVars","payload","sortBy","rows","SigDetailsTable","ruleName","affectedCount","intl","useIntl","initialState","limit","offset","hostName","useReducer","stateSet","useQuery","GET_SIGNATURE_DETAILS_TABLE","variables","data","loading","error","columns","title","formatMessage","messages","cellFormatters","expandable","transforms","sortable","cellWidth","page","filterConfigItems","label","toLowerCase","filterValues","onChange","e","placeholder","field","onSetPage","onPerPageSelect","perPage","useEffect","flatMap","host","rowId","isOpen","cells","hostname","DateFormat","date","Date","lastScanDate","matchCount","parent","hostData","fullWidth","rowBuilder","rulesList","affectedHostsList","PrimaryToolbar","pagination","itemCount","affectedHosts","totalCount","isCompact","filterConfig","Table","className","aria-label","onCollapse","rowKey","collapseRows","CodeEditor","code","matches","match","source","stringOffset","stringData","stringIdentifier","scanDate","length","join","isDownloadEnabled","isCopyEnabled","onSort","Loading","MessageState","variant","icon","CheckCircleIcon","iconClass","text","SearchIcon","Pagination","widgetId","PaginationVariant","sigId","useParams","breadcrumbs","GET_SIGNATURE_DETAILS_PAGE","sigDetailsData","detailBlock","detail","PageHeader","Title","headingLevel","size","TitleSizes","Grid","hasGutter","GridItem","md","sm","rawRule","language","isReadOnly","span","lastMatchDate","hosts","metadata","description","StatusLabel","author","Main","update","hot","invalidate","oldLocals","accept","a","b","isNamedExport","p","isEqualLocals","dispose"],"mappings":"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","file":"js/Signature Details.8c84c0b151eb58f571ce.js","sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".malware .pf-c-code-editor__main{height:250px;overflow:scroll}.malware .ins-l-detailBlockHeader{font-weight:var(--pf-global--FontWeight--semi-bold)}\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/Routes/Signatures/Details.scss\"],\"names\":[],\"mappings\":\"AAAA,iCACwB,YAAY,CAAC,eAAe,CADpD,kCAC8E,mDAAmD\",\"sourcesContent\":[\".malware{\\n.pf-c-code-editor__main{height:250px;overflow:scroll}.ins-l-detailBlockHeader{font-weight:var(--pf-global--FontWeight--semi-bold)}\\n\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","import { Breadcrumb, BreadcrumbItem } from '@patternfly/react-core/dist/js/components/Breadcrumb/index';\n\nimport PropTypes from 'prop-types';\nimport React from 'react';\n\nconst BreadcrumbComponent = ({ items }) => {\n    const last = items.pop();\n    return <Breadcrumb>\n        {items.map((value, key) => <BreadcrumbItem key={key} to={value.to}>{value.name}</BreadcrumbItem>)}\n        <BreadcrumbItem isActive>{last.name}</BreadcrumbItem>\n    </Breadcrumb>;\n};\n\nBreadcrumbComponent.propTypes = {\n    items: PropTypes.array\n};\n\nexport default BreadcrumbComponent;\n","import { Pagination, PaginationVariant } from '@patternfly/react-core/dist/esm/components/Pagination';\nimport React, { useEffect, useReducer } from 'react';\nimport {\n    SortByDirection,\n    Table,\n    TableBody,\n    TableHeader,\n    cellWidth,\n    expandable,\n    sortable\n} from '@patternfly/react-table/dist/esm/components/Table';\n\nimport CheckCircleIcon from '@patternfly/react-icons/dist/esm/icons/check-circle-icon';\nimport CodeEditor from '../CodeEditor/CodeEditor';\nimport { DateFormat } from '@redhat-cloud-services/frontend-components/DateFormat';\nimport { GET_SIGNATURE_DETAILS_TABLE } from '../../operations/queries';\nimport Loading from '../Loading/Loading';\nimport MessageState from '../MessageState/MessageState';\nimport { PrimaryToolbar } from '@redhat-cloud-services/frontend-components/PrimaryToolbar';\nimport { SearchIcon } from '@patternfly/react-icons/dist/esm/icons/search-icon';\nimport messages from '../../Messages';\nimport propTypes from 'prop-types';\nimport { useIntl } from 'react-intl';\nimport { useQuery } from '@apollo/client';\n\nconst sortIndices = { 1: 'HOSTNAME', 2: 'LAST_SCAN_DATE', 3: 'MATCH_COUNT' };\nconst orderBy = ({ index, direction }) => `${sortIndices[index]}_${direction === SortByDirection.asc ? 'ASC' : 'DESC'}`;\n\nconst tableReducer = (state, action) => {\n    switch (action.type) {\n        case 'setTableVars':\n            return { ...state, tableVars: { ...state.tableVars, ...action.payload } };\n        case 'setSortBy':\n            return { ...state, sortBy: action.payload, tableVars: { ...state.tableVars, ...action.tableVars } };\n        case 'setRows':\n            return { ...state, rows: action.payload };\n    }\n\n    return state;\n};\n\nconst SigDetailsTable = ({ ruleName, affectedCount }) => {\n    const intl = useIntl();\n    const initialState = {\n        tableVars: {\n            limit: 10,\n            offset: 0,\n            orderBy: 'LAST_SCAN_DATE_ASC',\n            hostName: '',\n            ruleName\n        },\n        sortBy: {\n            index: 2,\n            direction: SortByDirection.asc\n        },\n        rows: []\n    };\n    const [{ tableVars, sortBy, rows }, stateSet] = useReducer(tableReducer, {\n        ...initialState\n    });\n    const { data, loading, error } =\n        useQuery(GET_SIGNATURE_DETAILS_TABLE, { variables: tableVars });\n    const columns = [\n        { title: intl.formatMessage(messages.name), cellFormatters: [expandable], transforms: [sortable, cellWidth(45)] },\n        { title: intl.formatMessage(messages.status), transforms: [sortable] },\n        { title: intl.formatMessage(messages.totalMatches), transforms: [sortable] }\n    ];\n\n    const page = tableVars.offset / tableVars.limit + 1;\n\n    const filterConfigItems = [{\n        label: intl.formatMessage(messages.name).toLowerCase(),\n        filterValues: {\n            key: 'text-filter',\n            onChange: (e, value) => stateSet({ type: 'setTableVars', payload: { hostName: value } }),\n            value: tableVars.hostName,\n            placeholder: intl.formatMessage(messages.filterBy, { field: intl.formatMessage(messages.name).toLowerCase() })\n        }\n    }];\n\n    const onSetPage = (e, page) => stateSet({ type: 'setTableVars', payload: { offset: page * tableVars.limit - tableVars.limit } });\n\n    const onPerPageSelect = (e, perPage) => stateSet({ type: 'setTableVars', payload: { limit: perPage, offset: 0 } });\n\n    const onSort = (e, index, direction) =>\n        stateSet({ type: 'setSortBy', payload: { index, direction }, tableVars: { orderBy: orderBy({ index, direction }), offset: 0 } });\n\n    const onCollapse = (e, rowKey, isOpen) => {\n        const collapseRows = [...rows];\n        const host = collapseRows[rowKey + 1].hostData;\n\n        collapseRows[rowKey] = { ...collapseRows[rowKey], isOpen };\n        collapseRows[rowKey + 1].cells =  [{\n            title: <CodeEditor code={`${host.matches.map((match, key) => `Match Source: ${match.source}\nOffset:${match.stringOffset}\nMatch Data: ${match.stringData}\nMatch Identifier: ${match.stringIdentifier}\nMatch Scan Date: ${new Date(match.scanDate)}\n${host.matches.length > 1 && key !== host.matches.length - 1 ? `~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n` : ''}`).join('')}`}\n            isDownloadEnabled isCopyEnabled/> }];\n        stateSet({ type: 'setRows', payload: collapseRows });\n    };\n\n    useEffect(() => {\n        const rowBuilder = data => data?.flatMap((data, key) => {\n            const host = data;\n            return [{\n                rowId: key,\n                isOpen: false,\n                cells: [\n                    { title: <span>{host.hostname}</span> },\n                    { title: <DateFormat date={new Date(host.lastScanDate)} type='onlyDate' /> },\n                    { title: <span>{host.matchCount}</span> }\n\n                ]\n            }, {\n                parent: key * 2,\n                hostData: host,\n                fullWidth: true,\n                cells: []\n            }];\n        });\n\n        stateSet({ type: 'setRows', payload: rowBuilder(data?.rulesList[0]?.affectedHostsList) });\n    }, [intl, data]);\n\n    return <React.Fragment>\n        <PrimaryToolbar\n            pagination={{\n                itemCount: data?.rulesList[0]?.affectedHosts?.totalCount || 0,\n                page,\n                perPage: tableVars.limit,\n                onSetPage(e, page) { onSetPage(e, page); },\n                onPerPageSelect(e, perPage) { onPerPageSelect(e, perPage); },\n                isCompact: true\n            }}\n            filterConfig={{ items: filterConfigItems }}\n        />\n        <Table className='sigTable' aria-label='Signature Details table'\n            rows={rows} cells={columns} onCollapse={onCollapse}\n            onSort={onSort} sortBy={sortBy}>\n            <TableHeader />\n            <TableBody />\n        </Table>\n        {loading && <Loading type='table' />}\n        {!error && !loading && affectedCount !== 0 ?\n            data?.rulesList[0]?.affectedHosts?.totalCount === 0 ?\n                <MessageState className='pf-c-card' icon={SearchIcon} variant='large' title={intl.formatMessage(messages.noResults)}\n                    text={intl.formatMessage(messages.noResultsMatch)} />\n                : <React.Fragment />\n            : !loading && <MessageState className='pf-c-card' variant='large' icon={CheckCircleIcon} iconClass='ins-l-success-color'\n                title={intl.formatMessage(messages.noAffectedHosts)}\n                text={intl.formatMessage(messages.noAffectedHostsBody)} />\n        }\n        {error && <MessageState className='pf-c-card' variant='large' title='Error' text='error' />}\n        <Pagination\n            itemCount={data?.rulesList[0]?.affectedHosts?.totalCount || 0}\n            widgetId='pagination-options-menu-bottom'\n            perPage={tableVars.limit}\n            page={page}\n            variant={PaginationVariant.bottom}\n            onSetPage={onSetPage}\n            onPerPageSelect={onPerPageSelect}\n        />\n    </React.Fragment>;\n};\n\nSigDetailsTable.propTypes = { ruleName: propTypes.string, affectedCount: propTypes.number };\n\nexport default SigDetailsTable;\n","import './Details.scss';\n\nimport { Grid, GridItem } from '@patternfly/react-core/dist/esm/layouts/Grid/index';\nimport { Title, TitleSizes } from '@patternfly/react-core/dist/esm/components/Title';\n\nimport Breadcrumb from '../../Components/Breadcrumb/Breadcrumb';\nimport CodeEditor from '../../Components/CodeEditor/CodeEditor';\nimport { DateFormat } from '@redhat-cloud-services/frontend-components/DateFormat';\nimport { GET_SIGNATURE_DETAILS_PAGE } from '../../operations/queries';\nimport Loading from '../../Components/Loading/Loading';\nimport { Main } from '@redhat-cloud-services/frontend-components/Main';\nimport { PageHeader } from '@redhat-cloud-services/frontend-components/PageHeader';\nimport React from 'react';\nimport SigDetailsTable from '../../Components/SigDetailsTable/SigDetailsTable';\nimport StatusLabel from '../../Components/StatusLabel/StatusLabel';\nimport messages from '../../Messages';\nimport { useIntl } from 'react-intl';\nimport { useParams } from 'react-router-dom';\nimport { useQuery } from '@apollo/client';\n\nconst Details = () => {\n    const intl = useIntl();\n    const { id: sigId } = useParams();\n    const breadcrumbs = [{ name: intl.formatMessage(messages.malwareDetection), to: '/insights/malware' }, { name: sigId, to: '#' }];\n    const { data, loading } = useQuery(GET_SIGNATURE_DETAILS_PAGE, {\n        variables: { ruleName: sigId  }\n    });\n    const sigDetailsData = data?.rulesList[0];\n    const detailBlock = (title, detail) => <React.Fragment>\n        <p className='ins-l-detailBlockHeader'>{title}</p>\n        <p>{detail}</p>\n    </React.Fragment>;\n\n    return <React.Fragment>\n        <PageHeader>\n            <Breadcrumb items={breadcrumbs} />\n            <Title headingLevel='h1' size={TitleSizes['3xl']}>{sigId}</Title>\n            <Grid hasGutter>\n                <GridItem md={7} sm={12}>\n                    { sigDetailsData && <CodeEditor code={sigDetailsData.rawRule} language='objective-c'\n                        isReadOnly isDownloadEnabled isCopyEnabled />}\n                </GridItem>\n                {loading ? <Loading /> :\n                    <GridItem md={5} sm={12}>\n                        <Grid hasGutter>\n                            <GridItem span={6}>\n                                {detailBlock(intl.formatMessage(messages.lastmatch), sigDetailsData?.lastMatchDate ?\n                                    <DateFormat date={new Date(sigDetailsData.lastMatchDate)} type=\"onlyDate\" />\n                                    : intl.formatMessage(messages.never))}\n                            </GridItem>\n                            <GridItem span={6}>\n                                {detailBlock(intl.formatMessage(messages.hostmatch),\n                                    <span>{`${sigDetailsData?.affectedHosts?.totalCount}/${data?.hosts?.totalCount}`}</span>)}\n                            </GridItem>\n                            <GridItem span={12}>\n                                {detailBlock(intl.formatMessage(messages.description), sigDetailsData?.metadata?.description)}\n                            </GridItem>\n                            <GridItem span={6}>\n                                {detailBlock(intl.formatMessage(messages.status), sigDetailsData && <StatusLabel {...sigDetailsData} />)}\n                            </GridItem>\n                            <GridItem span={6}>\n                                {detailBlock(intl.formatMessage(messages.author), sigDetailsData?.metadata?.author)}\n                            </GridItem>\n                        </Grid>\n                    </GridItem>}\n            </Grid>\n        </PageHeader>\n        <Main>\n            <Title headingLevel='h1' size={TitleSizes['3xl']}>\n                {intl.formatMessage(messages.affectedHosts)}\n            </Title>\n            <SigDetailsTable ruleName={sigId} affectedCount={sigDetailsData?.affectedHosts?.totalCount}/>\n        </Main>\n    </React.Fragment>;\n};\n\nexport default Details;\n","import api from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[3].use[2]!../../../node_modules/sass-loader/dist/cjs.js!./Details.scss\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\nif (module.hot) {\n  if (!content.locals || module.hot.invalidate) {\n    var isEqualLocals = function isEqualLocals(a, b, isNamedExport) {\n  if (!a && b || a && !b) {\n    return false;\n  }\n\n  var p;\n\n  for (p in a) {\n    if (isNamedExport && p === 'default') {\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n\n    if (a[p] !== b[p]) {\n      return false;\n    }\n  }\n\n  for (p in b) {\n    if (isNamedExport && p === 'default') {\n      // eslint-disable-next-line no-continue\n      continue;\n    }\n\n    if (!a[p]) {\n      return false;\n    }\n  }\n\n  return true;\n};\n    var oldLocals = content.locals;\n\n    module.hot.accept(\n      \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[3].use[2]!../../../node_modules/sass-loader/dist/cjs.js!./Details.scss\",\n      function () {\n        if (!isEqualLocals(oldLocals, content.locals, undefined)) {\n                module.hot.invalidate();\n\n                return;\n              }\n\n              oldLocals = content.locals;\n\n              update(content);\n      }\n    )\n  }\n\n  module.hot.dispose(function() {\n    update();\n  });\n}\n\nexport default content.locals || {};"],"sourceRoot":""}