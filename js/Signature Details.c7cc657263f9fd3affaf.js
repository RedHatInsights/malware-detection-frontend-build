"use strict";(self.webpackChunkmalware_detection_frontend=self.webpackChunkmalware_detection_frontend||[]).push([[982],{53830:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});var n=a(29439),l=a(50693),r=a(16475),o=a(60485),s=a(89837),c=a(38846),i=a(62410),m=a(84580),u=a(52661),d=a(86350),f=a(48716),p=a(93264),g=a.n(p),E=a(93433),y=a(4942),v=a(71070),h=a(38800),b=a(62480),Z=a(7732),M=a(1082),C=a(3351),w=a(6934),D=a(22860),P=a(68778),S=a(82779),O=a(51957),N=a(66031),A=a(80810),H=a(30893),B=a(45697),L=a.n(B),T=a(86896),x=a(70846),V=a(42946);function j(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?j(Object(a),!0).forEach((function(t){(0,y.Z)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):j(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var k={1:"DISPLAY_NAME",2:"LAST_SCAN_DATE",3:"MATCH_COUNT"},R=function(e){var t=e.index,a=e.direction;return"".concat(k[t],"_").concat(a===h.B.asc?"ASC":"DESC")},I=function(e,t){switch(t.type){case"setTableVars":return _(_({},e),{},{tableVars:_(_({},e.tableVars),t.payload)});case"setSortBy":return _(_({},e),{},{sortBy:t.payload,tableVars:_(_({},e.tableVars),t.tableVars)});case"setRows":return _(_({},e),{},{rows:t.payload})}return e},F=function(e){var t,a,l,r,o,s,d=e.ruleName,f=e.affectedCount,y=e.isEmptyAccount,B=(0,T.Z)(),L={tableVars:{limit:10,offset:0,orderBy:"LAST_SCAN_DATE_ASC",displayName:"",ruleName:d},sortBy:{index:2,direction:h.B.asc},rows:[]},j=(0,p.useReducer)(I,_({},L)),k=(0,n.Z)(j,2),F=k[0],W=F.tableVars,z=F.sortBy,G=F.rows,U=k[1],J=(0,x.a)(m.I8,{variables:W}),Y=J.data,q=J.loading,K=J.error,Q=[{title:B.formatMessage(H.Z.name),cellFormatters:[b.zW],transforms:[Z.p,(0,M.d)(45)]},{title:B.formatMessage(H.Z.matched),transforms:[Z.p]},{title:g().createElement("span",null,(0,S.lH)({tooltip:B.formatMessage(H.Z.totalMatchesNote),title:B.formatMessage(H.Z.totalMatches)})),transforms:[Z.p]}],X=W.offset/W.limit+1,$=[{label:B.formatMessage(H.Z.name).toLowerCase(),filterValues:{key:"text-filter",onChange:function(e,t){return U({type:"setTableVars",payload:{displayName:t,offset:0}})},value:W.displayName,placeholder:B.formatMessage(H.Z.filterBy,{field:B.formatMessage(H.Z.name).toLowerCase()})}}],ee=function(e,t){return U({type:"setTableVars",payload:{offset:t*W.limit-W.limit}})},te=function(e,t){return U({type:"setTableVars",payload:{limit:t,offset:0}})};(0,p.useEffect)((function(){var e;U({type:"setRows",payload:function(e){return null==e?void 0:e.flatMap((function(e,t){var a,n=e;return[{rowId:t,isOpen:!1,cells:[{title:g().createElement("span",null,n.displayName)},{title:g().createElement(i.Z,{date:new Date(n.lastScanDate),type:"onlyDate"})},{title:g().createElement("span",null,null===(a=n.matchCount)||void 0===a?void 0:a.toLocaleString())}]},{parent:2*t,hostData:n,fullWidth:!0,cells:[]}]}))}(null==Y||null===(e=Y.rulesList[0])||void 0===e?void 0:e.affectedHostsList)})}),[B,Y]);var ae=g().createElement(O.Z,{className:"pf-c-card",icon:A.W1,variant:"large",title:B.formatMessage(H.Z.noResults),text:B.formatMessage(H.Z.noResultsMatch)}),ne=g().createElement(O.Z,{className:"pf-c-card",variant:"large",icon:P.ZP,iconClass:"ins-l-success-color",title:B.formatMessage(H.Z.noAffectedHosts),text:B.formatMessage(H.Z.noAffectedHostsBody)}),le=g().createElement(V.Z,{className:"pf-c-card",message:B.formatMessage(H.Z.emptyAccountTableBody)}),re=g().createElement(O.Z,{className:"pf-c-card",variant:"large",title:"Error",text:"error"});return g().createElement(g().Fragment,null,g().createElement(N.Z,{pagination:{itemCount:(null==Y||null===(t=Y.rulesList[0])||void 0===t||null===(a=t.affectedHosts)||void 0===a?void 0:a.totalCount)||0,page:X,perPage:W.limit,onSetPage:function(e,t){ee(0,t)},onPerPageSelect:function(e,t){te(0,t)},isCompact:!0},filterConfig:{items:$}}),g().createElement(C.i,{className:"sigTable","aria-label":"Signature Details table",rows:G,cells:Q,onCollapse:function(e,t,a){var n=(0,E.Z)(G),l=n[t+1].hostData;n[t]=_(_({},n[t]),{},{isOpen:a}),n[t+1].cells=[{title:g().createElement(c.Z,{height:"250px",code:"".concat(l.matches.map((function(e,t){return"Match Source: ".concat(e.source,"\nOffset:").concat(e.stringOffset,"\nMatch Data: ").concat(e.stringData,"\nMatch Identifier: ").concat(e.stringIdentifier,"\nMatch Scan Date: ").concat(new Date(e.scanDate).toUTCString(),"\n").concat(e.metadata?(0,S.Wi)(JSON.parse(e.metadata)):"","\n").concat(l.matches.length>1&&t!==l.matches.length-1?"~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n":"")})).join("")),isDownloadEnabled:!0,isCopyEnabled:!0})}],U({type:"setRows",payload:n})},onSort:function(e,t,a){return U({type:"setSortBy",payload:{index:t,direction:a},tableVars:{orderBy:R({index:t,direction:a}),offset:0}})},sortBy:z,isStickyHeader:!0},g().createElement(w.x,null),g().createElement(D.R,null)),q&&g().createElement(u.Z,{type:"table"}),K||q||0===f?!q&&(y?le:ne):0===(null==Y||null===(l=Y.rulesList[0])||void 0===l||null===(r=l.affectedHosts)||void 0===r?void 0:r.totalCount)?ae:g().createElement(g().Fragment,null),K&&g().createElement(re,null),g().createElement(v.t,{itemCount:(null==Y||null===(o=Y.rulesList[0])||void 0===o||null===(s=o.affectedHosts)||void 0===s?void 0:s.totalCount)||0,widgetId:"pagination-options-menu-bottom",perPage:W.limit,page:X,variant:v.a.bottom,onSetPage:ee,onPerPageSelect:te}))};F.propTypes={ruleName:L().string,affectedCount:L().number,isEmptyAccount:L().bool};const W=F;var z=a(19399),G=a(75662);const U=function(){var e,t,a,p,E,y,v,h=(0,T.Z)(),b=g().useState(!1),Z=(0,n.Z)(b,1)[0],M=(0,G.useParams)().id,C=[{name:h.formatMessage(H.Z.malwareDetectionSignatures),to:"".concat((0,S.hN)(),"/insights/malware")},{name:M,to:"#"}],w=(0,x.a)(m.c3,{variables:{ruleName:M}}),D=w.data,P=w.loading,O=null==D?void 0:D.rulesList[0],N=function(e,t){return g().createElement(g().Fragment,null,g().createElement("p",{className:"ins-l-detailBlockHeader"},e),g().createElement("p",null,t))};return g().createElement(g().Fragment,null,g().createElement(f.Z,null,g().createElement(s.Z,{items:C}),g().createElement(l.r,{hasGutter:!0},g().createElement(r.P,{md:12,sm:12},g().createElement(o.D,{headingLevel:"h1",size:o.H["3xl"]},M)),Z&&g().createElement(r.P,{md:7,sm:12},O&&g().createElement(c.Z,{height:"250px",code:O.rawRule,isReadOnly:!0,isDownloadEnabled:!0,isCopyEnabled:!0})),P?g().createElement(u.Z,null):g().createElement(r.P,{md:Z?5:12,sm:12},g().createElement(l.r,{hasGutter:!0},g().createElement(r.P,{span:Z?6:1},N(h.formatMessage(H.Z.lastmatch),null!=O&&O.lastMatchDate?g().createElement(i.Z,{date:new Date(O.lastMatchDate),type:"onlyDate"}):h.formatMessage(H.Z.never))),g().createElement(r.P,{span:Z?6:1},N(h.formatMessage(H.Z.hostmatch),g().createElement("span",null,"".concat(null==O||null===(e=O.affectedHosts)||void 0===e?void 0:e.totalCount,"/").concat(null==D||null===(t=D.hosts)||void 0===t?void 0:t.totalCount)))),Z&&g().createElement(r.P,{span:6},N(h.formatMessage(H.Z.description),null==O||null===(a=O.metadata)||void 0===a?void 0:a.description)),g().createElement(r.P,{span:Z?6:1},N(h.formatMessage(H.Z.enablement),O&&g().createElement(z.Z,O))),g().createElement(r.P,{span:Z?6:2},N(h.formatMessage(H.Z.author),null==O||null===(p=O.metadata)||void 0===p?void 0:p.author)),!Z&&g().createElement(r.P,{span:7},N(h.formatMessage(H.Z.description),null==O||null===(E=O.metadata)||void 0===E?void 0:E.description)))))),g().createElement(d.Z,null,g().createElement(o.D,{className:"ins-l-tableBlockHeader",headingLevel:"h1",size:o.H["3xl"]},h.formatMessage(H.Z.affectedHosts)),g().createElement(W,{ruleName:M,isEmptyAccount:0===(null==D||null===(y=D.hosts)||void 0===y?void 0:y.totalCount),affectedCount:null==O||null===(v=O.affectedHosts)||void 0===v?void 0:v.totalCount})))}}}]);
//# sourceMappingURL=../sourcemaps/Signature Details.38646c087e783c5204cd0ee4aabcfe8e.js.map